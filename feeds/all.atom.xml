<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>dchess</title><link href="http://dchess.github.io/" rel="alternate"></link><link href="http://dchess.github.io/feeds/all.atom.xml" rel="self"></link><id>http://dchess.github.io/</id><updated>2023-02-11T12:45:00-08:00</updated><subtitle>Software Engineer</subtitle><entry><title>I Can Python, So Can You</title><link href="http://dchess.github.io/i-can-python-so-can-you.html" rel="alternate"></link><published>2023-02-11T12:45:00-08:00</published><updated>2023-02-11T12:45:00-08:00</updated><author><name>dc.hess@gmail.com</name></author><id>tag:dchess.github.io,2023-02-11:/i-can-python-so-can-you.html</id><summary type="html">&lt;p&gt;A series of introductory tutorials on Python&lt;/p&gt;</summary><content type="html">&lt;p&gt;Before I left &lt;a href="https://aspirepublicschools.org/"&gt;Aspire&lt;/a&gt;, I had started an internal training on Python for those in the org who were interested in
learning to do a bit of coding. Inspired by the tag line from an old favorite cooking show from the 1980s, &lt;a href="https://yancancook.com/home/"&gt;Yan Can Cook&lt;/a&gt;, I titled the course "I Can Python, So Can You". &lt;/p&gt;
&lt;p&gt;The scope of that original course was heaviliy inspired by Al Swiegart's &lt;a href="https://automatetheboringstuff.com/"&gt;Automate The Boring Stuff With Python&lt;/a&gt; and was focused on building skills around office task automation. My colleague, and good friend, &lt;a href="https://github.com/jbaek"&gt;Jason Baek&lt;/a&gt; helped me design the course and content and we co-taught it during our time there. &lt;/p&gt;
&lt;p&gt;When I left Aspire and began work at &lt;a href="https://kippnorcal.org/"&gt;KIPP Northern California&lt;/a&gt;, there was once again an interest from colleagues to learn a little python. So I updated the course, added some additional homework and projects, and taught it once again. I learned a lot that time around and got some great feedback from my data team about the skills they were most interested in (such as learning pandas, APIs, and data visualization). &lt;/p&gt;
&lt;p&gt;In the summer of 2019, I was asked by the &lt;a href="https://www.kipp.org/"&gt;KIPP Foundation&lt;/a&gt; to design a single day version of the course for a data convening in Chicago. I recruited my data engineering colleague, &lt;a href="https://github.com/cbini"&gt;Charlie Bini&lt;/a&gt;, to help me build out a streamlined version of the content and to co-teach with me at the convening. We reworked the content to incorporate a more data-focused curriculum and taught it over the course of a six-hour session at the convening. We repeated the course with further updates the following year, although we did it remotely as we were in the midst of the pandemic. &lt;/p&gt;
&lt;p&gt;One of the core ideas in all of the incarnations was that the environment setup and IDE learning curve would be a roadblock for many newbies and we didn't want that to stand in the way of jumping in and learning to code in python. 
So we reached for &lt;a href="https://research.google.com/colaboratory/faq.html"&gt;Google Colab&lt;/a&gt;, which had the ease of Jupyter Notebooks but with in an browser, cloud hosted environment, and was shareable like any other Google Doc. &lt;/p&gt;
&lt;p&gt;I'm hoping to write a new version of these lessons soon, but in the meantime I wanted to get them up on my blog as a reference for folks who ask about learning resources and to hopefully cultivate some additional feedback that I can incorporate in the next iteration. &lt;/p&gt;
&lt;p&gt;Without further ado, here are the links to the colab notebooks. I hope they are useful to anyone who finds this post. &lt;/p&gt;
&lt;h3&gt;I Can Python, So Can You&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href="https://colab.research.google.com/drive/1Cq-by_cx8-PEgsq-c-Zfl6KWB-qTXh7_#forceEdit=true&amp;amp;sandboxMode=true" target="_blank"&gt;Introduction&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://colab.research.google.com/drive/1Kdzs3ICGnJ6dAIQsZX4zlQi8p8MgdkyT#forceEdit=true&amp;amp;sandboxMode=true" target="_blank"&gt;Fundamentals&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://colab.research.google.com/drive/14AXeyRSddc80XnBM7qMxFgo1KfNyoYI3#forceEdit=true&amp;amp;sandboxMode=true" target="_blank"&gt;Control Flow&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://colab.research.google.com/drive/1R0kFjjJXFxhkuVMfedLrv7fX2YMLKlTU#forceEdit=true&amp;amp;sandboxMode=true" target="_blank"&gt;Loops &amp;amp; Lists&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://colab.research.google.com/drive/10_PwrV0VYnRG8QoggQv3La_bhHhMZfAx#forceEdit=true&amp;amp;sandboxMode=true" target="_blank"&gt;Recap &amp;amp; APIs&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://colab.research.google.com/drive/1F1gzo0Vr2tGKhXC34Il4kAY6g8FUKY9c#forceEdit=true&amp;amp;sandboxMode=true"&gt;Pandas&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://colab.research.google.com/drive/11IsQ4gzLh6XdD5L59iicY97uI-wolacw#forceEdit=true&amp;amp;sandboxMode=true" target="_blank"&gt;Course Capstone: Star Wars&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;</content><category term="Tutorial"></category></entry><entry><title>Parsing Texas Assessment Data</title><link href="http://dchess.github.io/parsing-texas-assessment-data.html" rel="alternate"></link><published>2022-01-29T21:00:00-07:00</published><updated>2022-01-29T21:00:00-07:00</updated><author><name>dc.hess@gmail.com</name></author><id>tag:dchess.github.io,2022-01-29:/parsing-texas-assessment-data.html</id><summary type="html">&lt;p&gt;Demo of using pandas to pivot jagged ultra-wide dataset into a consistent and long format.&lt;/p&gt;</summary><content type="html">&lt;h1&gt;Data Transformation of the Texas STAAR Aggregate Data for 2020-2021&lt;/h1&gt;
&lt;p&gt;Data files available &lt;a href="https://tea.texas.gov/student-assessment/testing/staar/staar-aggregate-data-for-2020-2021"&gt;here on the TEA website&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The STAAR data files contain results for 60+ student demographic groups and each variable is repeated in a separate column for both demographic and test subject. As you will see below, this results in data files that are several thousand columns wide and are a different schema for every grade. &lt;/p&gt;
&lt;p&gt;These files are designed for use in SAS and SPSS, and the website itself indicates that the number of variables in these files is too great to import into Microsoft Access or some versions of Microsoft Excel without significant truncation. &lt;/p&gt;
&lt;p&gt;However, my goal was to pivot this data into a standardized format and load into BigQuery for cross analysis with other state assessment data. What follows is my approach in Python, but I am sure there are other potentially simpler methods than mine, I hope this demonstration helps other approach this dataset for analysis and possibly encourages others to improve upon this method. &lt;/p&gt;
&lt;p&gt;The original files are linked below for easy access. &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Campus level data for Grades 3-8&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Grade 3:&lt;/strong&gt;  &lt;a href="https://tea.texas.gov/sites/default/files/cfy21e3.dat"&gt;test data&lt;/a&gt; | &lt;a href="https://tea.texas.gov/sites/default/files/fy21_varlist_g03.xls"&gt;variable list&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Grade 4:&lt;/strong&gt; &lt;a href="https://tea.texas.gov/sites/default/files/cfy21e4.dat"&gt;test data&lt;/a&gt; | &lt;a href="https://tea.texas.gov/sites/default/files/fy21_varlist_g04.xls"&gt;variable list&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Grade 5:&lt;/strong&gt; &lt;a href="https://tea.texas.gov/sites/default/files/cfy21e5.dat"&gt;test data&lt;/a&gt; | &lt;a href="https://tea.texas.gov/sites/default/files/fy21_varlist_g05.xls"&gt;variable list&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Grade 6:&lt;/strong&gt; &lt;a href="https://tea.texas.gov/sites/default/files/cfy21e6.dat"&gt;test data&lt;/a&gt; | &lt;a href="https://tea.texas.gov/sites/default/files/fy21_varlist_g06.xls"&gt;variable list&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Grade 7:&lt;/strong&gt; &lt;a href="https://tea.texas.gov/sites/default/files/cfy21e7.dat"&gt;test data&lt;/a&gt; | &lt;a href="https://tea.texas.gov/sites/default/files/fy21_varlist_g07.xls"&gt;variable list&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Grade 8:&lt;/strong&gt; &lt;a href="https://tea.texas.gov/sites/default/files/cfy21e8.dat"&gt;test data&lt;/a&gt; | &lt;a href="https://tea.texas.gov/sites/default/files/fy21_varlist_g08.xls"&gt;variable list&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
<<<<<<< Updated upstream

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Getting-the-Lay-of-the-Land"&gt;Getting the Lay of the Land&lt;a class="anchor-link" href="#Getting-the-Lay-of-the-Land"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Before determining a solution and final schema, I wanted to understand the structure of these files. This can be accomplished by looping over the linked dat files and getting their shapes.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[7]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pandas&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pd&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pathlib&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Path&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;xlrd&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;

&lt;span class="c1"&gt;# Display options for pandas data frames&lt;/span&gt;
&lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_option&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;display.max_columns&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_option&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;max_colwidth&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_option&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;max_seq_item&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
=======
&lt;h2&gt;Getting the Lay of the Land&lt;/h2&gt;
&lt;p&gt;Before determining a solution and final schema, I wanted to understand the structure of these files. This can be accomplished by looping over the linked dat files and getting their shapes.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pandas&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pd&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pathlib&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Path&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;xlrd&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;
>>>>>>> Stashed changes

&lt;span class="c1"&gt;# Display options for pandas data frames&lt;/span&gt;
&lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_option&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;display.max_columns&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_option&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;max_colwidth&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_option&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;max_seq_item&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;base_url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;https://tea.texas.gov/sites/default/files/&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;dat_files&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;cfy21e3.dat&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;cfy21e4.dat&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;cfy21e5.dat&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;cfy21e6.dat&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;cfy21e7.dat&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;cfy21e8.dat&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;dat_file&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;dat_files&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;base_url&lt;/span&gt;&lt;span class="si"&gt;}{&lt;/span&gt;&lt;span class="n"&gt;dat_file&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;content&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stem&lt;/span&gt;
    &lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_csv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;cfy21e3 (4643, 2093)
cfy21e4 (4622, 3075)
cfy21e5 (4415, 3197)
cfy21e6 (2700, 2093)
cfy21e7 (2337, 3075)
cfy21e8 (2370, 4301)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Each file is named with this convention (as far as I can discern):
- &lt;strong&gt;c&lt;/strong&gt;: Campus level data
- &lt;strong&gt;fy21&lt;/strong&gt;: Fiscal year 2021
- &lt;strong&gt;e#&lt;/strong&gt;: English grade # (English, because grades 3-5 also include Spanish results)&lt;/p&gt;
&lt;p&gt;The numbers in the accompanying parenthesis represent the count of rows and columns, respectively.&lt;/p&gt;
<<<<<<< Updated upstream
&lt;h2 id="Inconsistent-Data-Shape"&gt;Inconsistent Data Shape&lt;a class="anchor-link" href="#Inconsistent-Data-Shape"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;We can see from this quick file inspection that combining these datasets into a single unified structure will require more than just concatenation. The number of columns is jagged/inconsistent. Reviewing the variable files shows that each grade has differences in the variables reported. Some grades have Reading and Mathematics, while other include a Writing test as well. There are additional differences, but that is one of the most common.&lt;/p&gt;
&lt;p&gt;They are so wide, because each variable such as &lt;code&gt;# Tested&lt;/code&gt; is repeated for each subject and each student group (60+ in total). We can also see that the naming of these columns is encoded/abbreviated, such as &lt;code&gt;r_all_d&lt;/code&gt; for &lt;code&gt;# Tested -- Reading -- All Students&lt;/code&gt; or &lt;code&gt;r_eth2_d&lt;/code&gt; for &lt;code&gt;# Tested -- Reading -- Two or More Races Students&lt;/code&gt;.&lt;/p&gt;
&lt;h2 id="Finding-a-Pattern"&gt;Finding a Pattern&lt;a class="anchor-link" href="#Finding-a-Pattern"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;There is something of a pattern to this naming convention you may have noticed:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;r&lt;/strong&gt;: reading&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;all&lt;/strong&gt;: all students&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;d&lt;/strong&gt;: # tested&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This becomes more obvious with subsequent examples such as &lt;code&gt;r_all_unsatgl_nm&lt;/code&gt; for &lt;code&gt;# Did Not Meet Grade Level Performance -- Reading -- All Students&lt;/code&gt;.&lt;/p&gt;
&lt;h2 id="A-First-Attempt"&gt;A First Attempt&lt;a class="anchor-link" href="#A-First-Attempt"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;My initial thought was to split these variable names using the the &lt;code&gt;_&lt;/code&gt; as a delimiter, but this was met with limited success, again due to inconsistent usage.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; You will see the following warning in places &lt;code&gt;WARNING *** OLE2 inconsistency: SSCS size is 0 but SSAT size is non-zero&lt;/code&gt;. This is due to an encoding issue with the TEA provided files and can be ignored as it does not impact our ability to parse the files.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[11]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;grade3_vars&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;https://tea.texas.gov/sites/default/files/fy21_varlist_g03.xls&amp;#39;&lt;/span&gt;

&lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_excel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;grade3_vars&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;WARNING *** OLE2 inconsistency: SSCS size is 0 but SSAT size is non-zero
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[11]:&lt;/div&gt;

=======
&lt;h2&gt;Inconsistent Data Shape&lt;/h2&gt;
&lt;p&gt;We can see from this quick file inspection that combining these datasets into a single unified structure will require more than just concatenation. The number of columns is jagged/inconsistent. Reviewing the variable files shows that each grade has differences in the variables reported. Some grades have Reading and Mathematics, while other include a Writing test as well. There are additional differences, but that is one of the most common. &lt;/p&gt;
&lt;p&gt;They are so wide, because each variable such as &lt;code&gt;# Tested&lt;/code&gt; is repeated for each subject and each student group (60+ in total). We can also see that the naming of these columns is encoded/abbreviated, such as &lt;code&gt;r_all_d&lt;/code&gt; for &lt;code&gt;# Tested -- Reading -- All Students&lt;/code&gt; or &lt;code&gt;r_eth2_d&lt;/code&gt; for &lt;code&gt;# Tested -- Reading -- Two or More Races Students&lt;/code&gt;. &lt;/p&gt;
&lt;h2&gt;Finding a Pattern&lt;/h2&gt;
&lt;p&gt;There is something of a pattern to this naming convention you may have noticed:
- &lt;strong&gt;r&lt;/strong&gt;: reading
- &lt;strong&gt;all&lt;/strong&gt;: all students
- &lt;strong&gt;d&lt;/strong&gt;: # tested&lt;/p&gt;
&lt;p&gt;This becomes more obvious with subsequent examples such as &lt;code&gt;r_all_unsatgl_nm&lt;/code&gt; for &lt;code&gt;# Did Not Meet Grade Level Performance -- Reading -- All Students&lt;/code&gt;. &lt;/p&gt;
&lt;h2&gt;A First Attempt&lt;/h2&gt;
&lt;p&gt;My initial thought was to split these variable names using the the &lt;code&gt;_&lt;/code&gt; as a delimiter, but this was met with limited success, again due to inconsistent usage. &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; You will see the following warning in places &lt;code&gt;WARNING *** OLE2 inconsistency: SSCS size is 0 but SSAT size is non-zero&lt;/code&gt;. This is due to an encoding issue with the TEA provided files and can be ignored as it does not impact our ability to parse the files. &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;grade3_vars&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;https://tea.texas.gov/sites/default/files/fy21_varlist_g03.xls&amp;#39;&lt;/span&gt;

&lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_excel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;grade3_vars&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
>>>>>>> Stashed changes

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;WARNING *** OLE2 inconsistency: SSCS size is 0 but SSAT size is non-zero
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Variable&lt;/th&gt;
      &lt;th&gt;Format_Type&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;campus&lt;/td&gt;
      &lt;td&gt;Character&lt;/td&gt;
      &lt;td&gt;Campus Number&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;year&lt;/td&gt;
      &lt;td&gt;Character&lt;/td&gt;
      &lt;td&gt;Test Administration Year&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;region&lt;/td&gt;
      &lt;td&gt;Character&lt;/td&gt;
      &lt;td&gt;Education Service Center (Region) Number&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;district&lt;/td&gt;
      &lt;td&gt;Character&lt;/td&gt;
      &lt;td&gt;District Number&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;dname&lt;/td&gt;
      &lt;td&gt;Character&lt;/td&gt;
      &lt;td&gt;District Name&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;cname&lt;/td&gt;
      &lt;td&gt;Character&lt;/td&gt;
      &lt;td&gt;Campus Name&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;grade&lt;/td&gt;
      &lt;td&gt;Character&lt;/td&gt;
      &lt;td&gt;Tested Grade (Usually the Enrolled Grade Unless Student Tested Above Grade)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;r_all_docs_n&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Answer Documents Submitted -- Reading -- All Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;r_all_abs_n&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Absent - Not Tested -- Reading -- All Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;r_all_oth_n&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Other - Not Tested -- Reading -- All Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10&lt;/th&gt;
      &lt;td&gt;m_all_docs_n&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Answer Documents Submitted -- Mathematics -- All Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;11&lt;/th&gt;
      &lt;td&gt;m_all_abs_n&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Absent - Not Tested -- Mathematics -- All Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;12&lt;/th&gt;
      &lt;td&gt;m_all_oth_n&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Other - Not Tested -- Mathematics -- All Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;13&lt;/th&gt;
      &lt;td&gt;r_all_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Reading -- All Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;14&lt;/th&gt;
      &lt;td&gt;r_sexm_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Reading -- Male Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;15&lt;/th&gt;
      &lt;td&gt;r_sexf_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Reading -- Female Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;16&lt;/th&gt;
      &lt;td&gt;r_sexv_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Reading -- No Sex Info Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;17&lt;/th&gt;
      &lt;td&gt;r_ethh_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Reading -- Hispanic/Latino Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;18&lt;/th&gt;
      &lt;td&gt;r_ethi_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Reading -- American Indian or Alaska Native Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;19&lt;/th&gt;
      &lt;td&gt;r_etha_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Reading -- Asian Students&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;p&gt;It appears at first glance, that the pattern is subject, student demographic group, variable type. However, we can see this doesn't remain consistent.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tail&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Variable&lt;/th&gt;
      &lt;th&gt;Format_Type&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;2078&lt;/th&gt;
      &lt;td&gt;m_spen_pct_cat4&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;% Avg Items Correct--Reporting Category 4 -- Mathematics -- Not Special Ed Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2079&lt;/th&gt;
      &lt;td&gt;m_spev_avg_cat4&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Avg Items Correct--Reporting Category 4 -- Mathematics -- No Info Special Ed Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2080&lt;/th&gt;
      &lt;td&gt;m_spev_pct_cat4&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;% Avg Items Correct--Reporting Category 4 -- Mathematics -- No Info Special Ed Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2081&lt;/th&gt;
      &lt;td&gt;m_gify_avg_cat4&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Avg Items Correct--Reporting Category 4 -- Mathematics -- Gifted/Talented Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2082&lt;/th&gt;
      &lt;td&gt;m_gify_pct_cat4&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;% Avg Items Correct--Reporting Category 4 -- Mathematics -- Gifted/Talented Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2083&lt;/th&gt;
      &lt;td&gt;m_gifn_avg_cat4&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Avg Items Correct--Reporting Category 4 -- Mathematics -- Not Gifted/Talented Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2084&lt;/th&gt;
      &lt;td&gt;m_gifn_pct_cat4&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;% Avg Items Correct--Reporting Category 4 -- Mathematics -- Not Gifted/Talented Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2085&lt;/th&gt;
      &lt;td&gt;m_gifv_avg_cat4&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Avg Items Correct--Reporting Category 4 -- Mathematics -- No Info Gifted/Talented Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2086&lt;/th&gt;
      &lt;td&gt;m_gifv_pct_cat4&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;% Avg Items Correct--Reporting Category 4 -- Mathematics -- No Info Gifted/Talented Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2087&lt;/th&gt;
      &lt;td&gt;m_atry_avg_cat4&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Avg Items Correct--Reporting Category 4 -- Mathematics -- At-Risk Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2088&lt;/th&gt;
      &lt;td&gt;m_atry_pct_cat4&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;% Avg Items Correct--Reporting Category 4 -- Mathematics -- At-Risk Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2089&lt;/th&gt;
      &lt;td&gt;m_atrn_avg_cat4&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Avg Items Correct--Reporting Category 4 -- Mathematics -- Not At-Risk Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2090&lt;/th&gt;
      &lt;td&gt;m_atrn_pct_cat4&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;% Avg Items Correct--Reporting Category 4 -- Mathematics -- Not At-Risk Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2091&lt;/th&gt;
      &lt;td&gt;m_atrv_avg_cat4&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Avg Items Correct--Reporting Category 4 -- Mathematics -- No Info At-Risk Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2092&lt;/th&gt;
      &lt;td&gt;m_atrv_pct_cat4&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;% Avg Items Correct--Reporting Category 4 -- Mathematics -- No Info At-Risk Students&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;p&gt;In these latter cases, there is a 4th variable reporting category that comes before the subject and student group.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;195&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;215&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

<<<<<<< Updated upstream
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[13]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;195&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;215&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[13]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
=======
>>>>>>> Stashed changes
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Variable&lt;/th&gt;
      &lt;th&gt;Format_Type&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;195&lt;/th&gt;
      &lt;td&gt;r_atrv_unsatgl_nm&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Did Not Meet Grade Level Performance -- Reading -- No Info At-Risk Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;196&lt;/th&gt;
      &lt;td&gt;r_all_approgl_nm&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Approaches Grade Level Performance -- Reading -- All Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;197&lt;/th&gt;
      &lt;td&gt;r_sexm_approgl_nm&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Approaches Grade Level Performance -- Reading -- Male Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;198&lt;/th&gt;
      &lt;td&gt;r_sexf_approgl_nm&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Approaches Grade Level Performance -- Reading -- Female Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;199&lt;/th&gt;
      &lt;td&gt;r_sexv_approgl_nm&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Approaches Grade Level Performance -- Reading -- No Sex Info Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;200&lt;/th&gt;
      &lt;td&gt;r_ethh_approgl_nm&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Approaches Grade Level Performance -- Reading -- Hispanic/Latino Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;201&lt;/th&gt;
      &lt;td&gt;r_ethi_approgl_nm&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Approaches Grade Level Performance -- Reading -- American Indian or Alaska Native Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;202&lt;/th&gt;
      &lt;td&gt;r_etha_approgl_nm&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Approaches Grade Level Performance -- Reading -- Asian Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;203&lt;/th&gt;
      &lt;td&gt;r_ethb_approgl_nm&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Approaches Grade Level Performance -- Reading -- Black or African American Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;204&lt;/th&gt;
      &lt;td&gt;r_ethp_approgl_nm&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Approaches Grade Level Performance -- Reading -- Native Hawaiian or Other Pacific Islander Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;205&lt;/th&gt;
      &lt;td&gt;r_ethw_approgl_nm&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Approaches Grade Level Performance -- Reading -- White Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;206&lt;/th&gt;
      &lt;td&gt;r_eth2_approgl_nm&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Approaches Grade Level Performance -- Reading -- Two or More Races Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;207&lt;/th&gt;
      &lt;td&gt;r_ethv_approgl_nm&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Approaches Grade Level Performance -- Reading -- No Ethnicity Info Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;208&lt;/th&gt;
      &lt;td&gt;r_ecoy_approgl_nm&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Approaches Grade Level Performance -- Reading -- Econ Disadv Students Codes: 1 2 9&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;209&lt;/th&gt;
      &lt;td&gt;r_econ_approgl_nm&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Approaches Grade Level Performance -- Reading -- Not Econ Disadv Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;210&lt;/th&gt;
      &lt;td&gt;r_eco1_approgl_nm&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Approaches Grade Level Performance -- Reading -- Free Meals Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;211&lt;/th&gt;
      &lt;td&gt;r_eco2_approgl_nm&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Approaches Grade Level Performance -- Reading -- Reduced-Price Meals Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;212&lt;/th&gt;
      &lt;td&gt;r_eco9_approgl_nm&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Approaches Grade Level Performance -- Reading -- Other Econ Disadvantaged Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;213&lt;/th&gt;
      &lt;td&gt;r_ecov_approgl_nm&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Approaches Grade Level Performance -- Reading -- No Info Econ Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;214&lt;/th&gt;
      &lt;td&gt;r_ti1y_approgl_nm&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Approaches Grade Level Performance -- Reading -- Title-I Participant Students Codes: 6 7 9&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;p&gt;There is another pattern with 4 parts for the proficiency levels that is subject, student group, and then a two part string for the variable type. &lt;/p&gt;
&lt;p&gt;These differences would make it challenging to simply split on the &lt;code&gt;_&lt;/code&gt; character. Even distinguishing between the three part and four part variables isn't sufficient, because there are two types of the four part variables.&lt;/p&gt;
&lt;h2&gt;A Different Solution&lt;/h2&gt;
&lt;p&gt;However, we can simply ignore the variables. We have a description column that also has it's own delimiter: &lt;code&gt;--&lt;/code&gt;. &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;descriptions&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Description&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tolist&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;description&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;descriptions&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt;
    &lt;span class="n"&gt;parts&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;description&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;--&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;parts&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;...&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;description&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;descriptions&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;:]:&lt;/span&gt;
    &lt;span class="n"&gt;parts&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;description&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;--&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;parts&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;[&amp;#39;Campus Number&amp;#39;]&lt;/span&gt;
&lt;span class="k"&gt;[&amp;#39;Test Administration Year&amp;#39;]&lt;/span&gt;
&lt;span class="k"&gt;[&amp;#39;Education Service Center (Region) Number&amp;#39;]&lt;/span&gt;
&lt;span class="k"&gt;[&amp;#39;District Number&amp;#39;]&lt;/span&gt;
&lt;span class="k"&gt;[&amp;#39;District Name&amp;#39;]&lt;/span&gt;
&lt;span class="k"&gt;[&amp;#39;Campus Name&amp;#39;]&lt;/span&gt;
&lt;span class="k"&gt;[&amp;#39;Tested Grade (Usually the Enrolled Grade Unless Student Tested Above Grade)&amp;#39;]&lt;/span&gt;
&lt;span class="k"&gt;[&amp;#39;# Answer Documents Submitted &amp;#39;, &amp;#39; Reading &amp;#39;, &amp;#39; All Students&amp;#39;]&lt;/span&gt;
&lt;span class="k"&gt;[&amp;#39;# Absent - Not Tested &amp;#39;, &amp;#39; Reading &amp;#39;, &amp;#39; All Students&amp;#39;]&lt;/span&gt;
&lt;span class="k"&gt;[&amp;#39;# Other - Not Tested &amp;#39;, &amp;#39; Reading &amp;#39;, &amp;#39; All Students&amp;#39;]&lt;/span&gt;
&lt;span class="k"&gt;[&amp;#39;# Answer Documents Submitted &amp;#39;, &amp;#39; Mathematics &amp;#39;, &amp;#39; All Students&amp;#39;]&lt;/span&gt;
&lt;span class="k"&gt;[&amp;#39;# Absent - Not Tested &amp;#39;, &amp;#39; Mathematics &amp;#39;, &amp;#39; All Students&amp;#39;]&lt;/span&gt;
&lt;span class="k"&gt;[&amp;#39;# Other - Not Tested &amp;#39;, &amp;#39; Mathematics &amp;#39;, &amp;#39; All Students&amp;#39;]&lt;/span&gt;
&lt;span class="k"&gt;[&amp;#39;# Tested &amp;#39;, &amp;#39; Reading &amp;#39;, &amp;#39; All Students&amp;#39;]&lt;/span&gt;
&lt;span class="k"&gt;[&amp;#39;# Tested &amp;#39;, &amp;#39; Reading &amp;#39;, &amp;#39; Male Students&amp;#39;]&lt;/span&gt;
&lt;span class="k"&gt;[&amp;#39;# Tested &amp;#39;, &amp;#39; Reading &amp;#39;, &amp;#39; Female Students&amp;#39;]&lt;/span&gt;
&lt;span class="k"&gt;[&amp;#39;# Tested &amp;#39;, &amp;#39; Reading &amp;#39;, &amp;#39; No Sex Info Students&amp;#39;]&lt;/span&gt;
&lt;span class="k"&gt;[&amp;#39;# Tested &amp;#39;, &amp;#39; Reading &amp;#39;, &amp;#39; Hispanic/Latino Students&amp;#39;]&lt;/span&gt;
&lt;span class="k"&gt;[&amp;#39;# Tested &amp;#39;, &amp;#39; Reading &amp;#39;, &amp;#39; American Indian or Alaska Native Students&amp;#39;]&lt;/span&gt;
&lt;span class="k"&gt;[&amp;#39;# Tested &amp;#39;, &amp;#39; Reading &amp;#39;, &amp;#39; Asian Students&amp;#39;]&lt;/span&gt;

&lt;span class="na"&gt;...&lt;/span&gt;

&lt;span class="k"&gt;[&amp;#39;% Avg Items Correct&amp;#39;, &amp;#39;Reporting Category 4 &amp;#39;, &amp;#39; Mathematics &amp;#39;, &amp;#39; At-Risk Students&amp;#39;]&lt;/span&gt;
&lt;span class="k"&gt;[&amp;#39;# Avg Items Correct&amp;#39;, &amp;#39;Reporting Category 4 &amp;#39;, &amp;#39; Mathematics &amp;#39;, &amp;#39; Not At-Risk Students&amp;#39;]&lt;/span&gt;
&lt;span class="k"&gt;[&amp;#39;% Avg Items Correct&amp;#39;, &amp;#39;Reporting Category 4 &amp;#39;, &amp;#39; Mathematics &amp;#39;, &amp;#39; Not At-Risk Students&amp;#39;]&lt;/span&gt;
&lt;span class="k"&gt;[&amp;#39;# Avg Items Correct&amp;#39;, &amp;#39;Reporting Category 4 &amp;#39;, &amp;#39; Mathematics &amp;#39;, &amp;#39; No Info At-Risk Students&amp;#39;]&lt;/span&gt;
&lt;span class="k"&gt;[&amp;#39;% Avg Items Correct&amp;#39;, &amp;#39;Reporting Category 4 &amp;#39;, &amp;#39; Mathematics &amp;#39;, &amp;#39; No Info At-Risk Students&amp;#39;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;This mostly works. We have three different types of descriptions/variables: 
- 1 part variables like &lt;code&gt;['Campus Number']&lt;/code&gt;
- 3 part variables like &lt;code&gt;['# Tested ', ' Reading ', ' All Students']&lt;/code&gt;
- 4 part variables like &lt;code&gt;['% Avg Items Correct', 'Reporting Category 4 ', ' Mathematics ', ' At-Risk Students']&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;That means we can use the list length to determine the order of the variable values: variable name, test subject, and student group. The fourth part reporting category is basically a modifier for the variable name so we can combine those.&lt;/p&gt;
&lt;p&gt;By examining a single variable name, we can see that &lt;code&gt;# Tested&lt;/code&gt;, for example, isn't actually 122 different variables but rather a single variable with 122 permutations of test subject and student group: &lt;strong&gt;61 student groups * 2 test subjects&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Description&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;contains&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;# Tested&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

<<<<<<< Updated upstream
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[14]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Description&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;contains&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;# Tested&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[14]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
=======
>>>>>>> Stashed changes
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Variable&lt;/th&gt;
      &lt;th&gt;Format_Type&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;13&lt;/th&gt;
      &lt;td&gt;r_all_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Reading -- All Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;14&lt;/th&gt;
      &lt;td&gt;r_sexm_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Reading -- Male Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;15&lt;/th&gt;
      &lt;td&gt;r_sexf_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Reading -- Female Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;16&lt;/th&gt;
      &lt;td&gt;r_sexv_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Reading -- No Sex Info Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;17&lt;/th&gt;
      &lt;td&gt;r_ethh_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Reading -- Hispanic/Latino Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;...&lt;/th&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;130&lt;/th&gt;
      &lt;td&gt;m_gifn_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Mathematics -- Not Gifted/Talented Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;131&lt;/th&gt;
      &lt;td&gt;m_gifv_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Mathematics -- No Info Gifted/Talented Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;132&lt;/th&gt;
      &lt;td&gt;m_atry_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Mathematics -- At-Risk Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;133&lt;/th&gt;
      &lt;td&gt;m_atrn_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Mathematics -- Not At-Risk Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;134&lt;/th&gt;
      &lt;td&gt;m_atrv_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Mathematics -- No Info At-Risk Students&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;122 rows × 3 columns&lt;/p&gt;
&lt;/div&gt;

&lt;h2&gt;Extracting the Variable Descriptors&lt;/h2&gt;
&lt;p&gt;In addition to pulling out the test subject and student group from the variable description, it will be useful to rename the columns into a common naming convention that is more human readable than the current encodings. &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Example&lt;/strong&gt;:&lt;/p&gt;
<<<<<<< Updated upstream
&lt;p&gt;If we take the initial variable example &lt;code&gt;r_all_d&lt;/code&gt; for &lt;code&gt;# Tested -- Reading -- All Students&lt;/code&gt; and remove the subject and student group we would be left with simply &lt;code&gt;d&lt;/code&gt; as the variable/column name. But a better description would be &lt;code&gt;# Tested&lt;/code&gt; or even better (to eliminate special characters that would be problematic in the database) &lt;code&gt;n_tested&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id="Splitting-the-Description"&gt;Splitting the Description&lt;a class="anchor-link" href="#Splitting-the-Description"&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;To start let's add a new column to the dataframe that has the array of descriptors. We can also remove any leading or trailing whitespace from both the variable and description to prevent mismatch issues later.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[15]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Variable&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Variable&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strip&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Description&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Description&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strip&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;desc_list&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Description&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;--&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[15]:&lt;/div&gt;


=======
&lt;p&gt;If we take the initial variable example &lt;code&gt;r_all_d&lt;/code&gt; for &lt;code&gt;# Tested -- Reading -- All Students&lt;/code&gt; and remove the subject and student group we would be left with simply &lt;code&gt;d&lt;/code&gt; as the variable/column name. But a better description would be &lt;code&gt;# Tested&lt;/code&gt; or even better (to eliminate special characters that would be problematic in the database) &lt;code&gt;n_tested&lt;/code&gt;. &lt;/p&gt;
&lt;h3&gt;Splitting the Description&lt;/h3&gt;
&lt;p&gt;To start let's add a new column to the dataframe that has the array of descriptors. We can also remove any leading or trailing whitespace from both the variable and description to prevent mismatch issues later. &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Variable&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Variable&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strip&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Description&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Description&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strip&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;desc_list&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Description&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;--&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
>>>>>>> Stashed changes

&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Variable&lt;/th&gt;
      &lt;th&gt;Format_Type&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
      &lt;th&gt;desc_list&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;campus&lt;/td&gt;
      &lt;td&gt;Character&lt;/td&gt;
      &lt;td&gt;Campus Number&lt;/td&gt;
      &lt;td&gt;[Campus Number]&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;year&lt;/td&gt;
      &lt;td&gt;Character&lt;/td&gt;
      &lt;td&gt;Test Administration Year&lt;/td&gt;
      &lt;td&gt;[Test Administration Year]&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;region&lt;/td&gt;
      &lt;td&gt;Character&lt;/td&gt;
      &lt;td&gt;Education Service Center (Region) Number&lt;/td&gt;
      &lt;td&gt;[Education Service Center (Region) Number]&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;district&lt;/td&gt;
      &lt;td&gt;Character&lt;/td&gt;
      &lt;td&gt;District Number&lt;/td&gt;
      &lt;td&gt;[District Number]&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;dname&lt;/td&gt;
      &lt;td&gt;Character&lt;/td&gt;
      &lt;td&gt;District Name&lt;/td&gt;
      &lt;td&gt;[District Name]&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;...&lt;/th&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2088&lt;/th&gt;
      &lt;td&gt;m_atry_pct_cat4&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;% Avg Items Correct--Reporting Category 4 -- Mathematics -- At-Risk Students&lt;/td&gt;
      &lt;td&gt;[% Avg Items Correct, Reporting Category 4 ,  Mathematics ,  At-Risk Students]&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2089&lt;/th&gt;
      &lt;td&gt;m_atrn_avg_cat4&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Avg Items Correct--Reporting Category 4 -- Mathematics -- Not At-Risk Students&lt;/td&gt;
      &lt;td&gt;[# Avg Items Correct, Reporting Category 4 ,  Mathematics ,  Not At-Risk Students]&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2090&lt;/th&gt;
      &lt;td&gt;m_atrn_pct_cat4&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;% Avg Items Correct--Reporting Category 4 -- Mathematics -- Not At-Risk Students&lt;/td&gt;
      &lt;td&gt;[% Avg Items Correct, Reporting Category 4 ,  Mathematics ,  Not At-Risk Students]&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2091&lt;/th&gt;
      &lt;td&gt;m_atrv_avg_cat4&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Avg Items Correct--Reporting Category 4 -- Mathematics -- No Info At-Risk Students&lt;/td&gt;
      &lt;td&gt;[# Avg Items Correct, Reporting Category 4 ,  Mathematics ,  No Info At-Risk Students]&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2092&lt;/th&gt;
      &lt;td&gt;m_atrv_pct_cat4&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;% Avg Items Correct--Reporting Category 4 -- Mathematics -- No Info At-Risk Students&lt;/td&gt;
      &lt;td&gt;[% Avg Items Correct, Reporting Category 4 ,  Mathematics ,  No Info At-Risk Students]&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;2093 rows × 4 columns&lt;/p&gt;
&lt;/div&gt;

<<<<<<< Updated upstream
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="Extracting-Test-Subject"&gt;Extracting Test Subject&lt;a class="anchor-link" href="#Extracting-Test-Subject"&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;In most cases the test subject is the 2nd part of the variable description with two exceptions: if the variable is one of the campus/grade variables that only has a single part or for the four part variables that include reporting category.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[16]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_subject&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;desc_list&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
=======
&lt;h3&gt;Extracting Test Subject&lt;/h3&gt;
&lt;p&gt;In most cases the test subject is the 2nd part of the variable description with two exceptions: if the variable is one of the campus/grade variables that only has a single part or for the four part variables that include reporting category.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_subject&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;desc_list&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
>>>>>>> Stashed changes
&lt;span class="sd"&gt;    Return the 2nd part of 3 part descriptors, the 3rd part of 4 part descriptors, or None.&lt;/span&gt;

&lt;span class="sd"&gt;    Note: Else None is not necessary here, since functions return None by default in Python&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;length&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;desc_list&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;length&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;desc_list&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;length&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;desc_list&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
<<<<<<< Updated upstream
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[18]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;subject&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;desc_list&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;get_subject&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[18]:&lt;/div&gt;

=======
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
>>>>>>> Stashed changes

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;subject&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;desc_list&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;get_subject&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Variable&lt;/th&gt;
      &lt;th&gt;Format_Type&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
      &lt;th&gt;desc_list&lt;/th&gt;
      &lt;th&gt;subject&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;campus&lt;/td&gt;
      &lt;td&gt;Character&lt;/td&gt;
      &lt;td&gt;Campus Number&lt;/td&gt;
      &lt;td&gt;[Campus Number]&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;year&lt;/td&gt;
      &lt;td&gt;Character&lt;/td&gt;
      &lt;td&gt;Test Administration Year&lt;/td&gt;
      &lt;td&gt;[Test Administration Year]&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;region&lt;/td&gt;
      &lt;td&gt;Character&lt;/td&gt;
      &lt;td&gt;Education Service Center (Region) Number&lt;/td&gt;
      &lt;td&gt;[Education Service Center (Region) Number]&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;district&lt;/td&gt;
      &lt;td&gt;Character&lt;/td&gt;
      &lt;td&gt;District Number&lt;/td&gt;
      &lt;td&gt;[District Number]&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;dname&lt;/td&gt;
      &lt;td&gt;Character&lt;/td&gt;
      &lt;td&gt;District Name&lt;/td&gt;
      &lt;td&gt;[District Name]&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;cname&lt;/td&gt;
      &lt;td&gt;Character&lt;/td&gt;
      &lt;td&gt;Campus Name&lt;/td&gt;
      &lt;td&gt;[Campus Name]&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;grade&lt;/td&gt;
      &lt;td&gt;Character&lt;/td&gt;
      &lt;td&gt;Tested Grade (Usually the Enrolled Grade Unless Student Tested Above Grade)&lt;/td&gt;
      &lt;td&gt;[Tested Grade (Usually the Enrolled Grade Unless Student Tested Above Grade)]&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;r_all_docs_n&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Answer Documents Submitted -- Reading -- All Students&lt;/td&gt;
      &lt;td&gt;[# Answer Documents Submitted ,  Reading ,  All Students]&lt;/td&gt;
      &lt;td&gt;Reading&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;r_all_abs_n&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Absent - Not Tested -- Reading -- All Students&lt;/td&gt;
      &lt;td&gt;[# Absent - Not Tested ,  Reading ,  All Students]&lt;/td&gt;
      &lt;td&gt;Reading&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;r_all_oth_n&lt;/td&gt;
<<<<<<< Updated upstream
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Other - Not Tested -- Reading -- All Students&lt;/td&gt;
      &lt;td&gt;[# Other - Not Tested ,  Reading ,  All Students]&lt;/td&gt;
      &lt;td&gt;Reading&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10&lt;/th&gt;
      &lt;td&gt;m_all_docs_n&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
=======
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Other - Not Tested -- Reading -- All Students&lt;/td&gt;
      &lt;td&gt;[# Other - Not Tested ,  Reading ,  All Students]&lt;/td&gt;
      &lt;td&gt;Reading&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10&lt;/th&gt;
      &lt;td&gt;m_all_docs_n&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
>>>>>>> Stashed changes
      &lt;td&gt;# Answer Documents Submitted -- Mathematics -- All Students&lt;/td&gt;
      &lt;td&gt;[# Answer Documents Submitted ,  Mathematics ,  All Students]&lt;/td&gt;
      &lt;td&gt;Mathematics&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;11&lt;/th&gt;
      &lt;td&gt;m_all_abs_n&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Absent - Not Tested -- Mathematics -- All Students&lt;/td&gt;
      &lt;td&gt;[# Absent - Not Tested ,  Mathematics ,  All Students]&lt;/td&gt;
      &lt;td&gt;Mathematics&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;12&lt;/th&gt;
      &lt;td&gt;m_all_oth_n&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Other - Not Tested -- Mathematics -- All Students&lt;/td&gt;
      &lt;td&gt;[# Other - Not Tested ,  Mathematics ,  All Students]&lt;/td&gt;
      &lt;td&gt;Mathematics&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;13&lt;/th&gt;
      &lt;td&gt;r_all_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Reading -- All Students&lt;/td&gt;
      &lt;td&gt;[# Tested ,  Reading ,  All Students]&lt;/td&gt;
      &lt;td&gt;Reading&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;14&lt;/th&gt;
      &lt;td&gt;r_sexm_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Reading -- Male Students&lt;/td&gt;
      &lt;td&gt;[# Tested ,  Reading ,  Male Students]&lt;/td&gt;
      &lt;td&gt;Reading&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;15&lt;/th&gt;
      &lt;td&gt;r_sexf_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Reading -- Female Students&lt;/td&gt;
      &lt;td&gt;[# Tested ,  Reading ,  Female Students]&lt;/td&gt;
      &lt;td&gt;Reading&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;16&lt;/th&gt;
      &lt;td&gt;r_sexv_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Reading -- No Sex Info Students&lt;/td&gt;
      &lt;td&gt;[# Tested ,  Reading ,  No Sex Info Students]&lt;/td&gt;
      &lt;td&gt;Reading&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;17&lt;/th&gt;
      &lt;td&gt;r_ethh_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Reading -- Hispanic/Latino Students&lt;/td&gt;
      &lt;td&gt;[# Tested ,  Reading ,  Hispanic/Latino Students]&lt;/td&gt;
      &lt;td&gt;Reading&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;18&lt;/th&gt;
      &lt;td&gt;r_ethi_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Reading -- American Indian or Alaska Native Students&lt;/td&gt;
      &lt;td&gt;[# Tested ,  Reading ,  American Indian or Alaska Native Students]&lt;/td&gt;
      &lt;td&gt;Reading&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;19&lt;/th&gt;
      &lt;td&gt;r_etha_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Reading -- Asian Students&lt;/td&gt;
      &lt;td&gt;[# Tested ,  Reading ,  Asian Students]&lt;/td&gt;
      &lt;td&gt;Reading&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
<<<<<<< Updated upstream
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Extracting-Student-Group"&gt;Extracting Student Group&lt;a class="anchor-link" href="#Extracting-Student-Group"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;In all cases (except the single descriptor variables) the student group is included at the end of the description.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[19]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_student_group&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;desc_list&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;    Unless the description has only one part, return the final part.&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;desc_list&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;desc_list&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[20]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;student_group&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;desc_list&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;get_student_group&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[20]:&lt;/div&gt;
=======
>>>>>>> Stashed changes

&lt;h2&gt;Extracting Student Group&lt;/h2&gt;
&lt;p&gt;In all cases (except the single descriptor variables) the student group is included at the end of the description.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_student_group&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;desc_list&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;    Unless the description has only one part, return the final part.&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;desc_list&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;desc_list&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;student_group&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;desc_list&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;get_student_group&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Variable&lt;/th&gt;
      &lt;th&gt;Format_Type&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
      &lt;th&gt;desc_list&lt;/th&gt;
      &lt;th&gt;subject&lt;/th&gt;
      &lt;th&gt;student_group&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;campus&lt;/td&gt;
      &lt;td&gt;Character&lt;/td&gt;
      &lt;td&gt;Campus Number&lt;/td&gt;
      &lt;td&gt;[Campus Number]&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;year&lt;/td&gt;
      &lt;td&gt;Character&lt;/td&gt;
      &lt;td&gt;Test Administration Year&lt;/td&gt;
      &lt;td&gt;[Test Administration Year]&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;region&lt;/td&gt;
      &lt;td&gt;Character&lt;/td&gt;
      &lt;td&gt;Education Service Center (Region) Number&lt;/td&gt;
      &lt;td&gt;[Education Service Center (Region) Number]&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;district&lt;/td&gt;
      &lt;td&gt;Character&lt;/td&gt;
      &lt;td&gt;District Number&lt;/td&gt;
      &lt;td&gt;[District Number]&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;dname&lt;/td&gt;
      &lt;td&gt;Character&lt;/td&gt;
      &lt;td&gt;District Name&lt;/td&gt;
      &lt;td&gt;[District Name]&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;cname&lt;/td&gt;
      &lt;td&gt;Character&lt;/td&gt;
      &lt;td&gt;Campus Name&lt;/td&gt;
      &lt;td&gt;[Campus Name]&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;grade&lt;/td&gt;
      &lt;td&gt;Character&lt;/td&gt;
      &lt;td&gt;Tested Grade (Usually the Enrolled Grade Unless Student Tested Above Grade)&lt;/td&gt;
      &lt;td&gt;[Tested Grade (Usually the Enrolled Grade Unless Student Tested Above Grade)]&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;r_all_docs_n&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Answer Documents Submitted -- Reading -- All Students&lt;/td&gt;
      &lt;td&gt;[# Answer Documents Submitted ,  Reading ,  All Students]&lt;/td&gt;
      &lt;td&gt;Reading&lt;/td&gt;
      &lt;td&gt;All Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;r_all_abs_n&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Absent - Not Tested -- Reading -- All Students&lt;/td&gt;
      &lt;td&gt;[# Absent - Not Tested ,  Reading ,  All Students]&lt;/td&gt;
      &lt;td&gt;Reading&lt;/td&gt;
      &lt;td&gt;All Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;r_all_oth_n&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Other - Not Tested -- Reading -- All Students&lt;/td&gt;
      &lt;td&gt;[# Other - Not Tested ,  Reading ,  All Students]&lt;/td&gt;
      &lt;td&gt;Reading&lt;/td&gt;
      &lt;td&gt;All Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10&lt;/th&gt;
      &lt;td&gt;m_all_docs_n&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Answer Documents Submitted -- Mathematics -- All Students&lt;/td&gt;
      &lt;td&gt;[# Answer Documents Submitted ,  Mathematics ,  All Students]&lt;/td&gt;
      &lt;td&gt;Mathematics&lt;/td&gt;
      &lt;td&gt;All Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;11&lt;/th&gt;
      &lt;td&gt;m_all_abs_n&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Absent - Not Tested -- Mathematics -- All Students&lt;/td&gt;
      &lt;td&gt;[# Absent - Not Tested ,  Mathematics ,  All Students]&lt;/td&gt;
      &lt;td&gt;Mathematics&lt;/td&gt;
      &lt;td&gt;All Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;12&lt;/th&gt;
      &lt;td&gt;m_all_oth_n&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Other - Not Tested -- Mathematics -- All Students&lt;/td&gt;
      &lt;td&gt;[# Other - Not Tested ,  Mathematics ,  All Students]&lt;/td&gt;
      &lt;td&gt;Mathematics&lt;/td&gt;
      &lt;td&gt;All Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;13&lt;/th&gt;
      &lt;td&gt;r_all_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Reading -- All Students&lt;/td&gt;
      &lt;td&gt;[# Tested ,  Reading ,  All Students]&lt;/td&gt;
      &lt;td&gt;Reading&lt;/td&gt;
      &lt;td&gt;All Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;14&lt;/th&gt;
      &lt;td&gt;r_sexm_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Reading -- Male Students&lt;/td&gt;
      &lt;td&gt;[# Tested ,  Reading ,  Male Students]&lt;/td&gt;
      &lt;td&gt;Reading&lt;/td&gt;
      &lt;td&gt;Male Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;15&lt;/th&gt;
      &lt;td&gt;r_sexf_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Reading -- Female Students&lt;/td&gt;
      &lt;td&gt;[# Tested ,  Reading ,  Female Students]&lt;/td&gt;
      &lt;td&gt;Reading&lt;/td&gt;
      &lt;td&gt;Female Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;16&lt;/th&gt;
      &lt;td&gt;r_sexv_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Reading -- No Sex Info Students&lt;/td&gt;
      &lt;td&gt;[# Tested ,  Reading ,  No Sex Info Students]&lt;/td&gt;
      &lt;td&gt;Reading&lt;/td&gt;
      &lt;td&gt;No Sex Info Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;17&lt;/th&gt;
      &lt;td&gt;r_ethh_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Reading -- Hispanic/Latino Students&lt;/td&gt;
      &lt;td&gt;[# Tested ,  Reading ,  Hispanic/Latino Students]&lt;/td&gt;
      &lt;td&gt;Reading&lt;/td&gt;
      &lt;td&gt;Hispanic/Latino Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;18&lt;/th&gt;
      &lt;td&gt;r_ethi_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Reading -- American Indian or Alaska Native Students&lt;/td&gt;
      &lt;td&gt;[# Tested ,  Reading ,  American Indian or Alaska Native Students]&lt;/td&gt;
      &lt;td&gt;Reading&lt;/td&gt;
      &lt;td&gt;American Indian or Alaska Native Students&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;19&lt;/th&gt;
      &lt;td&gt;r_etha_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Reading -- Asian Students&lt;/td&gt;
      &lt;td&gt;[# Tested ,  Reading ,  Asian Students]&lt;/td&gt;
      &lt;td&gt;Reading&lt;/td&gt;
      &lt;td&gt;Asian Students&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
<<<<<<< Updated upstream
&lt;/div&gt;
&lt;/div&gt;

=======
>>>>>>> Stashed changes
&lt;/div&gt;

&lt;h2&gt;Creating a New Variable Name&lt;/h2&gt;
&lt;p&gt;There are a few problematic characters like &lt;code&gt;#&lt;/code&gt; and &lt;code&gt;%&lt;/code&gt; in the names of the variables that should be replaced as well as replacing spaces and abbreviating some longer words in the names. This also uses some regex parsing to remove any text contained in parenthesis. &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;re&lt;/span&gt;

<<<<<<< Updated upstream
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Creating-a-New-Variable-Name"&gt;Creating a New Variable Name&lt;a class="anchor-link" href="#Creating-a-New-Variable-Name"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;There are a few problematic characters like &lt;code&gt;#&lt;/code&gt; and &lt;code&gt;%&lt;/code&gt; in the names of the variables that should be replaced as well as replacing spaces and abbreviating some longer words in the names. This also uses some regex parsing to remove any text contained in parenthesis.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[29]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;re&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;rename_variable&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;desc_list&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
=======
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;rename_variable&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;desc_list&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
>>>>>>> Stashed changes
&lt;span class="sd"&gt;    Replace special characters and append reporting category when present.&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;variable_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;desc_list&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lower&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strip&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;desc_list&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;variable_name&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;desc_list&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lower&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strip&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;replacements&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;-&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;#&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;n&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;%&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pct&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;average&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;avg&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;reporting category&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;rpt cat&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;_&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;__&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;_&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;old&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;new&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;replacements&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;items&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
        &lt;span class="n"&gt;variable_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;re&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sub&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;\([^()]*\)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;variable_name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strip&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;variable_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;variable_name&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;old&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;variable_name&lt;/span&gt;
<<<<<<< Updated upstream
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[30]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;name&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;desc_list&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;rename_variable&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[30]:&lt;/div&gt;

=======
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
>>>>>>> Stashed changes

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;name&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;desc_list&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;rename_variable&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Variable&lt;/th&gt;
      &lt;th&gt;Format_Type&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
      &lt;th&gt;desc_list&lt;/th&gt;
      &lt;th&gt;subject&lt;/th&gt;
      &lt;th&gt;student_group&lt;/th&gt;
      &lt;th&gt;name&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;campus&lt;/td&gt;
      &lt;td&gt;Character&lt;/td&gt;
      &lt;td&gt;Campus Number&lt;/td&gt;
      &lt;td&gt;[Campus Number]&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;campus_number&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;year&lt;/td&gt;
      &lt;td&gt;Character&lt;/td&gt;
      &lt;td&gt;Test Administration Year&lt;/td&gt;
      &lt;td&gt;[Test Administration Year]&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;test_administration_year&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;region&lt;/td&gt;
      &lt;td&gt;Character&lt;/td&gt;
      &lt;td&gt;Education Service Center (Region) Number&lt;/td&gt;
      &lt;td&gt;[Education Service Center (Region) Number]&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;education_service_center_number&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;district&lt;/td&gt;
      &lt;td&gt;Character&lt;/td&gt;
      &lt;td&gt;District Number&lt;/td&gt;
      &lt;td&gt;[District Number]&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;district_number&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;dname&lt;/td&gt;
      &lt;td&gt;Character&lt;/td&gt;
      &lt;td&gt;District Name&lt;/td&gt;
      &lt;td&gt;[District Name]&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;district_name&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;cname&lt;/td&gt;
      &lt;td&gt;Character&lt;/td&gt;
      &lt;td&gt;Campus Name&lt;/td&gt;
      &lt;td&gt;[Campus Name]&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;campus_name&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;grade&lt;/td&gt;
      &lt;td&gt;Character&lt;/td&gt;
      &lt;td&gt;Tested Grade (Usually the Enrolled Grade Unless Student Tested Above Grade)&lt;/td&gt;
      &lt;td&gt;[Tested Grade (Usually the Enrolled Grade Unless Student Tested Above Grade)]&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;tested_grade&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;r_all_docs_n&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Answer Documents Submitted -- Reading -- All Students&lt;/td&gt;
      &lt;td&gt;[# Answer Documents Submitted ,  Reading ,  All Students]&lt;/td&gt;
      &lt;td&gt;Reading&lt;/td&gt;
      &lt;td&gt;All Students&lt;/td&gt;
      &lt;td&gt;n_answer_documents_submitted&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;r_all_abs_n&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Absent - Not Tested -- Reading -- All Students&lt;/td&gt;
      &lt;td&gt;[# Absent - Not Tested ,  Reading ,  All Students]&lt;/td&gt;
      &lt;td&gt;Reading&lt;/td&gt;
      &lt;td&gt;All Students&lt;/td&gt;
      &lt;td&gt;n_absent_not_tested&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;r_all_oth_n&lt;/td&gt;
<<<<<<< Updated upstream
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Other - Not Tested -- Reading -- All Students&lt;/td&gt;
      &lt;td&gt;[# Other - Not Tested ,  Reading ,  All Students]&lt;/td&gt;
      &lt;td&gt;Reading&lt;/td&gt;
      &lt;td&gt;All Students&lt;/td&gt;
      &lt;td&gt;n_other_not_tested&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10&lt;/th&gt;
      &lt;td&gt;m_all_docs_n&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
=======
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Other - Not Tested -- Reading -- All Students&lt;/td&gt;
      &lt;td&gt;[# Other - Not Tested ,  Reading ,  All Students]&lt;/td&gt;
      &lt;td&gt;Reading&lt;/td&gt;
      &lt;td&gt;All Students&lt;/td&gt;
      &lt;td&gt;n_other_not_tested&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10&lt;/th&gt;
      &lt;td&gt;m_all_docs_n&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
>>>>>>> Stashed changes
      &lt;td&gt;# Answer Documents Submitted -- Mathematics -- All Students&lt;/td&gt;
      &lt;td&gt;[# Answer Documents Submitted ,  Mathematics ,  All Students]&lt;/td&gt;
      &lt;td&gt;Mathematics&lt;/td&gt;
      &lt;td&gt;All Students&lt;/td&gt;
      &lt;td&gt;n_answer_documents_submitted&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;11&lt;/th&gt;
      &lt;td&gt;m_all_abs_n&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Absent - Not Tested -- Mathematics -- All Students&lt;/td&gt;
      &lt;td&gt;[# Absent - Not Tested ,  Mathematics ,  All Students]&lt;/td&gt;
      &lt;td&gt;Mathematics&lt;/td&gt;
      &lt;td&gt;All Students&lt;/td&gt;
      &lt;td&gt;n_absent_not_tested&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;12&lt;/th&gt;
      &lt;td&gt;m_all_oth_n&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Other - Not Tested -- Mathematics -- All Students&lt;/td&gt;
      &lt;td&gt;[# Other - Not Tested ,  Mathematics ,  All Students]&lt;/td&gt;
      &lt;td&gt;Mathematics&lt;/td&gt;
      &lt;td&gt;All Students&lt;/td&gt;
      &lt;td&gt;n_other_not_tested&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;13&lt;/th&gt;
      &lt;td&gt;r_all_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Reading -- All Students&lt;/td&gt;
      &lt;td&gt;[# Tested ,  Reading ,  All Students]&lt;/td&gt;
      &lt;td&gt;Reading&lt;/td&gt;
      &lt;td&gt;All Students&lt;/td&gt;
      &lt;td&gt;n_tested&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;14&lt;/th&gt;
      &lt;td&gt;r_sexm_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Reading -- Male Students&lt;/td&gt;
      &lt;td&gt;[# Tested ,  Reading ,  Male Students]&lt;/td&gt;
      &lt;td&gt;Reading&lt;/td&gt;
      &lt;td&gt;Male Students&lt;/td&gt;
      &lt;td&gt;n_tested&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;15&lt;/th&gt;
      &lt;td&gt;r_sexf_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Reading -- Female Students&lt;/td&gt;
      &lt;td&gt;[# Tested ,  Reading ,  Female Students]&lt;/td&gt;
      &lt;td&gt;Reading&lt;/td&gt;
      &lt;td&gt;Female Students&lt;/td&gt;
      &lt;td&gt;n_tested&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;16&lt;/th&gt;
      &lt;td&gt;r_sexv_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Reading -- No Sex Info Students&lt;/td&gt;
      &lt;td&gt;[# Tested ,  Reading ,  No Sex Info Students]&lt;/td&gt;
      &lt;td&gt;Reading&lt;/td&gt;
      &lt;td&gt;No Sex Info Students&lt;/td&gt;
      &lt;td&gt;n_tested&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;17&lt;/th&gt;
      &lt;td&gt;r_ethh_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Reading -- Hispanic/Latino Students&lt;/td&gt;
      &lt;td&gt;[# Tested ,  Reading ,  Hispanic/Latino Students]&lt;/td&gt;
      &lt;td&gt;Reading&lt;/td&gt;
      &lt;td&gt;Hispanic/Latino Students&lt;/td&gt;
      &lt;td&gt;n_tested&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;18&lt;/th&gt;
      &lt;td&gt;r_ethi_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Reading -- American Indian or Alaska Native Students&lt;/td&gt;
      &lt;td&gt;[# Tested ,  Reading ,  American Indian or Alaska Native Students]&lt;/td&gt;
      &lt;td&gt;Reading&lt;/td&gt;
      &lt;td&gt;American Indian or Alaska Native Students&lt;/td&gt;
      &lt;td&gt;n_tested&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;19&lt;/th&gt;
      &lt;td&gt;r_etha_d&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;# Tested -- Reading -- Asian Students&lt;/td&gt;
      &lt;td&gt;[# Tested ,  Reading ,  Asian Students]&lt;/td&gt;
      &lt;td&gt;Reading&lt;/td&gt;
      &lt;td&gt;Asian Students&lt;/td&gt;
      &lt;td&gt;n_tested&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
<<<<<<< Updated upstream
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Bringing-it-All-Together"&gt;Bringing it All Together&lt;a class="anchor-link" href="#Bringing-it-All-Together"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Because we're going to iterate over each variable list (there are six files: one for each grade between 3 and 8), we can simplify this by running all these change operations at once. We also want to remove unneeded columns and rename the original columns to standardize the naming conventions and make for an easy join condition later.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[31]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;add_descriptors&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
=======
&lt;/div&gt;

&lt;h2&gt;Bringing it All Together&lt;/h2&gt;
&lt;p&gt;Because we're going to iterate over each variable list (there are six files: one for each grade between 3 and 8), we can simplify this by running all these change operations at once. We also want to remove unneeded columns and rename the original columns to standardize the naming conventions and make for an easy join condition later.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;add_descriptors&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
>>>>>>> Stashed changes
    &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Variable&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Variable&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strip&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Description&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Description&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strip&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;desc_list&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Description&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;--&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;name&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;desc_list&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;rename_variable&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;subject&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;desc_list&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;get_subject&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;student_group&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;desc_list&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;get_student_group&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;drop&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Description&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;desc_list&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;inplace&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rename&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Variable&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;variable&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Format_Type&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;format_type&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="n"&gt;inplace&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

<<<<<<< Updated upstream
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[32]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;base_url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;https://tea.texas.gov/sites/default/files/&amp;quot;&lt;/span&gt;
=======
&lt;h2&gt;A Path Forward&lt;/h2&gt;
&lt;p&gt;That means it would be possible to pivot this data long for each distinct variable after extracting the subject and student group from the variable description. This information, though, is split across two different files: the test data in the &lt;code&gt;.dat&lt;/code&gt; files and the variable descriptions in the &lt;code&gt;.xls&lt;/code&gt; files. &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;My plan then is to:&lt;/strong&gt;
1. Match the corresponding dat file to its variable list
2. Pivot the test data long so that each variable and value is a single row
3. Extract the test subject and student group data points from the variable description
4. Join the two datasets together using the variable name as a unique identifier
5. Once more pivot the combined data such that each distinct variable becomes its own column
6. Combine those standardized data structures for each grade into a single dataset
7. Write that new dataset out to a compressed csv file for importing into BigQuery&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;base_url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;https://tea.texas.gov/sites/default/files/&amp;quot;&lt;/span&gt;
>>>>>>> Stashed changes
&lt;span class="n"&gt;dat_files&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;cfy21e3.dat&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;cfy21e4.dat&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;cfy21e5.dat&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;cfy21e6.dat&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;cfy21e7.dat&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;cfy21e8.dat&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;var_files&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;fy21_varlist_g03.xls&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;fy21_varlist_g04.xls&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;fy21_varlist_g05.xls&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;fy21_varlist_g06.xls&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;fy21_varlist_g07.xls&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;fy21_varlist_g08.xls&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="c1"&gt;# 1. Match the dat file with its corresponding var file&lt;/span&gt;
&lt;span class="n"&gt;all_files&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;zip&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dat_files&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;var_files&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# Create a list to concatenate the resulting grade level data frames later&lt;/span&gt;
&lt;span class="n"&gt;all_grades&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;dat_file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;var_file&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;all_files&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;test_data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_csv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;base_url&lt;/span&gt;&lt;span class="si"&gt;}{&lt;/span&gt;&lt;span class="n"&gt;dat_file&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dtype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;string&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;variables&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_excel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;base_url&lt;/span&gt;&lt;span class="si"&gt;}{&lt;/span&gt;&lt;span class="n"&gt;var_file&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dtype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;string&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Parsing:&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dat_file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;rows/cols:&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;test_data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


    &lt;span class="c1"&gt;# 2. melt the dataframe (pivot wide to long) but keep all the site and grade identifiers out of the pivot&lt;/span&gt;
    &lt;span class="n"&gt;identifiers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;variables&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;variables&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Format_Type&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Character&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Variable&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tolist&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;id_vars&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;identifier&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;upper&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;identifier&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;identifiers&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;test_data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;melt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;test_data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;id_vars&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;id_vars&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Pivoted:&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dat_file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;rows/cols:&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;test_data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;# 3. extract the subject and student groups&lt;/span&gt;
    &lt;span class="n"&gt;variables&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;add_descriptors&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;variables&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;# 4. join the two dataset together using the variable name as the unique identifier&lt;/span&gt;
    &lt;span class="n"&gt;combined&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;test_data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;merge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;variables&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;how&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;variable&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Joined:&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dat_file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;+&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;var_file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;rows/cols:&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;combined&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;# 5. pivot back wide but with only the distinct variables&lt;/span&gt;
    &lt;span class="n"&gt;cols&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;combined&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tolist&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;combined&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cols&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;combined&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cols&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strip&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
    &lt;span class="n"&gt;combined&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;columns&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;combined&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lower&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;columns&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;campus&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;region&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;district&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;dname&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;cname&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;grade&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;format_type&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;subject&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;student_group&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;combined&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;combined&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_index&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;value&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unstack&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reset_index&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Combined:&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dat_file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;+&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;var_file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;rows/cols:&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;combined&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;# 6. append data for each grade into a single data structure and concatenate&lt;/span&gt;
    &lt;span class="n"&gt;all_grades&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;combined&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;concat&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;all_grades&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Final rows/cols:&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# 7. write to compressed csv&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_csv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;TX_STAAR_3_8_2021.csv.gz&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;compression&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;gzip&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
<<<<<<< Updated upstream
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;WARNING *** OLE2 inconsistency: SSCS size is 0 but SSAT size is non-zero
Parsing: cfy21e3.dat rows/cols: (4643, 2093)
Pivoted: cfy21e3.dat rows/cols: (9685298, 9)
Joined: cfy21e3.dat + fy21_varlist_g03.xls rows/cols: (9685298, 13)
Combined: cfy21e3.dat + fy21_varlist_g03.xls rows/cols: (571089, 35)
WARNING *** OLE2 inconsistency: SSCS size is 0 but SSAT size is non-zero
Parsing: cfy21e4.dat rows/cols: (4622, 3075)
Pivoted: cfy21e4.dat rows/cols: (14180296, 9)
Joined: cfy21e4.dat + fy21_varlist_g04.xls rows/cols: (14180296, 13)
Combined: cfy21e4.dat + fy21_varlist_g04.xls rows/cols: (850448, 35)
WARNING *** OLE2 inconsistency: SSCS size is 0 but SSAT size is non-zero
Parsing: cfy21e5.dat rows/cols: (4415, 3197)
Pivoted: cfy21e5.dat rows/cols: (14083850, 9)
Joined: cfy21e5.dat + fy21_varlist_g05.xls rows/cols: (14083850, 13)
Combined: cfy21e5.dat + fy21_varlist_g05.xls rows/cols: (812360, 35)
WARNING *** OLE2 inconsistency: SSCS size is 0 but SSAT size is non-zero
Parsing: cfy21e6.dat rows/cols: (2700, 2093)
Pivoted: cfy21e6.dat rows/cols: (5632200, 9)
Joined: cfy21e6.dat + fy21_varlist_g06.xls rows/cols: (5632200, 13)
Combined: cfy21e6.dat + fy21_varlist_g06.xls rows/cols: (332100, 35)
WARNING *** OLE2 inconsistency: SSCS size is 0 but SSAT size is non-zero
Parsing: cfy21e7.dat rows/cols: (2337, 3075)
Pivoted: cfy21e7.dat rows/cols: (7169916, 9)
Joined: cfy21e7.dat + fy21_varlist_g07.xls rows/cols: (7169916, 13)
Combined: cfy21e7.dat + fy21_varlist_g07.xls rows/cols: (430008, 35)
WARNING *** OLE2 inconsistency: SSCS size is 0 but SSAT size is non-zero
Parsing: cfy21e8.dat rows/cols: (2370, 4301)
Pivoted: cfy21e8.dat rows/cols: (10176780, 9)
Joined: cfy21e8.dat + fy21_varlist_g08.xls rows/cols: (10176780, 13)
Combined: cfy21e8.dat + fy21_varlist_g08.xls rows/cols: (580650, 35)
Final rows/cols: (3576655, 35)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[33]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[33]:&lt;/div&gt;
=======
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
>>>>>>> Stashed changes

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;WARNING&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;***&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;OLE2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;inconsistency&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;SSCS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;but&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;SSAT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;non&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;zero&lt;/span&gt;
&lt;span class="n"&gt;Parsing&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cfy21e3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rows&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cols&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4643&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2093&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;Pivoted&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cfy21e3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rows&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cols&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;9685298&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;Joined&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cfy21e3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fy21_varlist_g03&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xls&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rows&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cols&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;9685298&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;Combined&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cfy21e3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fy21_varlist_g03&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xls&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rows&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cols&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;571089&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;35&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;WARNING&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;***&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;OLE2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;inconsistency&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;SSCS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;but&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;SSAT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;non&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;zero&lt;/span&gt;
&lt;span class="n"&gt;Parsing&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cfy21e4&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rows&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cols&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4622&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3075&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;Pivoted&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cfy21e4&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rows&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cols&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;14180296&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;Joined&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cfy21e4&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fy21_varlist_g04&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xls&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rows&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cols&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;14180296&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;Combined&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cfy21e4&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fy21_varlist_g04&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xls&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rows&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cols&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;850448&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;35&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;WARNING&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;***&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;OLE2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;inconsistency&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;SSCS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;but&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;SSAT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;non&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;zero&lt;/span&gt;
&lt;span class="n"&gt;Parsing&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cfy21e5&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rows&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cols&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4415&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3197&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;Pivoted&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cfy21e5&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rows&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cols&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;14083850&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;Joined&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cfy21e5&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fy21_varlist_g05&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xls&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rows&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cols&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;14083850&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;Combined&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cfy21e5&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fy21_varlist_g05&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xls&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rows&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cols&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;812360&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;35&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;WARNING&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;***&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;OLE2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;inconsistency&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;SSCS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;but&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;SSAT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;non&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;zero&lt;/span&gt;
&lt;span class="n"&gt;Parsing&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cfy21e6&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rows&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cols&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2700&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2093&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;Pivoted&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cfy21e6&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rows&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cols&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5632200&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;Joined&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cfy21e6&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fy21_varlist_g06&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xls&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rows&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cols&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5632200&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;Combined&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cfy21e6&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fy21_varlist_g06&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xls&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rows&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cols&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;332100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;35&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;WARNING&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;***&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;OLE2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;inconsistency&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;SSCS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;but&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;SSAT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;non&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;zero&lt;/span&gt;
&lt;span class="n"&gt;Parsing&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cfy21e7&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rows&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cols&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2337&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3075&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;Pivoted&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cfy21e7&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rows&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cols&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;7169916&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;Joined&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cfy21e7&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fy21_varlist_g07&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xls&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rows&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cols&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;7169916&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;Combined&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cfy21e7&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fy21_varlist_g07&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xls&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rows&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cols&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;430008&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;35&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;WARNING&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;***&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;OLE2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;inconsistency&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;SSCS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;but&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;SSAT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;non&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;zero&lt;/span&gt;
&lt;span class="n"&gt;Parsing&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cfy21e8&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rows&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cols&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2370&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;4301&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;Pivoted&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cfy21e8&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rows&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cols&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10176780&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;Joined&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cfy21e8&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fy21_varlist_g08&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xls&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rows&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cols&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10176780&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;Combined&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cfy21e8&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fy21_varlist_g08&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xls&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rows&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cols&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;580650&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;35&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;Final&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rows&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cols&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3576655&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;35&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;df&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;name&lt;/th&gt;
      &lt;th&gt;campus&lt;/th&gt;
      &lt;th&gt;year&lt;/th&gt;
      &lt;th&gt;region&lt;/th&gt;
      &lt;th&gt;district&lt;/th&gt;
      &lt;th&gt;dname&lt;/th&gt;
      &lt;th&gt;cname&lt;/th&gt;
      &lt;th&gt;grade&lt;/th&gt;
      &lt;th&gt;format_type&lt;/th&gt;
      &lt;th&gt;subject&lt;/th&gt;
      &lt;th&gt;student_group&lt;/th&gt;
      &lt;th&gt;NaN&lt;/th&gt;
      &lt;th&gt;avg_scale_score&lt;/th&gt;
      &lt;th&gt;n_absent_not_tested&lt;/th&gt;
      &lt;th&gt;n_answer_documents_submitted&lt;/th&gt;
      &lt;th&gt;n_approaches_grade_level_performance&lt;/th&gt;
      &lt;th&gt;n_avg_items_correctrpt_cat_1&lt;/th&gt;
      &lt;th&gt;n_avg_items_correctrpt_cat_2&lt;/th&gt;
      &lt;th&gt;n_avg_items_correctrpt_cat_3&lt;/th&gt;
      &lt;th&gt;n_avg_items_correctrpt_cat_4&lt;/th&gt;
      &lt;th&gt;n_did_not_meet_grade_level_performance&lt;/th&gt;
      &lt;th&gt;n_masters_grade_level_performance&lt;/th&gt;
      &lt;th&gt;n_meets_grade_level_performance&lt;/th&gt;
      &lt;th&gt;n_other_not_tested&lt;/th&gt;
      &lt;th&gt;n_tested&lt;/th&gt;
      &lt;th&gt;pct_absent_not_tested&lt;/th&gt;
      &lt;th&gt;pct_answer_documents_submitted&lt;/th&gt;
      &lt;th&gt;pct_approaches_grade_level_performance&lt;/th&gt;
      &lt;th&gt;pct_avg_items_correctrpt_cat_1&lt;/th&gt;
      &lt;th&gt;pct_avg_items_correctrpt_cat_2&lt;/th&gt;
      &lt;th&gt;pct_avg_items_correctrpt_cat_3&lt;/th&gt;
      &lt;th&gt;pct_avg_items_correctrpt_cat_4&lt;/th&gt;
      &lt;th&gt;pct_did_not_meet_grade_level_performance&lt;/th&gt;
      &lt;th&gt;pct_masters_grade_level_performance&lt;/th&gt;
      &lt;th&gt;pct_meets_grade_level_performance&lt;/th&gt;
      &lt;th&gt;pct_other_not_tested&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;001902103&lt;/td&gt;
      &lt;td&gt;21&lt;/td&gt;
      &lt;td&gt;07&lt;/td&gt;
      &lt;td&gt;001902&lt;/td&gt;
      &lt;td&gt;CAYUGA ISD&lt;/td&gt;
      &lt;td&gt;CAYUGA ELEM.&lt;/td&gt;
      &lt;td&gt;03&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;001902103&lt;/td&gt;
      &lt;td&gt;21&lt;/td&gt;
      &lt;td&gt;07&lt;/td&gt;
      &lt;td&gt;001902&lt;/td&gt;
      &lt;td&gt;CAYUGA ISD&lt;/td&gt;
      &lt;td&gt;CAYUGA ELEM.&lt;/td&gt;
      &lt;td&gt;03&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;Mathematics&lt;/td&gt;
      &lt;td&gt;All Students&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1607&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;26&lt;/td&gt;
      &lt;td&gt;22&lt;/td&gt;
      &lt;td&gt;6.3&lt;/td&gt;
      &lt;td&gt;10.7&lt;/td&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;3.3&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;16&lt;/td&gt;
      &lt;td&gt;19&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;26&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;100&lt;/td&gt;
      &lt;td&gt;85&lt;/td&gt;
      &lt;td&gt;79&lt;/td&gt;
      &lt;td&gt;83&lt;/td&gt;
      &lt;td&gt;71&lt;/td&gt;
      &lt;td&gt;84&lt;/td&gt;
      &lt;td&gt;15&lt;/td&gt;
      &lt;td&gt;62&lt;/td&gt;
      &lt;td&gt;73&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;001902103&lt;/td&gt;
      &lt;td&gt;21&lt;/td&gt;
      &lt;td&gt;07&lt;/td&gt;
      &lt;td&gt;001902&lt;/td&gt;
      &lt;td&gt;CAYUGA ISD&lt;/td&gt;
      &lt;td&gt;CAYUGA ELEM.&lt;/td&gt;
      &lt;td&gt;03&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;Mathematics&lt;/td&gt;
      &lt;td&gt;American Indian or Alaska Native Students&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;001902103&lt;/td&gt;
      &lt;td&gt;21&lt;/td&gt;
      &lt;td&gt;07&lt;/td&gt;
      &lt;td&gt;001902&lt;/td&gt;
      &lt;td&gt;CAYUGA ISD&lt;/td&gt;
      &lt;td&gt;CAYUGA ELEM.&lt;/td&gt;
      &lt;td&gt;03&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;Mathematics&lt;/td&gt;
      &lt;td&gt;Asian Students&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;001902103&lt;/td&gt;
      &lt;td&gt;21&lt;/td&gt;
      &lt;td&gt;07&lt;/td&gt;
      &lt;td&gt;001902&lt;/td&gt;
      &lt;td&gt;CAYUGA ISD&lt;/td&gt;
      &lt;td&gt;CAYUGA ELEM.&lt;/td&gt;
      &lt;td&gt;03&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;Mathematics&lt;/td&gt;
      &lt;td&gt;At-Risk Students&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1465&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;5.1&lt;/td&gt;
      &lt;td&gt;9.3&lt;/td&gt;
      &lt;td&gt;3.3&lt;/td&gt;
      &lt;td&gt;2.7&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;7&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;71&lt;/td&gt;
      &lt;td&gt;64&lt;/td&gt;
      &lt;td&gt;71&lt;/td&gt;
      &lt;td&gt;47&lt;/td&gt;
      &lt;td&gt;68&lt;/td&gt;
      &lt;td&gt;29&lt;/td&gt;
      &lt;td&gt;29&lt;/td&gt;
      &lt;td&gt;43&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;...&lt;/th&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;580645&lt;/th&gt;
      &lt;td&gt;254902001&lt;/td&gt;
      &lt;td&gt;21&lt;/td&gt;
      &lt;td&gt;20&lt;/td&gt;
      &lt;td&gt;254902&lt;/td&gt;
      &lt;td&gt;LA PRYOR ISD&lt;/td&gt;
      &lt;td&gt;LA PRYOR H.S.&lt;/td&gt;
      &lt;td&gt;08&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;Social Studies&lt;/td&gt;
      &lt;td&gt;Title-I Participant Students Codes: 6 7 9&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;3425&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;12&lt;/td&gt;
      &lt;td&gt;6.9&lt;/td&gt;
      &lt;td&gt;5.4&lt;/td&gt;
      &lt;td&gt;4.2&lt;/td&gt;
      &lt;td&gt;3.2&lt;/td&gt;
      &lt;td&gt;23&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;35&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;34&lt;/td&gt;
      &lt;td&gt;41&lt;/td&gt;
      &lt;td&gt;54&lt;/td&gt;
      &lt;td&gt;42&lt;/td&gt;
      &lt;td&gt;46&lt;/td&gt;
      &lt;td&gt;66&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;11&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;580646&lt;/th&gt;
      &lt;td&gt;254902001&lt;/td&gt;
      &lt;td&gt;21&lt;/td&gt;
      &lt;td&gt;20&lt;/td&gt;
      &lt;td&gt;254902&lt;/td&gt;
      &lt;td&gt;LA PRYOR ISD&lt;/td&gt;
      &lt;td&gt;LA PRYOR H.S.&lt;/td&gt;
      &lt;td&gt;08&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;Social Studies&lt;/td&gt;
      &lt;td&gt;Transitional Bilingual/Early Exit Students&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;580647&lt;/th&gt;
      &lt;td&gt;254902001&lt;/td&gt;
      &lt;td&gt;21&lt;/td&gt;
      &lt;td&gt;20&lt;/td&gt;
      &lt;td&gt;254902&lt;/td&gt;
      &lt;td&gt;LA PRYOR ISD&lt;/td&gt;
      &lt;td&gt;LA PRYOR H.S.&lt;/td&gt;
      &lt;td&gt;08&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;Social Studies&lt;/td&gt;
      &lt;td&gt;Transitional Bilingual/Late Exit Students&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;580648&lt;/th&gt;
      &lt;td&gt;254902001&lt;/td&gt;
      &lt;td&gt;21&lt;/td&gt;
      &lt;td&gt;20&lt;/td&gt;
      &lt;td&gt;254902&lt;/td&gt;
      &lt;td&gt;LA PRYOR ISD&lt;/td&gt;
      &lt;td&gt;LA PRYOR H.S.&lt;/td&gt;
      &lt;td&gt;08&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;Social Studies&lt;/td&gt;
      &lt;td&gt;Two or More Races Students&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;580649&lt;/th&gt;
      &lt;td&gt;254902001&lt;/td&gt;
      &lt;td&gt;21&lt;/td&gt;
      &lt;td&gt;20&lt;/td&gt;
      &lt;td&gt;254902&lt;/td&gt;
      &lt;td&gt;LA PRYOR ISD&lt;/td&gt;
      &lt;td&gt;LA PRYOR H.S.&lt;/td&gt;
      &lt;td&gt;08&lt;/td&gt;
      &lt;td&gt;Numeric&lt;/td&gt;
      &lt;td&gt;Social Studies&lt;/td&gt;
      &lt;td&gt;White Students&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;NA&amp;gt;&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;3576655 rows × 35 columns&lt;/p&gt;
&lt;/div&gt;

&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;The resulting dataset/file ends up being ~3.5 million rows in length and a consistent 35 columns wide. You can download the reshaped dataset here: &lt;a href="/extra/TX_STAAR_3_8_2021.csv.gz"&gt;TX STAAR 2021 - Grades 3-8&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;We can now run simpler queries on the reshaped data such as:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;SELECT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;
&lt;span class="k"&gt;FROM&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;TX_STAAR_2021&lt;/span&gt;
&lt;span class="k"&gt;WHERE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;subject&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Reading&amp;#39;&lt;/span&gt;
&lt;span class="k"&gt;AND&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;student_group&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;All Students&amp;#39;&lt;/span&gt;
&lt;span class="k"&gt;AND&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;grade&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;6&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;7&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;8&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;A similar query using the original datasets would've required unioning three different datasets and a much more complicated set of column matching to filter down to the right subject and student group. &lt;/p&gt;
&lt;p&gt;In our production environment, the approach is similar but we initially load the raw dat and var files into Google Cloud Storage and as well as the resulting csv. That is then converted to avro for better query performance and an &lt;a href="https://cloud.google.com/bigquery/docs/loading-data-cloud-storage-avro"&gt;external table&lt;/a&gt; is generated in BigQuery using their API. &lt;/p&gt;</content><category term="Tutorial"></category></entry><entry><title>Creating WordClouds</title><link href="http://dchess.github.io/creating-wordclouds.html" rel="alternate"></link><published>2021-02-04T21:00:00-07:00</published><updated>2021-02-04T21:00:00-07:00</updated><author><name>dc.hess@gmail.com</name></author><id>tag:dchess.github.io,2021-02-04:/creating-wordclouds.html</id><summary type="html">&lt;p&gt;Using python to turn paragraph text into word clouds&lt;/p&gt;</summary><content type="html">&lt;p&gt;Text analysis is hard, but one simple visual tool for extracting insights from dense text are word clouds. Word clouds help identify patterns in the preponderance of certain words in a body of text or within many bodies of text. The more frequently a word appears, the larger the word appears in the word cloud.&lt;/p&gt;
&lt;p&gt;But manually stripping words from paragraphs of text one by one is time consuming and mind-numbing. In the immortal words of &lt;a href="https://www.youtube.com/watch?v=UANN2Eu6ZnM&amp;amp;feature=youtu.be"&gt;Raymond Hettinger&lt;/a&gt;: &lt;em&gt;"There must be a better way!"&lt;/em&gt;&lt;/p&gt;
&lt;h2&gt;Generating Some Text&lt;/h2&gt;
&lt;p&gt;To start, let's create a bunch of text to generate a word cloud from. Using the &lt;a href="https://faker.readthedocs.io/en/master/"&gt;Faker&lt;/a&gt; package, we can create a single column dataframe where each row contains a paragraph of fake/non-sensical text.&lt;/p&gt;
&lt;p&gt;From there, we'll explore a simple way to parse out the frequency of individual words.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;faker&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Faker&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pandas&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pd&lt;/span&gt;

&lt;span class="n"&gt;fake&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Faker&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;

&lt;span class="c1"&gt;# Loop over a range of 5000 records and generate a random paragraph in a key:value pair.&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5000&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;fake&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;paragraph&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;variable_nb_sentences&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;

&lt;span class="c1"&gt;# Convert that list of dictionaries into a pandas dataframe&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DataFrame&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;text&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;Forget trip paper and Mr around lot.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;His include painting success amount child. Who...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;Every keep them against build ask. Practice fo...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;Worker run particular fish officer son. Reason...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;Rest environment must word. Allow brother bene...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;...&lt;/th&gt;
      &lt;td&gt;...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4995&lt;/th&gt;
      &lt;td&gt;Product activity paper power factor. Challenge...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4996&lt;/th&gt;
      &lt;td&gt;Choice consider deep quality right wrong. Rece...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4997&lt;/th&gt;
      &lt;td&gt;Kid car hotel field. So employee degree air de...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4998&lt;/th&gt;
      &lt;td&gt;Station authority benefit despite whether. Mov...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4999&lt;/th&gt;
      &lt;td&gt;Daughter ability player.&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;5000 rows × 1 columns&lt;/p&gt;
&lt;/div&gt;

&lt;p&gt;This gives us a dataframe of 5000 paragraphs to work with. Not something I'd want to do manually!&lt;/p&gt;
&lt;h2&gt;Splitting Paragraphs into Words&lt;/h2&gt;
&lt;p&gt;&lt;em&gt;Admittedly, there may be a more performant way to do this in pandas using vectorization instead of iterating row by row (sort of a no-no in dataframes), but I'm going to keep this simple and concise.&lt;/em&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Iterating through pandas objects is generally slow. In many cases, iterating manually over the rows is not needed and can be avoided (using) a vectorized solution: many operations can be performed using built-in methods or NumPy functions, (boolean) indexing.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The general approach here is to create a list to hold our extracted words (&lt;code&gt;word_list&lt;/code&gt;), then loop over each paragraph in the dataframe, splitting each word from the paragraph into an item in a list of its own. Then before looping to the next row, extending the original list&lt;sup&gt;*&lt;/sup&gt;. &lt;/p&gt;
&lt;p&gt;&lt;sup&gt;*&lt;/sup&gt; &lt;a href="https://stackoverflow.com/questions/252703/what-is-the-difference-between-pythons-list-methods-append-and-extend"&gt;Python extend vs append&lt;/a&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;word_list&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;iterrows&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="c1"&gt;# Strip out periods and make all words lowercase&lt;/span&gt;
    &lt;span class="n"&gt;words&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lower&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;.&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot; &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;word_list&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;extend&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;words&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# Show the first 10 records as example&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;word_list&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;[&lt;span class="s1"&gt;&amp;#39;forget&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;trip&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;paper&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;and&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;mr&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;around&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;lot&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;his&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;include&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;painting&amp;#39;&lt;/span&gt;]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Then we'll convert that list into a dataframe and name the column &lt;strong&gt;word&lt;/strong&gt; for easier reference later.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;df2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DataFrame&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;word&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;word_list&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
&lt;span class="n"&gt;df2&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;word&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;forget&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;trip&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;paper&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;and&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;mr&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;...&lt;/th&gt;
      &lt;td&gt;...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;69266&lt;/th&gt;
      &lt;td&gt;care&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;69267&lt;/th&gt;
      &lt;td&gt;talk&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;69268&lt;/th&gt;
      &lt;td&gt;daughter&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;69269&lt;/th&gt;
      &lt;td&gt;ability&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;69270&lt;/th&gt;
      &lt;td&gt;player&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;69271 rows × 1 columns&lt;/p&gt;
&lt;/div&gt;

&lt;h2&gt;Data Source&lt;/h2&gt;
&lt;p&gt;At this point we could load this dataframe into a database (perhaps using &lt;a href="https://sqlsorcery.readthedocs.io/en/latest/"&gt;SQLSorcery&lt;/a&gt; or similar tool) and move on to creating a word cloud in a data viz tool like &lt;a href="https://kb.tableau.com/articles/howto/creating-a-word-cloud"&gt;Tableau&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;But it would be neat to also do this in python while we're at it!&lt;/p&gt;
&lt;h2&gt;Word cloud&lt;/h2&gt;
&lt;p&gt;After installing the &lt;a href="https://pypi.org/project/wordcloud/"&gt;wordcloud&lt;/a&gt; package, we can load our dataframe in and begin visualizing. We'll want to remove some common words that won't give us much insight (such as pronouns, conjunctions, and similar filler). For a full list of what we'll filter out, see below.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;wordcloud&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;WordCloud&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;STOPWORDS&lt;/span&gt;

&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;STOPWORDS&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;{&lt;span class="s1"&gt;&amp;#39;over&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;he&amp;#39;d&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;we&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;some&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;k&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;further&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;yours&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;has&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;she&amp;#39;s&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;otherwise&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;she&amp;#39;ll&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;he&amp;#39;s&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;i&amp;#39;ll&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;so&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;being&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;to&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;are&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;weren&amp;#39;t&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;each&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;by&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;why&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;that&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;were&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;all&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;through&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;than&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;such&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;the&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;about&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;their&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;between&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;most&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ours&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;then&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;same&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;or&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;like&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;above&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;couldn&amp;#39;t&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;won&amp;#39;t&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;would&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;who&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;they&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;was&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;where&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;hasn&amp;#39;t&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;since&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;other&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;them&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;when&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;wouldn&amp;#39;t&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;herself&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;itself&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;shouldn&amp;#39;t&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;else&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;myself&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;under&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;only&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;they&amp;#39;re&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;if&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;it&amp;#39;s&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;when&amp;#39;s&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;she&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;there&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;here&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;how&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;these&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;against&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;here&amp;#39;s&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;no&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;theirs&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;doing&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ever&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;at&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;her&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;more&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;you&amp;#39;re&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;until&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;what&amp;#39;s&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;me&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;shall&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;we&amp;#39;d&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;cannot&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;i&amp;#39;d&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;www&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;he&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;can&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;very&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;it&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;they&amp;#39;ve&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;once&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;been&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;and&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;isn&amp;#39;t&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;therefore&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;i&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;could&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;is&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;him&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;hence&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;mustn&amp;#39;t&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;we&amp;#39;ll&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;he&amp;#39;ll&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;i&amp;#39;m&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;up&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;with&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;be&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;too&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;while&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;whom&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;your&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;again&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;com&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;let&amp;#39;s&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;have&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;in&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;few&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;own&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;we&amp;#39;re&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;below&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;don&amp;#39;t&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;you&amp;#39;ll&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;his&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;they&amp;#39;ll&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;however&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;shan&amp;#39;t&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;we&amp;#39;ve&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;can&amp;#39;t&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;during&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;having&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;not&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;yourself&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;you&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;yourselves&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;how&amp;#39;s&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ought&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;any&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;that&amp;#39;s&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;you&amp;#39;ve&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ourselves&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;on&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;because&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;should&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;also&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;for&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;she&amp;#39;d&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;into&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;this&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;where&amp;#39;s&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;i&amp;#39;ve&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;why&amp;#39;s&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;out&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;himself&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;am&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;do&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;aren&amp;#39;t&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;down&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;what&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;its&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;those&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;doesn&amp;#39;t&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;wasn&amp;#39;t&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;of&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;an&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;haven&amp;#39;t&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;there&amp;#39;s&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;get&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;didn&amp;#39;t&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;themselves&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;but&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;my&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;both&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;they&amp;#39;d&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;did&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;our&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;hadn&amp;#39;t&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;from&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;who&amp;#39;s&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;off&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;nor&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;before&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;had&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;a&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;after&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;which&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;as&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;you&amp;#39;d&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;just&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;hers&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;does&amp;#39;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;http&amp;#39;&lt;/span&gt;}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;wordcloud&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;WordCloud&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;STOPWORDS&lt;/span&gt;


&lt;span class="c1"&gt;# Create a word cloud with resolution of 1200 x 800 with a black background&lt;/span&gt;
&lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot; &amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;word&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;wordcloud&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;WordCloud&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;width&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1200&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;height&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;800&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;background_color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;black&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;stopwords&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;STOPWORDS&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;generate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;At this point we could spit this out to an image for presentation.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;wordcloud&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_file&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;wordcloud.jpg&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;But we could also use a plotting library like &lt;a href="https://matplotlib.org/"&gt;matplotlib&lt;/a&gt; to build a visualization with our wordcloud.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;


&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;facecolor&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;k&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;edgecolor&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;k&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;imshow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;wordcloud&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;interpolation&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;bilinear&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;off&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pad&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img alt="svg" src="word-cloud_files/word-cloud_11_0.svg"&gt;&lt;/p&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;And there we have it. &lt;strong&gt;A simple, repeatable method for extracting word frequency from paragraph text for use in generating word clouds.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;It really only required about 5 lines of code to extract the data:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;word_list&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;iterrows&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;words&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lower&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;.&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot; &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;word_list&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;extend&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;words&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DataFrame&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;word&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;word_list&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;And only another 10 or so to actually create a word cloud visualization as well!&lt;/p&gt;</content><category term="Tutorial"></category></entry><entry><title>Auto-generated REST API for MS SQL database</title><link href="http://dchess.github.io/auto-generated-rest-api-for-ms-sql-database.html" rel="alternate"></link><published>2021-01-16T17:00:00-08:00</published><updated>2021-01-16T17:00:00-08:00</updated><author><name>dc.hess@gmail.com</name></author><id>tag:dchess.github.io,2021-01-16:/auto-generated-rest-api-for-ms-sql-database.html</id><summary type="html">&lt;p&gt;Creating an automatic REST API with Flask and SQLSorcery for an MS SQL database.&lt;/p&gt;</summary><content type="html">&lt;h2&gt;The Concept&lt;/h2&gt;
&lt;p&gt;Suppose you have a database with tables and views that you want to expose as JSON through
a REST API but you don't want to couple the database tables with object models in your
API but rather have it simply expose the data for querying (read-only). &lt;/p&gt;
&lt;p&gt;How could this be done easily and with minimal code?&lt;/p&gt;
&lt;h2&gt;The Approach&lt;/h2&gt;
&lt;p&gt;&lt;a href="https://flask.palletsprojects.com/en/1.1.x/"&gt;Flask&lt;/a&gt; has to be the simplest web app microframework
I've ever dealt with (though Node's &lt;a href="https://expressjs.com/"&gt;Express&lt;/a&gt; and Ruby's 
&lt;a href="http://sinatrarb.com/"&gt;Sinatra&lt;/a&gt; certainly come close). It has a great function &lt;code&gt;jsonify&lt;/code&gt; that
makes it dead simple to serve a JSON response to a client request.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# app.py&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;flask&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Flask&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;jsonify&lt;/span&gt;

&lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Flask&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="vm"&gt;__name__&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="nd"&gt;@app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/api/&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;index&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;name&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;dchess&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;text&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Hello, World&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;jsonify&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Spin it up on &lt;code&gt;localhost:5000/api/&lt;/code&gt; and voila, data!&lt;/p&gt;
&lt;h2&gt;Here comes the Sorcery&lt;/h2&gt;
&lt;p&gt;That's simple enough but how do we substitute the hard coded dictionary for a database query? This is
where &lt;a href="https://www.sqlalchemy.org/"&gt;SQLAlchemy&lt;/a&gt; and &lt;a href="https://pandas.pydata.org/"&gt;Pandas&lt;/a&gt; come in handy.&lt;/p&gt;
&lt;p&gt;I almost always want to use these two packages together and so a while back I created a pypi package to
provide a simple facade with some syntactic sugar to make that even simpler called &lt;a href="https://sqlsorcery.readthedocs.io/en/latest/"&gt;SQLSorcery&lt;/a&gt;. It's built on top of both of them and has a simple way &lt;a href="https://sqlsorcery.readthedocs.io/en/latest/cookbook/installation.html"&gt;to optionally install
database adapter packages&lt;/a&gt; like &lt;a href="https://pypi.org/project/pyodbc/"&gt;pyodbc&lt;/a&gt;. &lt;/p&gt;
&lt;p&gt;That allows me to easily pass in my database connection credentials with environment
variables and make sql queries using the Pandas &lt;code&gt;.read_sql_query()&lt;/code&gt; method. &lt;/p&gt;
&lt;h2&gt;Environment&lt;/h2&gt;
&lt;p&gt;I'm a fan of &lt;a href="https://pipenv.pypa.io/en/latest/"&gt;Pipenv&lt;/a&gt;. It's so simple to install python package dependencies
into a local virtual environment and also handle environment variables from a &lt;code&gt;.env&lt;/code&gt; file. Effectively combining
all the functionality of &lt;a href="https://pypi.org/project/pip/"&gt;pip&lt;/a&gt;, &lt;a href="https://docs.python.org/3/tutorial/venv.html"&gt;venv&lt;/a&gt;, and &lt;a href="https://saurabh-kumar.com/python-dotenv/"&gt;python-dotenv&lt;/a&gt;. &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pipenv&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;install&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Flask&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sqlsorcery&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;mssql&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;And just like that we're ready to develop.&lt;/p&gt;
&lt;p&gt;Let's add some environment variables to a &lt;code&gt;.env&lt;/code&gt; file to start:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;DB_SERVER=
DB=
DB_SCHEMA=
DB_USER=
DB_PWD=

FLASK_APP=app.py
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2&gt;Querying our Data&lt;/h2&gt;
&lt;p&gt;Then we can return data from a table as simple as:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;sqlsorcery&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;MSSQL&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pandas&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pd&lt;/span&gt;

&lt;span class="n"&gt;db&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MSSQL&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_sql_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;your_table_name&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;con&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;engine&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;schema&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;schema&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;It's that simple!&lt;/p&gt;
&lt;p&gt;To quickly convert that dataframe into a list of dictionaries (to return as JSON), we
can use the Pandas &lt;code&gt;to_dict()&lt;/code&gt; method.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_dict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;orient&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;records&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;What if we want to list all the tables in our database schema? Simple!&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;tables&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;engine&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;table_names&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;schema&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;schema&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;With those two approaches and Flask's &lt;code&gt;jsonify&lt;/code&gt; we have everything we need to make a quick,
easy, and minimal API on top of any tables in our database schema.&lt;/p&gt;
&lt;h2&gt;A User Interface&lt;/h2&gt;
&lt;p&gt;While we can create an API for machines to read from, it'd be nice to have at least an index of
tables that a human can read, navigate, and learn what data exists before pointing tools like &lt;a href="https://curl.se/"&gt;curl&lt;/a&gt;, 
&lt;a href="https://www.postman.com/"&gt;postman&lt;/a&gt;, or &lt;a href="https://requests.readthedocs.io/en/master/"&gt;Requests&lt;/a&gt; at it. &lt;/p&gt;
&lt;p&gt;No worries! A tiny &lt;a href="https://jinja.palletsprojects.com/en/2.11.x/"&gt;jinja&lt;/a&gt; HTML template should suffice for a quick list of table names linked to their api endpoint will be just minimal enough to work!&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;# templates/index.html
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;ul&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    {% for table in tables %}
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;a&lt;/span&gt; &lt;span class="na"&gt;href&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;/api/{{ table}}&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;{{ table }}&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;a&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    {% endfor %}
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;ul&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2&gt;Putting it all together&lt;/h2&gt;
&lt;p&gt;At this point we should have a file directory that looks like this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;.
├──&lt;span class="w"&gt; &lt;/span&gt;Pipfile
├──&lt;span class="w"&gt; &lt;/span&gt;.env
├──&lt;span class="w"&gt; &lt;/span&gt;app.py
└──&lt;span class="w"&gt; &lt;/span&gt;templates
&lt;span class="w"&gt;    &lt;/span&gt;└──&lt;span class="w"&gt; &lt;/span&gt;index.html
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Let's finish off our &lt;code&gt;app.py&lt;/code&gt; and give it a test run:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# app.py&lt;/span&gt;

&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;flask&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Flask&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;jsonify&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;render_template&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;sqlsorcery&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;MSSQL&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pandas&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pd&lt;/span&gt;

&lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Flask&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="vm"&gt;__name__&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;db&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MSSQL&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;


&lt;span class="nd"&gt;@app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/api&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;index&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;tables&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;engine&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;table_names&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;schema&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;schema&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;render_template&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;index.html&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tables&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;tables&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="nd"&gt;@app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/api/&amp;lt;table&amp;gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;methods&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;GET&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;endpoint&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_sql_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;con&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;engine&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;schema&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;schema&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_dict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;orient&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;records&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;jsonify&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Spin it up on &lt;a href="localhost:5000/api/"&gt;localhost:5000/api/&lt;/a&gt; and explore your data!&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;pipenv&lt;span class="w"&gt; &lt;/span&gt;run&lt;span class="w"&gt; &lt;/span&gt;flask&lt;span class="w"&gt; &lt;/span&gt;run
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;I wouldn't take this and deploy it to production anywhere without some serious security
decisions, but it makes for a nice proof-of-concept. And certainly could be expanded to
include user authentication, a proper production server like &lt;a href="https://gunicorn.org/"&gt;gunicorn&lt;/a&gt; and a nicer
user interface. But at point you might be better off with &lt;a href="https://www.flaskapi.org/"&gt;Flask-API&lt;/a&gt; or 
&lt;a href="https://www.django-rest-framework.org/"&gt;Django REST Framework&lt;/a&gt;, both of which I've used with success. &lt;/p&gt;
&lt;p&gt;But still, not bad for less than 20 lines of code. &lt;/p&gt;
&lt;p&gt;All the code for this blog can be found on my &lt;a href="https://github.com/dchess/simple_api"&gt;github&lt;/a&gt;. 
Feel free to fork and use it however you like. &lt;/p&gt;
&lt;p&gt;SQLSorcery is also MIT licensed and free to use. It's in active development and contributors are welcome. &lt;/p&gt;</content><category term="Blog"></category></entry><entry><title>Virtual K-12 Tableau User Group - 14 January 2021</title><link href="http://dchess.github.io/virtual-k-12-tableau-user-group-14-january-2021.html" rel="alternate"></link><published>2021-01-14T10:30:00-08:00</published><updated>2021-01-14T10:30:00-08:00</updated><author><name>dc.hess@gmail.com</name></author><id>tag:dchess.github.io,2021-01-14:/virtual-k-12-tableau-user-group-14-january-2021.html</id><summary type="html">&lt;p&gt;Sharing our Student Support Spotlight Dashboard with the K-12 Tableau User Group&lt;/p&gt;</summary><content type="html">&lt;h2&gt;Student Support Spotlight&lt;/h2&gt;
&lt;p&gt;In the wake of COVID19, we needed to provide &lt;a href="www.kippnorcal.org"&gt;our schools&lt;/a&gt; with a way to identify students who would most benefit from additional supports to access distance learning. &lt;/p&gt;
&lt;p&gt;My colleague, &lt;a href="https://tvisig.github.io/"&gt;Tvisi Ravi&lt;/a&gt; and I &lt;a href="https://usergroups.tableau.com/virtualk12tugjan"&gt;presented&lt;/a&gt; our approach to developing this tool in partnership with our school teams and provided a demo of how the tool can be used. Lastly, we gave an overview of the impact it has had in our schools so far. &lt;/p&gt;
&lt;p&gt;I've preset the video below to begin when we started presenting, but the prior demo from &lt;a href="https://www.bvsd.org/"&gt;Boulder Valley School District&lt;/a&gt; is also worth a watch!&lt;/p&gt;
&lt;p style="text-align:center;"&gt;
&lt;iframe width="560" height="315" src="https://www.youtube.com/embed/QiJOiDGmVpg?controls=0&amp;amp;start=2814" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen align="middle"&gt;&lt;/iframe&gt;
&lt;/p&gt;

&lt;h2&gt;Using Demo Data&lt;/h2&gt;
&lt;p&gt;One technique we used in order to easily prepare our student data for a public audience was to obfuscate our student names and alias our school names to quickly make this data anonymous without having to build a tool in parallel or have to duplicate the underlying data source with completely fake data. &lt;/p&gt;
&lt;p&gt;To accomplish this we used two approaches, in our underlying student data in &lt;a href="https://www.renaissance.com/products/schoolzilla/"&gt;Schoolzilla&lt;/a&gt; there is a &lt;code&gt;ScrambledName&lt;/code&gt; field we swapped our actual student names with. Secondly, we used Tableau's aliasing feature to rename our schools and published the alternate report to our Tableau server as a "Demo Version". &lt;/p&gt;
&lt;p&gt;This has also been useful internally for developing screencast tutorials without needing to expose any sensitive student information to the viewers of those tutorials. &lt;/p&gt;</content><category term="Projects"></category></entry><entry><title>How I Teach Git</title><link href="http://dchess.github.io/how-i-teach-git.html" rel="alternate"></link><published>2021-01-13T21:00:00-08:00</published><updated>2021-01-13T21:00:00-08:00</updated><author><name>dc.hess@gmail.com</name></author><id>tag:dchess.github.io,2021-01-13:/how-i-teach-git.html</id><summary type="html">&lt;p&gt;An overview of how I explain Git to others new to using it for version control&lt;/p&gt;</summary><content type="html">&lt;h2&gt;Teaching Commands Just Encourages Cargo Culting&lt;/h2&gt;
&lt;p&gt;When I first learned to use Git, it supercharged my development and I was quickly sold on its
value, but I had no real understanding of how it worked. I just memorized and/or frequently
Googled the right commands and hoped I never encountered any issue I couldn't solve on my 
own or find a solution for in &lt;a href="https://ohshitgit.com/"&gt;Oh Shit, Git!?!&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Even since spending the time to understand it better, I've had a fewer and fewer encounters where a
major malfunction like someone pushing production security keys to a public repo has resulted
in nuking the repo and starting fresh. &lt;strong&gt;Luckily that's only happened on very nascent projects
where that &lt;em&gt;really&lt;/em&gt; was the simplest solution.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;That being said, I wouldn't wish that learning curve on anyone with half a brain and any less
persistence than me. I've been known to call myself the wrecking ball because when all else fails
I keep throwing myself at the wall until it crumbles. I'm stubborn to a fault, but I get things done.&lt;/p&gt;
&lt;h2&gt;How Git Tracks Changes&lt;/h2&gt;
&lt;p&gt;While searching for better ways to teach about the change tracking concepts in Git, I came across &lt;a href="http://pel-daniel.github.io/git-init/"&gt;this
interactive visualization&lt;/a&gt; which I thought was incredibly helpful
for wrapping your head around what's happening when you type in those magical commands.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Image Git Change Tracking Visualized" src="/images/git_visualized.png"&gt;&lt;/p&gt;
&lt;h3&gt;Working Tree/Directory&lt;/h3&gt;
&lt;p&gt;This context encapsulates the untracked changes to files in an initialized (&lt;code&gt;git init&lt;/code&gt;) repository.&lt;/p&gt;
&lt;h3&gt;Staging Area&lt;/h3&gt;
&lt;p&gt;This context encapsulated the tracked changes to files and allows you to review atomic changes as well as control the granularity of commits. Files are &lt;strong&gt;added&lt;/strong&gt; here to be tracked. &lt;/p&gt;
&lt;h3&gt;Local Repository&lt;/h3&gt;
&lt;p&gt;This is like a small database in which you can make save points or &lt;strong&gt;commits&lt;/strong&gt; in your file history. It lives in a special hidden folder in the directory (&lt;code&gt;.git/&lt;/code&gt;)&lt;/p&gt;
&lt;h3&gt;Remote Repository&lt;/h3&gt;
&lt;p&gt;This is a centralized version/copy of the git repository that lives on a different computer or hosted service like Github, Gitlab, Bitbucket, or even a self hosted server. Changes are &lt;strong&gt;pushed&lt;/strong&gt; to the remote repository.&lt;/p&gt;
&lt;h2&gt;Git Collaboration with Feature Branch Workflow&lt;/h2&gt;
&lt;p&gt;I generally find the simplest way to collaborate with others in a codebase is the &lt;a href="https://www.atlassian.com/git/tutorials/comparing-workflows/feature-branch-workflow"&gt;feature branch workflow&lt;/a&gt; approach. Each dev works on a separate
and &lt;em&gt;limited in scope&lt;/em&gt; feature branch, code reviews happen in pull requests, and then code is frequently merged into the &lt;code&gt;main&lt;/code&gt; not &lt;code&gt;master&lt;/code&gt; branch (&lt;a href="https://dev.to/afrodevgirl/replacing-master-with-main-in-github-2fjf"&gt;see here&lt;/a&gt; for a great reason to start using main instead of master).&lt;/p&gt;
&lt;p&gt;&lt;img alt="Image Feature Branch Workflow" src="/images/git_workflow.png"&gt;&lt;/p&gt;
&lt;h3&gt;Git Workflow in 10 Steps&lt;/h3&gt;
&lt;p&gt;Ok, so I know I said don't &lt;em&gt;just&lt;/em&gt; memorize commands, but these are the 10 commands to &lt;strong&gt;commit&lt;/strong&gt; (see what I did there?) to memory.&lt;/p&gt;
&lt;h4&gt;1. Clone new repo or pull changes to main branch for existing&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;clone&lt;span class="w"&gt; &lt;/span&gt;https://github.com/the-repos-url.git
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;OR&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;pull&lt;span class="w"&gt; &lt;/span&gt;origin&lt;span class="w"&gt; &lt;/span&gt;main
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h4&gt;2. Checkout a local feature branch to make changes&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;checkout&lt;span class="w"&gt; &lt;/span&gt;-b&lt;span class="w"&gt; &lt;/span&gt;my_new_branch
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h4&gt;3. Commit after making your code changes (&lt;a href="https://chris.beams.io/posts/git-commit/"&gt;writing good commits&lt;/a&gt;)&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;add&lt;span class="w"&gt; &lt;/span&gt;-A
$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;commit&lt;span class="w"&gt; &lt;/span&gt;-m&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Add some new functionality&amp;quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h4&gt;4. Push changes to a remote feature branch&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;push&lt;span class="w"&gt; &lt;/span&gt;origin&lt;span class="w"&gt; &lt;/span&gt;my_new_branch
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h4&gt;5. Open a Pull Request (and request reviewers)&lt;/h4&gt;
&lt;p&gt;&lt;img alt="Image Github PR button" src="/images/pr_button.png"&gt;&lt;/p&gt;
&lt;h4&gt;6. Code Review: Responding to change requests&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;add&lt;span class="w"&gt; &lt;/span&gt;-A
$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;commit&lt;span class="w"&gt; &lt;/span&gt;-m&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Fix issue raised in code review&amp;quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h4&gt;7. Code Review: Approved&lt;/h4&gt;
&lt;p&gt;&lt;img alt="Image Github PR approval" src="/images/approve_pr.png"&gt;&lt;/p&gt;
&lt;h4&gt;8. Merge (or squash merge) into main branch&lt;/h4&gt;
&lt;p&gt;&lt;img alt="Image Github merge approved changes dialog" src="/images/merge_changes.png"&gt;&lt;/p&gt;
&lt;h4&gt;9. Checkout main (locally)&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;checkout&lt;span class="w"&gt; &lt;/span&gt;main
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h4&gt;10. Pull changes (back to step 1)&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;pull&lt;span class="w"&gt; &lt;/span&gt;origin&lt;span class="w"&gt; &lt;/span&gt;main
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;em&gt;Rinse and repeat for the next feature!&lt;/em&gt;&lt;/p&gt;
&lt;h2&gt;Common Git Commands and What They Do&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;clone&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# copy remote repos to local&lt;/span&gt;
$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;checkout&lt;span class="w"&gt; &lt;/span&gt;-b&lt;span class="w"&gt; &lt;/span&gt;branch_name&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# create and checkout a new branch&lt;/span&gt;
$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;add&lt;span class="w"&gt; &lt;/span&gt;-A&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# add all changed files to staging&lt;/span&gt;
$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;status&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# view status of the working directory and staging area&lt;/span&gt;
$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;diff&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# view changes made on file(s)&lt;/span&gt;
$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;commit&lt;span class="w"&gt; &lt;/span&gt;-m&lt;span class="w"&gt; &lt;/span&gt;“Your&lt;span class="w"&gt; &lt;/span&gt;message&lt;span class="w"&gt; &lt;/span&gt;goes&lt;span class="w"&gt; &lt;/span&gt;here”&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;#  save changes to local repo&lt;/span&gt;
$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;pull&lt;span class="w"&gt; &lt;/span&gt;origin&lt;span class="w"&gt; &lt;/span&gt;main&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;#  get changes to main branch from remote repo&lt;/span&gt;
$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;fetch&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;#  get references to all remote branches, so they can be checked out&lt;/span&gt;
$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;push&lt;span class="w"&gt; &lt;/span&gt;origin&lt;span class="w"&gt; &lt;/span&gt;branch_name&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;#  push local changes to remote repo&lt;/span&gt;
$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;merge&lt;span class="w"&gt; &lt;/span&gt;main&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;#  merge changes to main branch into another branch&lt;/span&gt;
$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;log&lt;span class="w"&gt; &lt;/span&gt;--oneline&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;#  view list of commit messages&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3&gt;A Few More and When to Use Them&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;stash&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;#  temporarily store changes in order to switch contexts&lt;/span&gt;
$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;stash&lt;span class="w"&gt; &lt;/span&gt;pop&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;#  restore temporarily stored changes&lt;/span&gt;
$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;reset&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;#  reset tracked file(s) to untracked (can also be used for dangerous reverts)&lt;/span&gt;
$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;revert&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;#  safer way to undo changes (fail forward)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2&gt;Creating Branches (when, why, how)&lt;/h2&gt;
&lt;p&gt;&lt;img alt="Image Checkout Branch Diagram" src="/images/new_branch.png"&gt;&lt;/p&gt;
&lt;h3&gt;When&lt;/h3&gt;
&lt;p&gt;As a rule you should use branches liberally. Anytime you need to make a change or set of changes to the code base, you should create a  “feature” branch to isolate those changes. &lt;/p&gt;
&lt;h3&gt;Why&lt;/h3&gt;
&lt;p&gt;Isolating your changes to a branch prevents conflicts with other collaborators and helps you experiment without fear of making “breaking” changes to the main codebase. Great for experimenting!&lt;/p&gt;
&lt;h3&gt;How&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;branch&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;#  list all local branches&lt;/span&gt;
$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;branch&lt;span class="w"&gt; &lt;/span&gt;new_branch_name&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;#  create a new branch&lt;/span&gt;
$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;checkout&lt;span class="w"&gt; &lt;/span&gt;new_branch_name&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;#  switch to that new branch&lt;/span&gt;
$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;checkout&lt;span class="w"&gt; &lt;/span&gt;-b&lt;span class="w"&gt; &lt;/span&gt;new_branch_name&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;#  create and checkout in one step&lt;/span&gt;
$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;branch&lt;span class="w"&gt; &lt;/span&gt;-d&lt;span class="w"&gt; &lt;/span&gt;new_branch_name&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;#  delete a branch safely (error if unmerged)&lt;/span&gt;
$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;branch&lt;span class="w"&gt; &lt;/span&gt;-D&lt;span class="w"&gt; &lt;/span&gt;new_branch_name&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;#  force delete (can delete unmerged)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2&gt;Pull Requests&lt;/h2&gt;
&lt;p&gt;Pull requests let you tell others about changes you've pushed to a branch in a repository on GitHub. Once a pull request is opened, you can discuss and review the potential changes with collaborators and add follow-up commits before your changes are merged into the base branch&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Code Review&lt;/strong&gt; (Approve, Request Changes, Comment) →  &lt;strong&gt;Merge&lt;/strong&gt; → &lt;strong&gt;Deploy&lt;/strong&gt; &lt;/p&gt;
&lt;h2&gt;Pulling Changes from &lt;code&gt;main&lt;/code&gt; to a Local Branch AKA Merging Locally&lt;/h2&gt;
&lt;p&gt;&lt;img alt="Image Local Merge Diagram" src="/images/merge_local.png"&gt;&lt;/p&gt;
&lt;h3&gt;When&lt;/h3&gt;
&lt;p&gt;A change on main affects your local branch and you need to integrate them into your local changes. This is the same process Github runs when a PR is approved and merged into the main branch.&lt;/p&gt;
&lt;h3&gt;Why&lt;/h3&gt;
&lt;p&gt;Resolving merge conflicts locally before creating PR allows for simpler code review and prevents complications in getting your changes integrated into the main branch. &lt;/p&gt;
&lt;h3&gt;How&lt;/h3&gt;
&lt;p&gt;First commit or stash any changes you are currently working on. Then checkout main and pull changes from the remote repo. Checkout your feature branch again and run &lt;code&gt;git merge main&lt;/code&gt; to begin the merge process. If there are any merge conflicts, resolve them by choosing which segment of code to keep and then make a new commit. &lt;/p&gt;
&lt;h2&gt;Links to Additional Resources&lt;/h2&gt;
&lt;h3&gt;Guides&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://blog.jetbrains.com/datagrip/2018/06/01/tutorial-how-to-use-git-with-datagrip/"&gt;How to Use Git with DataGrip&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://guides.github.com/activities/hello-world/"&gt;Github Hello World Guide&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.atlassian.com/git/tutorials/comparing-workflows/feature-branch-workflow"&gt;Git Feature Branch Workflow&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://chris.beams.io/posts/git-commit/"&gt;How to Write a Git Commit Message&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.atlassian.com/git/tutorials/undoing-changes/git-reset"&gt;Git Reset&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.atlassian.com/git/tutorials/undoing-changes/git-revert"&gt;Git Revert&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.atlassian.com/git/tutorials/git-alias"&gt;Git Alias&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.atlassian.com/git/tutorials/setting-up-a-repository/git-config"&gt;git config&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://ohshitgit.com/"&gt;Oh Shit, Git!?!&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://blog.gitguardian.com/secrets-credentials-api-git/"&gt;Why secrets inside git are such a problem&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/UnseenWizzard/git_training"&gt;Git Training&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Visualizations&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://pel-daniel.github.io/git-init/"&gt;Git Init Tutorial&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://veerasundar.com/blog/2018/03/gitflow-animated/"&gt;Gitflow: Animated&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Tools&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://www.jetbrains.com/help/datagrip/github.html"&gt;Github Plugin for DataGrip&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.jetbrains.com/help/datagrip/terminal-emulator.html"&gt;Terminal Plugin for DataGrip&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://marketplace.visualstudio.com/items?itemName=donjayamanne.githistory"&gt;Git History Plugin for VS Code&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://marketplace.visualstudio.com/items?itemName=eamodio.gitlens"&gt;GitLens Plugin for VS Code&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><category term="Blog"></category></entry><entry><title>Normalize JSON with Pandas</title><link href="http://dchess.github.io/normalize-json-with-pandas.html" rel="alternate"></link><published>2021-01-12T21:00:00-07:00</published><updated>2021-01-12T21:00:00-07:00</updated><author><name>dc.hess@gmail.com</name></author><id>tag:dchess.github.io,2021-01-12:/normalize-json-with-pandas.html</id><summary type="html">&lt;p&gt;An explanation about using the pandas json_normalize function to handle nested JSON data.&lt;/p&gt;</summary><content type="html">&lt;p&gt;When processing nested &lt;code&gt;JSON&lt;/code&gt; data into a flat structure for importing into a relational database, it can be tricky to structure the data into the right shape. &lt;a href="https://pandas.pydata.org/"&gt;Pandas&lt;/a&gt; has a great tool for doing this called &lt;code&gt;pandas.json_normalize()&lt;/code&gt; but the &lt;a href="https://pandas.pydata.org/docs/reference/api/pandas.json_normalize.html?highlight=json_normalize"&gt;documentation&lt;/a&gt; doesn't make it obvious how to leverage its capabilities for handling nested data structures. &lt;/p&gt;
&lt;p&gt;I thought I could provide a brief example using some randomly generated survey response data (using the &lt;a href="https://faker.readthedocs.io/en/master/"&gt;Faker&lt;/a&gt; library) to illustrate it's advantages.&lt;/p&gt;
&lt;h2&gt;Setup&lt;/h2&gt;
&lt;p&gt;To start, I'm going to be using pandas and Faker so we'll import those. I'm also going to need to easily display the parsed json as well as the returned dataframes, so I'm importing the json module from the standard lib as well as some IPython notebook helpers for displaying dataframes as HTML tables. &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;json&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;IPython.display&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;display&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;HTML&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;faker&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Faker&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;faker.providers&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;BaseProvider&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;date_time&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;internet&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pandas&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pd&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;To make it easier to call the IPython display helper, we'll include this simple function as &lt;strong&gt;syntactic sugar&lt;/strong&gt;. &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;print_df&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;display&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;HTML&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_html&lt;/span&gt;&lt;span class="p"&gt;()))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2&gt;Fake Data&lt;/h2&gt;
&lt;p&gt;Faker doesn't have a built in provider for survey questions, so let's go ahead and add a simple one that creates non-sensical questions with a simple hack to the sentence provider.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;MyProvider&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;BaseProvider&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;question&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;stems&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Does&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;How does&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Which&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Why does&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;stem&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Faker&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random_choices&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elements&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;stems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="n"&gt;sentence&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Faker&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sentence&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;sentence&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sentence&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lower&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sentence&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:]&lt;/span&gt;
        &lt;span class="n"&gt;question&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sentence&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;.&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;?&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;question&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;stem&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt; &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Using this new question provider, we'll construct a few records of fake survey response data with some respondent level data like a respondent_id, survey_date, and respondent email. Within that we'll nest a list of responses which will in turn have it's own dictionary of data at the question level: id, question text, and choices. The choices list will be singular here, but assume it has that structure because the API this comes from has to also account for multi-select options and we'll need to parse it as a list regardless. &lt;em&gt;Depending on our analysis needs, this might also be a place where we'd want to keep these in a comma separated string, but for our purposes here we'll ignore that use case.&lt;/em&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;fake&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Faker&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;fake&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_provider&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MyProvider&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;choices&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Strongly Agree&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Agree&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Neutral&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Disagree&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Strongly Disagree&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="n"&gt;sample_data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;respondent_id&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;fake&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bothify&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;#?##??###?#&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;survey_date&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;fake&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;date&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;email&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;fake&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;email&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;domain&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;example.com&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;responses&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
            &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="s2"&gt;&amp;quot;question_id&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;fake&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bothify&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;#??#??###?#&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
                &lt;span class="s2"&gt;&amp;quot;question_text&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;fake&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
                &lt;span class="s2"&gt;&amp;quot;choices&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
                    &lt;span class="p"&gt;{&lt;/span&gt;
                        &lt;span class="s2"&gt;&amp;quot;choice&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;fake&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random_choices&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elements&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;choices&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
                        &lt;span class="s2"&gt;&amp;quot;number&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;fake&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random_digit&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
                    &lt;span class="p"&gt;}&lt;/span&gt;
                &lt;span class="p"&gt;]&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; 
&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Let's print out a single record to see the resulting data structure that has been generated randomly.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;json&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dumps&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sample_data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;indent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="err"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;respondent_id&amp;quot;&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;9U69hZ538l1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;survey_date&amp;quot;&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;1994-03-20&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;email&amp;quot;&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;lindsey24@example.com&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;responses&amp;quot;&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;
&lt;span class="n"&gt;    {&lt;/span&gt;
&lt;span class="n"&gt;      &amp;quot;question_id&amp;quot;: &amp;quot;7YB4ZO864I7&amp;quot;,&lt;/span&gt;
&lt;span class="n"&gt;      &amp;quot;question_text&amp;quot;: &amp;quot;How does speak beat ever tree?&amp;quot;,&lt;/span&gt;
&lt;span class="n"&gt;      &amp;quot;choices&amp;quot;: [&lt;/span&gt;
&lt;span class="n"&gt;        {&lt;/span&gt;
&lt;span class="n"&gt;          &amp;quot;choice&amp;quot;: &amp;quot;Strongly Agree&amp;quot;,&lt;/span&gt;
&lt;span class="n"&gt;          &amp;quot;number&amp;quot;: 4&lt;/span&gt;
&lt;span class="n"&gt;        }&lt;/span&gt;
&lt;span class="n"&gt;      &lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;question_id&amp;quot;&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;8uD0WY155Q9&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;question_text&amp;quot;&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;How does write popular Mr know develop?&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;choices&amp;quot;&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;
&lt;span class="n"&gt;        {&lt;/span&gt;
&lt;span class="n"&gt;          &amp;quot;choice&amp;quot;: &amp;quot;Agree&amp;quot;,&lt;/span&gt;
&lt;span class="n"&gt;          &amp;quot;number&amp;quot;: 9&lt;/span&gt;
&lt;span class="n"&gt;        }&lt;/span&gt;
&lt;span class="n"&gt;      &lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;question_id&amp;quot;&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;8bN0OP829A8&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;question_text&amp;quot;&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;Why does democratic represent far my pressure series third?&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;choices&amp;quot;&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;
&lt;span class="n"&gt;        {&lt;/span&gt;
&lt;span class="n"&gt;          &amp;quot;choice&amp;quot;: &amp;quot;Strongly Agree&amp;quot;,&lt;/span&gt;
&lt;span class="n"&gt;          &amp;quot;number&amp;quot;: 9&lt;/span&gt;
&lt;span class="n"&gt;        }&lt;/span&gt;
&lt;span class="n"&gt;      &lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;question_id&amp;quot;&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;2Rt9mk140E8&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;question_text&amp;quot;&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;How does understand network old?&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;choices&amp;quot;&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;
&lt;span class="n"&gt;        {&lt;/span&gt;
&lt;span class="n"&gt;          &amp;quot;choice&amp;quot;: &amp;quot;Agree&amp;quot;,&lt;/span&gt;
&lt;span class="n"&gt;          &amp;quot;number&amp;quot;: 2&lt;/span&gt;
&lt;span class="n"&gt;        }&lt;/span&gt;
&lt;span class="n"&gt;      &lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;question_id&amp;quot;&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;8tf2SU934m8&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;question_text&amp;quot;&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;Why does western next put?&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;choices&amp;quot;&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;
&lt;span class="n"&gt;        {&lt;/span&gt;
&lt;span class="n"&gt;          &amp;quot;choice&amp;quot;: &amp;quot;Neutral&amp;quot;,&lt;/span&gt;
&lt;span class="n"&gt;          &amp;quot;number&amp;quot;: 8&lt;/span&gt;
&lt;span class="n"&gt;        }&lt;/span&gt;
&lt;span class="n"&gt;      &lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;]&lt;/span&gt;
&lt;span class="err"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2&gt;Reading with Pandas&lt;/h2&gt;
&lt;p&gt;As you can see below, simply reading this directly into a dataframe only parses the top level respondent data, but then keeps the responses data as a json array. Which isn't great for simple analysis. Could you load that "as is" into a jsonb field in PostgreSQL? Sure. If you like parsing json with SQL. Yuck!&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DataFrame&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sample_data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;print_df&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;respondent_id&lt;/th&gt;
      &lt;th&gt;survey_date&lt;/th&gt;
      &lt;th&gt;email&lt;/th&gt;
      &lt;th&gt;responses&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;9U69hZ538l1&lt;/td&gt;
      &lt;td&gt;1994-03-20&lt;/td&gt;
      &lt;td&gt;lindsey24@example.com&lt;/td&gt;
      &lt;td&gt;[{'question_id': '7YB4ZO864I7', 'question_text': 'How does speak beat ever tree?', 'choices': [{'choice': 'Strongly Agree', 'number': 4}]}, {'question_id': '8uD0WY155Q9', 'question_text': 'How does write popular Mr know develop?', 'choices': [{'choice': 'Agree', 'number': 9}]}, {'question_id': '8bN0OP829A8', 'question_text': 'Why does democratic represent far my pressure series third?', 'choices': [{'choice': 'Strongly Agree', 'number': 9}]}, {'question_id': '2Rt9mk140E8', 'question_text': 'How does understand network old?', 'choices': [{'choice': 'Agree', 'number': 2}]}, {'question_id': '8tf2SU934m8', 'question_text': 'Why does western next put?', 'choices': [{'choice': 'Neutral', 'number': 8}]}]&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;3A45gW246W1&lt;/td&gt;
      &lt;td&gt;1991-07-13&lt;/td&gt;
      &lt;td&gt;robert21@example.com&lt;/td&gt;
      &lt;td&gt;[{'question_id': '2CP2AW568v2', 'question_text': 'Why does whatever play office move alone class part wish?', 'choices': [{'choice': 'Neutral', 'number': 0}]}, {'question_id': '2YV7SR528f0', 'question_text': 'Why does which phone return much door?', 'choices': [{'choice': 'Disagree', 'number': 7}]}, {'question_id': '3PJ8eR903v4', 'question_text': 'Why does despite be class various great stay Republican person?', 'choices': [{'choice': 'Neutral', 'number': 4}]}, {'question_id': '2GV2kH553o3', 'question_text': 'Does become create store store?', 'choices': [{'choice': 'Disagree', 'number': 8}]}, {'question_id': '9aX3NJ910f8', 'question_text': 'Which team life although rate science I pattern?', 'choices': [{'choice': 'Strongly Disagree', 'number': 7}]}]&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2&gt;A messy custom parser&lt;/h2&gt;
&lt;p&gt;We could attempt to reshape this by writing some custom functions to handle extracting the responses and merging that data with the top-level meta data about the respondent with some dictionary unpacking, but this gets messy and would fall apart quickly as the structure changed. While this approach works, it's not ideal. &lt;/p&gt;
&lt;p&gt;Sure this code could be further refactored to simplify the logic, but it's not worth it since the &lt;code&gt;pandas.json_normalize()&lt;/code&gt; can do this for us easily.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;record_format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;responses&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;responses&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;record&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="s2"&gt;&amp;quot;question_id&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;question_id&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
            &lt;span class="s2"&gt;&amp;quot;question_text&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;question_text&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
            &lt;span class="s2"&gt;&amp;quot;choice&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;choices&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;choice&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
            &lt;span class="s2"&gt;&amp;quot;number&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;choices&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;number&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;record&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;parse_json&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;records&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;record&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;sample_data&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;meta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="s2"&gt;&amp;quot;respondent_id&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;record&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;respondent_id&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
            &lt;span class="s2"&gt;&amp;quot;survey_date&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;record&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;survey_date&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
            &lt;span class="s2"&gt;&amp;quot;email&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;record&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;email&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="n"&gt;responses&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;record&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;responses&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;formatted_responses&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;record_format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;responses&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;formatted_responses&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;combined&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;meta&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;combined&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;

&lt;span class="n"&gt;clean_data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;parse_json&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sample_data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DataFrame&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clean_data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;print_df&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;respondent_id&lt;/th&gt;
      &lt;th&gt;survey_date&lt;/th&gt;
      &lt;th&gt;email&lt;/th&gt;
      &lt;th&gt;question_id&lt;/th&gt;
      &lt;th&gt;question_text&lt;/th&gt;
      &lt;th&gt;choice&lt;/th&gt;
      &lt;th&gt;number&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;9U69hZ538l1&lt;/td&gt;
      &lt;td&gt;1994-03-20&lt;/td&gt;
      &lt;td&gt;lindsey24@example.com&lt;/td&gt;
      &lt;td&gt;7YB4ZO864I7&lt;/td&gt;
      &lt;td&gt;How does speak beat ever tree?&lt;/td&gt;
      &lt;td&gt;Strongly Agree&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;9U69hZ538l1&lt;/td&gt;
      &lt;td&gt;1994-03-20&lt;/td&gt;
      &lt;td&gt;lindsey24@example.com&lt;/td&gt;
      &lt;td&gt;8uD0WY155Q9&lt;/td&gt;
      &lt;td&gt;How does write popular Mr know develop?&lt;/td&gt;
      &lt;td&gt;Agree&lt;/td&gt;
      &lt;td&gt;9&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;9U69hZ538l1&lt;/td&gt;
      &lt;td&gt;1994-03-20&lt;/td&gt;
      &lt;td&gt;lindsey24@example.com&lt;/td&gt;
      &lt;td&gt;8bN0OP829A8&lt;/td&gt;
      &lt;td&gt;Why does democratic represent far my pressure series third?&lt;/td&gt;
      &lt;td&gt;Strongly Agree&lt;/td&gt;
      &lt;td&gt;9&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;9U69hZ538l1&lt;/td&gt;
      &lt;td&gt;1994-03-20&lt;/td&gt;
      &lt;td&gt;lindsey24@example.com&lt;/td&gt;
      &lt;td&gt;2Rt9mk140E8&lt;/td&gt;
      &lt;td&gt;How does understand network old?&lt;/td&gt;
      &lt;td&gt;Agree&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;9U69hZ538l1&lt;/td&gt;
      &lt;td&gt;1994-03-20&lt;/td&gt;
      &lt;td&gt;lindsey24@example.com&lt;/td&gt;
      &lt;td&gt;8tf2SU934m8&lt;/td&gt;
      &lt;td&gt;Why does western next put?&lt;/td&gt;
      &lt;td&gt;Neutral&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;3A45gW246W1&lt;/td&gt;
      &lt;td&gt;1991-07-13&lt;/td&gt;
      &lt;td&gt;robert21@example.com&lt;/td&gt;
      &lt;td&gt;2CP2AW568v2&lt;/td&gt;
      &lt;td&gt;Why does whatever play office move alone class part wish?&lt;/td&gt;
      &lt;td&gt;Neutral&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;3A45gW246W1&lt;/td&gt;
      &lt;td&gt;1991-07-13&lt;/td&gt;
      &lt;td&gt;robert21@example.com&lt;/td&gt;
      &lt;td&gt;2YV7SR528f0&lt;/td&gt;
      &lt;td&gt;Why does which phone return much door?&lt;/td&gt;
      &lt;td&gt;Disagree&lt;/td&gt;
      &lt;td&gt;7&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;3A45gW246W1&lt;/td&gt;
      &lt;td&gt;1991-07-13&lt;/td&gt;
      &lt;td&gt;robert21@example.com&lt;/td&gt;
      &lt;td&gt;3PJ8eR903v4&lt;/td&gt;
      &lt;td&gt;Why does despite be class various great stay Republican person?&lt;/td&gt;
      &lt;td&gt;Neutral&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;3A45gW246W1&lt;/td&gt;
      &lt;td&gt;1991-07-13&lt;/td&gt;
      &lt;td&gt;robert21@example.com&lt;/td&gt;
      &lt;td&gt;2GV2kH553o3&lt;/td&gt;
      &lt;td&gt;Does become create store store?&lt;/td&gt;
      &lt;td&gt;Disagree&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;3A45gW246W1&lt;/td&gt;
      &lt;td&gt;1991-07-13&lt;/td&gt;
      &lt;td&gt;robert21@example.com&lt;/td&gt;
      &lt;td&gt;9aX3NJ910f8&lt;/td&gt;
      &lt;td&gt;Which team life although rate science I pattern?&lt;/td&gt;
      &lt;td&gt;Strongly Disagree&lt;/td&gt;
      &lt;td&gt;7&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2&gt;JSON Normalize&lt;/h2&gt;
&lt;p&gt;Thankfully there is the &lt;code&gt;json_normalize()&lt;/code&gt; function, but it requires a little understanding to get it to satisfactorily parse flat. Simply passing it the sample data without any parameters results in a very familiar result that gets us no further than we started in the first attempt.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;json_normalize&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sample_data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;print_df&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;respondent_id&lt;/th&gt;
      &lt;th&gt;survey_date&lt;/th&gt;
      &lt;th&gt;email&lt;/th&gt;
      &lt;th&gt;responses&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;9U69hZ538l1&lt;/td&gt;
      &lt;td&gt;1994-03-20&lt;/td&gt;
      &lt;td&gt;lindsey24@example.com&lt;/td&gt;
      &lt;td&gt;[{'question_id': '7YB4ZO864I7', 'question_text': 'How does speak beat ever tree?', 'choices': [{'choice': 'Strongly Agree', 'number': 4}]}, {'question_id': '8uD0WY155Q9', 'question_text': 'How does write popular Mr know develop?', 'choices': [{'choice': 'Agree', 'number': 9}]}, {'question_id': '8bN0OP829A8', 'question_text': 'Why does democratic represent far my pressure series third?', 'choices': [{'choice': 'Strongly Agree', 'number': 9}]}, {'question_id': '2Rt9mk140E8', 'question_text': 'How does understand network old?', 'choices': [{'choice': 'Agree', 'number': 2}]}, {'question_id': '8tf2SU934m8', 'question_text': 'Why does western next put?', 'choices': [{'choice': 'Neutral', 'number': 8}]}]&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;3A45gW246W1&lt;/td&gt;
      &lt;td&gt;1991-07-13&lt;/td&gt;
      &lt;td&gt;robert21@example.com&lt;/td&gt;
      &lt;td&gt;[{'question_id': '2CP2AW568v2', 'question_text': 'Why does whatever play office move alone class part wish?', 'choices': [{'choice': 'Neutral', 'number': 0}]}, {'question_id': '2YV7SR528f0', 'question_text': 'Why does which phone return much door?', 'choices': [{'choice': 'Disagree', 'number': 7}]}, {'question_id': '3PJ8eR903v4', 'question_text': 'Why does despite be class various great stay Republican person?', 'choices': [{'choice': 'Neutral', 'number': 4}]}, {'question_id': '2GV2kH553o3', 'question_text': 'Does become create store store?', 'choices': [{'choice': 'Disagree', 'number': 8}]}, {'question_id': '9aX3NJ910f8', 'question_text': 'Which team life although rate science I pattern?', 'choices': [{'choice': 'Strongly Disagree', 'number': 7}]}]&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;A few optional parameters can be used here to parse the first nested array called &lt;code&gt;responses&lt;/code&gt;. We can direct the pandas json parser to a specific key as the source of records. The &lt;code&gt;record_path&lt;/code&gt; parameter takes either a string or list of strings to construct that path. The name of this parameter is a hint about how to think of this when passed as a list as we'll see later. &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;json_normalize&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;sample_data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
    &lt;span class="n"&gt;record_path&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;responses&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;print_df&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;question_id&lt;/th&gt;
      &lt;th&gt;question_text&lt;/th&gt;
      &lt;th&gt;choices&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;7YB4ZO864I7&lt;/td&gt;
      &lt;td&gt;How does speak beat ever tree?&lt;/td&gt;
      &lt;td&gt;[{'choice': 'Strongly Agree', 'number': 4}]&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;8uD0WY155Q9&lt;/td&gt;
      &lt;td&gt;How does write popular Mr know develop?&lt;/td&gt;
      &lt;td&gt;[{'choice': 'Agree', 'number': 9}]&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;8bN0OP829A8&lt;/td&gt;
      &lt;td&gt;Why does democratic represent far my pressure series third?&lt;/td&gt;
      &lt;td&gt;[{'choice': 'Strongly Agree', 'number': 9}]&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;2Rt9mk140E8&lt;/td&gt;
      &lt;td&gt;How does understand network old?&lt;/td&gt;
      &lt;td&gt;[{'choice': 'Agree', 'number': 2}]&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;8tf2SU934m8&lt;/td&gt;
      &lt;td&gt;Why does western next put?&lt;/td&gt;
      &lt;td&gt;[{'choice': 'Neutral', 'number': 8}]&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;2CP2AW568v2&lt;/td&gt;
      &lt;td&gt;Why does whatever play office move alone class part wish?&lt;/td&gt;
      &lt;td&gt;[{'choice': 'Neutral', 'number': 0}]&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;2YV7SR528f0&lt;/td&gt;
      &lt;td&gt;Why does which phone return much door?&lt;/td&gt;
      &lt;td&gt;[{'choice': 'Disagree', 'number': 7}]&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;3PJ8eR903v4&lt;/td&gt;
      &lt;td&gt;Why does despite be class various great stay Republican person?&lt;/td&gt;
      &lt;td&gt;[{'choice': 'Neutral', 'number': 4}]&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;2GV2kH553o3&lt;/td&gt;
      &lt;td&gt;Does become create store store?&lt;/td&gt;
      &lt;td&gt;[{'choice': 'Disagree', 'number': 8}]&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;9aX3NJ910f8&lt;/td&gt;
      &lt;td&gt;Which team life although rate science I pattern?&lt;/td&gt;
      &lt;td&gt;[{'choice': 'Strongly Disagree', 'number': 7}]&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;But when we direct the parser to just unpack the &lt;code&gt;reponses&lt;/code&gt; array, we lose our data from the level above. Pandas can be instructed to keep this by giving it a list of metadata to repeat for each record it unpacks from the level above. We use the &lt;code&gt;meta&lt;/code&gt; parameter and pass it a list of the fields to include.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;json_normalize&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;sample_data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
    &lt;span class="n"&gt;record_path&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;responses&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
     &lt;span class="n"&gt;meta&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;respondent_id&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
        &lt;span class="s2"&gt;&amp;quot;survey_date&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;email&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
    &lt;span class="p"&gt;],&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;print_df&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;question_id&lt;/th&gt;
      &lt;th&gt;question_text&lt;/th&gt;
      &lt;th&gt;choices&lt;/th&gt;
      &lt;th&gt;respondent_id&lt;/th&gt;
      &lt;th&gt;survey_date&lt;/th&gt;
      &lt;th&gt;email&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;7YB4ZO864I7&lt;/td&gt;
      &lt;td&gt;How does speak beat ever tree?&lt;/td&gt;
      &lt;td&gt;[{'choice': 'Strongly Agree', 'number': 4}]&lt;/td&gt;
      &lt;td&gt;9U69hZ538l1&lt;/td&gt;
      &lt;td&gt;1994-03-20&lt;/td&gt;
      &lt;td&gt;lindsey24@example.com&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;8uD0WY155Q9&lt;/td&gt;
      &lt;td&gt;How does write popular Mr know develop?&lt;/td&gt;
      &lt;td&gt;[{'choice': 'Agree', 'number': 9}]&lt;/td&gt;
      &lt;td&gt;9U69hZ538l1&lt;/td&gt;
      &lt;td&gt;1994-03-20&lt;/td&gt;
      &lt;td&gt;lindsey24@example.com&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;8bN0OP829A8&lt;/td&gt;
      &lt;td&gt;Why does democratic represent far my pressure series third?&lt;/td&gt;
      &lt;td&gt;[{'choice': 'Strongly Agree', 'number': 9}]&lt;/td&gt;
      &lt;td&gt;9U69hZ538l1&lt;/td&gt;
      &lt;td&gt;1994-03-20&lt;/td&gt;
      &lt;td&gt;lindsey24@example.com&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;2Rt9mk140E8&lt;/td&gt;
      &lt;td&gt;How does understand network old?&lt;/td&gt;
      &lt;td&gt;[{'choice': 'Agree', 'number': 2}]&lt;/td&gt;
      &lt;td&gt;9U69hZ538l1&lt;/td&gt;
      &lt;td&gt;1994-03-20&lt;/td&gt;
      &lt;td&gt;lindsey24@example.com&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;8tf2SU934m8&lt;/td&gt;
      &lt;td&gt;Why does western next put?&lt;/td&gt;
      &lt;td&gt;[{'choice': 'Neutral', 'number': 8}]&lt;/td&gt;
      &lt;td&gt;9U69hZ538l1&lt;/td&gt;
      &lt;td&gt;1994-03-20&lt;/td&gt;
      &lt;td&gt;lindsey24@example.com&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;2CP2AW568v2&lt;/td&gt;
      &lt;td&gt;Why does whatever play office move alone class part wish?&lt;/td&gt;
      &lt;td&gt;[{'choice': 'Neutral', 'number': 0}]&lt;/td&gt;
      &lt;td&gt;3A45gW246W1&lt;/td&gt;
      &lt;td&gt;1991-07-13&lt;/td&gt;
      &lt;td&gt;robert21@example.com&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;2YV7SR528f0&lt;/td&gt;
      &lt;td&gt;Why does which phone return much door?&lt;/td&gt;
      &lt;td&gt;[{'choice': 'Disagree', 'number': 7}]&lt;/td&gt;
      &lt;td&gt;3A45gW246W1&lt;/td&gt;
      &lt;td&gt;1991-07-13&lt;/td&gt;
      &lt;td&gt;robert21@example.com&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;3PJ8eR903v4&lt;/td&gt;
      &lt;td&gt;Why does despite be class various great stay Republican person?&lt;/td&gt;
      &lt;td&gt;[{'choice': 'Neutral', 'number': 4}]&lt;/td&gt;
      &lt;td&gt;3A45gW246W1&lt;/td&gt;
      &lt;td&gt;1991-07-13&lt;/td&gt;
      &lt;td&gt;robert21@example.com&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;2GV2kH553o3&lt;/td&gt;
      &lt;td&gt;Does become create store store?&lt;/td&gt;
      &lt;td&gt;[{'choice': 'Disagree', 'number': 8}]&lt;/td&gt;
      &lt;td&gt;3A45gW246W1&lt;/td&gt;
      &lt;td&gt;1991-07-13&lt;/td&gt;
      &lt;td&gt;robert21@example.com&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;9aX3NJ910f8&lt;/td&gt;
      &lt;td&gt;Which team life although rate science I pattern?&lt;/td&gt;
      &lt;td&gt;[{'choice': 'Strongly Disagree', 'number': 7}]&lt;/td&gt;
      &lt;td&gt;3A45gW246W1&lt;/td&gt;
      &lt;td&gt;1991-07-13&lt;/td&gt;
      &lt;td&gt;robert21@example.com&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2&gt;We must go deeper!&lt;/h2&gt;
&lt;p&gt;That works for the most part, but we still have that annoying &lt;strong&gt;choices&lt;/strong&gt; json array that would be nice to split out into columns. &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;df5&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;json_normalize&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;sample_data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
    &lt;span class="n"&gt;record_path&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;choices&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
    &lt;span class="n"&gt;meta&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;respondent_id&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
        &lt;span class="s2"&gt;&amp;quot;survey_date&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;email&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
    &lt;span class="p"&gt;],&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Simply passing the choices field to the &lt;code&gt;record_path&lt;/code&gt; param results in a &lt;code&gt;KeyError&lt;/code&gt; though. This is because the &lt;strong&gt;choices&lt;/strong&gt; field is actually nested in the &lt;strong&gt;responses&lt;/strong&gt; field. So pandas need us to construct a path to reach it. We can get to it by passing each key as a record in the list to construct a path. Here that looks like &lt;code&gt;["responses", "choices"]&lt;/code&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;json_normalize&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;sample_data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
    &lt;span class="n"&gt;record_path&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;responses&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;choices&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; 
    &lt;span class="n"&gt;meta&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;respondent_id&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
        &lt;span class="s2"&gt;&amp;quot;survey_date&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;email&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
    &lt;span class="p"&gt;],&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;print_df&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;choice&lt;/th&gt;
      &lt;th&gt;number&lt;/th&gt;
      &lt;th&gt;respondent_id&lt;/th&gt;
      &lt;th&gt;survey_date&lt;/th&gt;
      &lt;th&gt;email&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;Strongly Agree&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;9U69hZ538l1&lt;/td&gt;
      &lt;td&gt;1994-03-20&lt;/td&gt;
      &lt;td&gt;lindsey24@example.com&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;Agree&lt;/td&gt;
      &lt;td&gt;9&lt;/td&gt;
      &lt;td&gt;9U69hZ538l1&lt;/td&gt;
      &lt;td&gt;1994-03-20&lt;/td&gt;
      &lt;td&gt;lindsey24@example.com&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;Strongly Agree&lt;/td&gt;
      &lt;td&gt;9&lt;/td&gt;
      &lt;td&gt;9U69hZ538l1&lt;/td&gt;
      &lt;td&gt;1994-03-20&lt;/td&gt;
      &lt;td&gt;lindsey24@example.com&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;Agree&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;9U69hZ538l1&lt;/td&gt;
      &lt;td&gt;1994-03-20&lt;/td&gt;
      &lt;td&gt;lindsey24@example.com&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;Neutral&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;9U69hZ538l1&lt;/td&gt;
      &lt;td&gt;1994-03-20&lt;/td&gt;
      &lt;td&gt;lindsey24@example.com&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;Neutral&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;3A45gW246W1&lt;/td&gt;
      &lt;td&gt;1991-07-13&lt;/td&gt;
      &lt;td&gt;robert21@example.com&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;Disagree&lt;/td&gt;
      &lt;td&gt;7&lt;/td&gt;
      &lt;td&gt;3A45gW246W1&lt;/td&gt;
      &lt;td&gt;1991-07-13&lt;/td&gt;
      &lt;td&gt;robert21@example.com&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;Neutral&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;3A45gW246W1&lt;/td&gt;
      &lt;td&gt;1991-07-13&lt;/td&gt;
      &lt;td&gt;robert21@example.com&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;Disagree&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;3A45gW246W1&lt;/td&gt;
      &lt;td&gt;1991-07-13&lt;/td&gt;
      &lt;td&gt;robert21@example.com&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;Strongly Disagree&lt;/td&gt;
      &lt;td&gt;7&lt;/td&gt;
      &lt;td&gt;3A45gW246W1&lt;/td&gt;
      &lt;td&gt;1991-07-13&lt;/td&gt;
      &lt;td&gt;robert21@example.com&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;But when we do that, we lose our &lt;strong&gt;question_id&lt;/strong&gt; and &lt;strong&gt;question_text&lt;/strong&gt; fields. That's because we need to add them in the meta list and pass their paths like the record path param. See below.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;json_normalize&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;sample_data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
    &lt;span class="n"&gt;record_path&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;responses&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;choices&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; 
    &lt;span class="n"&gt;meta&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;respondent_id&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
        &lt;span class="s2"&gt;&amp;quot;survey_date&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;email&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;responses&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;question_id&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;responses&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;question_text&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
    &lt;span class="p"&gt;],&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;print_df&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;choice&lt;/th&gt;
      &lt;th&gt;number&lt;/th&gt;
      &lt;th&gt;respondent_id&lt;/th&gt;
      &lt;th&gt;survey_date&lt;/th&gt;
      &lt;th&gt;email&lt;/th&gt;
      &lt;th&gt;responses.question_id&lt;/th&gt;
      &lt;th&gt;responses.question_text&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;Strongly Agree&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;9U69hZ538l1&lt;/td&gt;
      &lt;td&gt;1994-03-20&lt;/td&gt;
      &lt;td&gt;lindsey24@example.com&lt;/td&gt;
      &lt;td&gt;7YB4ZO864I7&lt;/td&gt;
      &lt;td&gt;How does speak beat ever tree?&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;Agree&lt;/td&gt;
      &lt;td&gt;9&lt;/td&gt;
      &lt;td&gt;9U69hZ538l1&lt;/td&gt;
      &lt;td&gt;1994-03-20&lt;/td&gt;
      &lt;td&gt;lindsey24@example.com&lt;/td&gt;
      &lt;td&gt;8uD0WY155Q9&lt;/td&gt;
      &lt;td&gt;How does write popular Mr know develop?&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;Strongly Agree&lt;/td&gt;
      &lt;td&gt;9&lt;/td&gt;
      &lt;td&gt;9U69hZ538l1&lt;/td&gt;
      &lt;td&gt;1994-03-20&lt;/td&gt;
      &lt;td&gt;lindsey24@example.com&lt;/td&gt;
      &lt;td&gt;8bN0OP829A8&lt;/td&gt;
      &lt;td&gt;Why does democratic represent far my pressure series third?&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;Agree&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;9U69hZ538l1&lt;/td&gt;
      &lt;td&gt;1994-03-20&lt;/td&gt;
      &lt;td&gt;lindsey24@example.com&lt;/td&gt;
      &lt;td&gt;2Rt9mk140E8&lt;/td&gt;
      &lt;td&gt;How does understand network old?&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;Neutral&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;9U69hZ538l1&lt;/td&gt;
      &lt;td&gt;1994-03-20&lt;/td&gt;
      &lt;td&gt;lindsey24@example.com&lt;/td&gt;
      &lt;td&gt;8tf2SU934m8&lt;/td&gt;
      &lt;td&gt;Why does western next put?&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;Neutral&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;3A45gW246W1&lt;/td&gt;
      &lt;td&gt;1991-07-13&lt;/td&gt;
      &lt;td&gt;robert21@example.com&lt;/td&gt;
      &lt;td&gt;2CP2AW568v2&lt;/td&gt;
      &lt;td&gt;Why does whatever play office move alone class part wish?&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;Disagree&lt;/td&gt;
      &lt;td&gt;7&lt;/td&gt;
      &lt;td&gt;3A45gW246W1&lt;/td&gt;
      &lt;td&gt;1991-07-13&lt;/td&gt;
      &lt;td&gt;robert21@example.com&lt;/td&gt;
      &lt;td&gt;2YV7SR528f0&lt;/td&gt;
      &lt;td&gt;Why does which phone return much door?&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;Neutral&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;3A45gW246W1&lt;/td&gt;
      &lt;td&gt;1991-07-13&lt;/td&gt;
      &lt;td&gt;robert21@example.com&lt;/td&gt;
      &lt;td&gt;3PJ8eR903v4&lt;/td&gt;
      &lt;td&gt;Why does despite be class various great stay Republican person?&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;Disagree&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;3A45gW246W1&lt;/td&gt;
      &lt;td&gt;1991-07-13&lt;/td&gt;
      &lt;td&gt;robert21@example.com&lt;/td&gt;
      &lt;td&gt;2GV2kH553o3&lt;/td&gt;
      &lt;td&gt;Does become create store store?&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;Strongly Disagree&lt;/td&gt;
      &lt;td&gt;7&lt;/td&gt;
      &lt;td&gt;3A45gW246W1&lt;/td&gt;
      &lt;td&gt;1991-07-13&lt;/td&gt;
      &lt;td&gt;robert21@example.com&lt;/td&gt;
      &lt;td&gt;9aX3NJ910f8&lt;/td&gt;
      &lt;td&gt;Which team life although rate science I pattern?&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;One last tweak: some databases (like MS SQL) don't like naming columns with that period in the name. As a work around you can give the &lt;code&gt;json_normalize&lt;/code&gt; function a custom separator such as an underscore instead. &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;json_normalize&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;sample_data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
    &lt;span class="n"&gt;sep&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;_&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;record_path&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;responses&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;choices&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; 
    &lt;span class="n"&gt;meta&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;respondent_id&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
        &lt;span class="s2"&gt;&amp;quot;survey_date&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;email&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;responses&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;question_id&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;responses&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;question_text&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="p"&gt;],&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;print_df&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;choice&lt;/th&gt;
      &lt;th&gt;number&lt;/th&gt;
      &lt;th&gt;respondent_id&lt;/th&gt;
      &lt;th&gt;survey_date&lt;/th&gt;
      &lt;th&gt;email&lt;/th&gt;
      &lt;th&gt;responses_question_id&lt;/th&gt;
      &lt;th&gt;responses_question_text&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;Strongly Agree&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;9U69hZ538l1&lt;/td&gt;
      &lt;td&gt;1994-03-20&lt;/td&gt;
      &lt;td&gt;lindsey24@example.com&lt;/td&gt;
      &lt;td&gt;7YB4ZO864I7&lt;/td&gt;
      &lt;td&gt;How does speak beat ever tree?&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;Agree&lt;/td&gt;
      &lt;td&gt;9&lt;/td&gt;
      &lt;td&gt;9U69hZ538l1&lt;/td&gt;
      &lt;td&gt;1994-03-20&lt;/td&gt;
      &lt;td&gt;lindsey24@example.com&lt;/td&gt;
      &lt;td&gt;8uD0WY155Q9&lt;/td&gt;
      &lt;td&gt;How does write popular Mr know develop?&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;Strongly Agree&lt;/td&gt;
      &lt;td&gt;9&lt;/td&gt;
      &lt;td&gt;9U69hZ538l1&lt;/td&gt;
      &lt;td&gt;1994-03-20&lt;/td&gt;
      &lt;td&gt;lindsey24@example.com&lt;/td&gt;
      &lt;td&gt;8bN0OP829A8&lt;/td&gt;
      &lt;td&gt;Why does democratic represent far my pressure series third?&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;Agree&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;9U69hZ538l1&lt;/td&gt;
      &lt;td&gt;1994-03-20&lt;/td&gt;
      &lt;td&gt;lindsey24@example.com&lt;/td&gt;
      &lt;td&gt;2Rt9mk140E8&lt;/td&gt;
      &lt;td&gt;How does understand network old?&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;Neutral&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;9U69hZ538l1&lt;/td&gt;
      &lt;td&gt;1994-03-20&lt;/td&gt;
      &lt;td&gt;lindsey24@example.com&lt;/td&gt;
      &lt;td&gt;8tf2SU934m8&lt;/td&gt;
      &lt;td&gt;Why does western next put?&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;Neutral&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;3A45gW246W1&lt;/td&gt;
      &lt;td&gt;1991-07-13&lt;/td&gt;
      &lt;td&gt;robert21@example.com&lt;/td&gt;
      &lt;td&gt;2CP2AW568v2&lt;/td&gt;
      &lt;td&gt;Why does whatever play office move alone class part wish?&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;Disagree&lt;/td&gt;
      &lt;td&gt;7&lt;/td&gt;
      &lt;td&gt;3A45gW246W1&lt;/td&gt;
      &lt;td&gt;1991-07-13&lt;/td&gt;
      &lt;td&gt;robert21@example.com&lt;/td&gt;
      &lt;td&gt;2YV7SR528f0&lt;/td&gt;
      &lt;td&gt;Why does which phone return much door?&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;Neutral&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;3A45gW246W1&lt;/td&gt;
      &lt;td&gt;1991-07-13&lt;/td&gt;
      &lt;td&gt;robert21@example.com&lt;/td&gt;
      &lt;td&gt;3PJ8eR903v4&lt;/td&gt;
      &lt;td&gt;Why does despite be class various great stay Republican person?&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;Disagree&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;3A45gW246W1&lt;/td&gt;
      &lt;td&gt;1991-07-13&lt;/td&gt;
      &lt;td&gt;robert21@example.com&lt;/td&gt;
      &lt;td&gt;2GV2kH553o3&lt;/td&gt;
      &lt;td&gt;Does become create store store?&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;Strongly Disagree&lt;/td&gt;
      &lt;td&gt;7&lt;/td&gt;
      &lt;td&gt;3A45gW246W1&lt;/td&gt;
      &lt;td&gt;1991-07-13&lt;/td&gt;
      &lt;td&gt;robert21@example.com&lt;/td&gt;
      &lt;td&gt;9aX3NJ910f8&lt;/td&gt;
      &lt;td&gt;Which team life although rate science I pattern?&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Finally, we'll order the columns from the least nested level on the left all the way to the most nested on the right for easier readability. &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;column_order&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;respondent_id&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;survey_date&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;email&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;responses_question_id&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;responses_question_text&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;choice&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;number&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;column_order&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;print_df&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;respondent_id&lt;/th&gt;
      &lt;th&gt;survey_date&lt;/th&gt;
      &lt;th&gt;email&lt;/th&gt;
      &lt;th&gt;responses_question_id&lt;/th&gt;
      &lt;th&gt;responses_question_text&lt;/th&gt;
      &lt;th&gt;choice&lt;/th&gt;
      &lt;th&gt;number&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;9U69hZ538l1&lt;/td&gt;
      &lt;td&gt;1994-03-20&lt;/td&gt;
      &lt;td&gt;lindsey24@example.com&lt;/td&gt;
      &lt;td&gt;7YB4ZO864I7&lt;/td&gt;
      &lt;td&gt;How does speak beat ever tree?&lt;/td&gt;
      &lt;td&gt;Strongly Agree&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;9U69hZ538l1&lt;/td&gt;
      &lt;td&gt;1994-03-20&lt;/td&gt;
      &lt;td&gt;lindsey24@example.com&lt;/td&gt;
      &lt;td&gt;8uD0WY155Q9&lt;/td&gt;
      &lt;td&gt;How does write popular Mr know develop?&lt;/td&gt;
      &lt;td&gt;Agree&lt;/td&gt;
      &lt;td&gt;9&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;9U69hZ538l1&lt;/td&gt;
      &lt;td&gt;1994-03-20&lt;/td&gt;
      &lt;td&gt;lindsey24@example.com&lt;/td&gt;
      &lt;td&gt;8bN0OP829A8&lt;/td&gt;
      &lt;td&gt;Why does democratic represent far my pressure series third?&lt;/td&gt;
      &lt;td&gt;Strongly Agree&lt;/td&gt;
      &lt;td&gt;9&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;9U69hZ538l1&lt;/td&gt;
      &lt;td&gt;1994-03-20&lt;/td&gt;
      &lt;td&gt;lindsey24@example.com&lt;/td&gt;
      &lt;td&gt;2Rt9mk140E8&lt;/td&gt;
      &lt;td&gt;How does understand network old?&lt;/td&gt;
      &lt;td&gt;Agree&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;9U69hZ538l1&lt;/td&gt;
      &lt;td&gt;1994-03-20&lt;/td&gt;
      &lt;td&gt;lindsey24@example.com&lt;/td&gt;
      &lt;td&gt;8tf2SU934m8&lt;/td&gt;
      &lt;td&gt;Why does western next put?&lt;/td&gt;
      &lt;td&gt;Neutral&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;3A45gW246W1&lt;/td&gt;
      &lt;td&gt;1991-07-13&lt;/td&gt;
      &lt;td&gt;robert21@example.com&lt;/td&gt;
      &lt;td&gt;2CP2AW568v2&lt;/td&gt;
      &lt;td&gt;Why does whatever play office move alone class part wish?&lt;/td&gt;
      &lt;td&gt;Neutral&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;3A45gW246W1&lt;/td&gt;
      &lt;td&gt;1991-07-13&lt;/td&gt;
      &lt;td&gt;robert21@example.com&lt;/td&gt;
      &lt;td&gt;2YV7SR528f0&lt;/td&gt;
      &lt;td&gt;Why does which phone return much door?&lt;/td&gt;
      &lt;td&gt;Disagree&lt;/td&gt;
      &lt;td&gt;7&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;3A45gW246W1&lt;/td&gt;
      &lt;td&gt;1991-07-13&lt;/td&gt;
      &lt;td&gt;robert21@example.com&lt;/td&gt;
      &lt;td&gt;3PJ8eR903v4&lt;/td&gt;
      &lt;td&gt;Why does despite be class various great stay Republican person?&lt;/td&gt;
      &lt;td&gt;Neutral&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;3A45gW246W1&lt;/td&gt;
      &lt;td&gt;1991-07-13&lt;/td&gt;
      &lt;td&gt;robert21@example.com&lt;/td&gt;
      &lt;td&gt;2GV2kH553o3&lt;/td&gt;
      &lt;td&gt;Does become create store store?&lt;/td&gt;
      &lt;td&gt;Disagree&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;3A45gW246W1&lt;/td&gt;
      &lt;td&gt;1991-07-13&lt;/td&gt;
      &lt;td&gt;robert21@example.com&lt;/td&gt;
      &lt;td&gt;9aX3NJ910f8&lt;/td&gt;
      &lt;td&gt;Which team life although rate science I pattern?&lt;/td&gt;
      &lt;td&gt;Strongly Disagree&lt;/td&gt;
      &lt;td&gt;7&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2&gt;Parsed and ready to import&lt;/h2&gt;
&lt;p&gt;At this point our data is in a simple tabular format and ready to import into a database table with something like &lt;a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.to_sql.html?highlight=to_sql"&gt;pandas.to_sql()&lt;/a&gt; function, but we'll save that for another post. &lt;/p&gt;</content><category term="Tutorial"></category></entry><entry><title>InnovateEDU Webinar - 19 November 2020</title><link href="http://dchess.github.io/innovateedu-webinar-19-november-2020.html" rel="alternate"></link><published>2020-11-19T12:30:00-08:00</published><updated>2020-11-19T12:30:00-08:00</updated><author><name>dc.hess@gmail.com</name></author><id>tag:dchess.github.io,2020-11-19:/innovateedu-webinar-19-november-2020.html</id><summary type="html">&lt;p&gt;Sharing our Google Classroom Data Pipeline&lt;/p&gt;</summary><content type="html">&lt;h2&gt;Google Classroom Connector&lt;/h2&gt;
&lt;p&gt;In the wake of COVID19, we needed to provide &lt;a href="www.kippnorcal.org"&gt;our schools&lt;/a&gt; with visibility into student engagement with distance learning. The majority of our schools were using Google Classroom as their LMS (Learning Management System) and we knew that pulling this data down into our data warehouse ASAP would be a vital piece of that puzzle. &lt;/p&gt;
&lt;p&gt;We initially built a data pipeline or "connector" using the Google Classroom API and published it to a &lt;a href="https://github.com/kippnorcal/google_classroom"&gt;public repo&lt;/a&gt; for others to use. I partnered closely with &lt;a href="https://www.linkedin.com/in/zachkagin"&gt;Zach Kagin&lt;/a&gt; who had volunteered his time pro-bono to the project to support us in this vital time. Shout out to his incredible work on batching the API calls which substantially improved the performance of the codebase.&lt;/p&gt;
&lt;p&gt;Soon after, &lt;a href="https://www.linkedin.com/in/erinmote"&gt;Erin Mote&lt;/a&gt; from &lt;a href="https://www.innovateedunyc.org/"&gt;InnovateEDU&lt;/a&gt; reached out about a possible partnership to &lt;a href="https://github.com/InnovateEDU-NYC/google_classroom"&gt;fork the repo&lt;/a&gt; and produce a version that could load the data to BigQuery rather than SQL Server so it could be run on a free instance of Google Cloud Platform with minimal effort. I partnered with &lt;a href="https://www.linkedin.com/in/marcos-alcozer"&gt;Marcos Alcozer&lt;/a&gt; to translate our inital work into something that would be easily deployable on Google Cloud Shell. His team then put together &lt;a href="https://innovateedu-nyc.github.io/google_classroom/index.html#0"&gt;beautiful and simple documentation&lt;/a&gt; to make it even more effortless to spin up this solution for Districts and CMOs around the country. &lt;/p&gt;
&lt;h2&gt;Webinar&lt;/h2&gt;
&lt;p&gt;You can see Erin and I presenting a tutorial on how to deploy this solution below. &lt;/p&gt;
&lt;p style="text-align:center;"&gt;
&lt;iframe width="560" height="315" src="https://www.youtube.com/embed/YeJnHmKBClk" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen align="middle"&gt;&lt;/iframe&gt;
&lt;/p&gt;

&lt;p&gt;I'm incredibly proud of this work and the impact it was able to have in such a critical time. It was instrumental in my team's ability to produce meaningful insights on distance learning engagement and even helped support tracking asynchronous attendance with a level of fidelity other orgs struggled to produce without massive manual overhead. &lt;/p&gt;</content><category term="Projects"></category></entry><entry><title>My Manager README</title><link href="http://dchess.github.io/my-manager-readme.html" rel="alternate"></link><published>2018-08-08T21:00:00-07:00</published><updated>2018-08-08T21:00:00-07:00</updated><author><name>dc.hess@gmail.com</name></author><id>tag:dchess.github.io,2018-08-08:/my-manager-readme.html</id><summary type="html">&lt;p&gt;Sharing my manager readme helped me reflect on who I am as a leader.&lt;/p&gt;</summary><content type="html">&lt;p&gt;When I transitioned from being primarily a software engineer who was an individual
contributor on a team to managing a team of engineers, I didn't have a clear sense
of who I was going to be as a manager. I knew the sort of manager I &lt;em&gt;wanted&lt;/em&gt; to be,
but the shift from peer to leader isn't always clear cut. &lt;/p&gt;
&lt;p&gt;After close to two years in the role, I learned a lot about who I am and who
I still want to be as a leader, but had no clear way to communicate that to my team.&lt;/p&gt;
&lt;p&gt;One of the engineers on our team left the organization after five years in the role,
and while hiring their replacement I took the opportunity to get a fresh start and
reset.&lt;/p&gt;
&lt;p&gt;About six months prior I had come across a few posts about the practice of creating
a &lt;a href="https://medium.com/@kawomersley/why-and-how-to-share-your-manager-readme-plus-heres-mine-8a4fe188ee1b"&gt;manager readme&lt;/a&gt;
as a way to reflect on who you are as a leader as well as provide new hires a sort
of guidebook or operating manual for how to work with you as their manager.&lt;/p&gt;
&lt;p&gt;I wanted to start my new engineer off with not only a clear understanding of how
I saw my role but also what I expected out of them. &lt;/p&gt;
&lt;p&gt;To do this, I looked over &lt;a href="https://hackernoon.com/12-manager-readmes-from-silicon-valleys-top-tech-companies-26588a660afe"&gt;many examples&lt;/a&gt;
of great manager readmes from top tech companies to draw inspiration from.&lt;/p&gt;
&lt;p&gt;Ultimately, I wanted this document to be both explanatory and inspirational for
&lt;em&gt;my team&lt;/em&gt; as well as aspirational for &lt;em&gt;myself&lt;/em&gt;. A sort of contract I could hold myself
to. So that my team could say, "You said you were going to do &lt;em&gt;X&lt;/em&gt;." And
I could make sure I was holding myself up to that same standard.&lt;/p&gt;
&lt;p&gt;So, I drafted a welcome letter and appended my &lt;a href="https://github.com/dchess/manager_readme"&gt;Manager README&lt;/a&gt;
in the true python spirit of:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;explicit is better than implicit&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Being a programmer, I also couldn't help seeing this as yet another program to write.
A set of instructions for myself to operate by. So, of course, I had to check it
into source control and track changes. Like any other codebase, I knew it would
inevitably evolve and grow. And I wanted to be able to git blame myself if it
went off the rails. =)&lt;/p&gt;
&lt;p&gt;Without further ado, here's what I've come up with, so far:&lt;/p&gt;
&lt;hr&gt;
&lt;h1&gt;Manager README&lt;/h1&gt;
&lt;p&gt;In an attempt to be transparent about my leadership philosophy and my expectations (both for myself and my team), I have put together this document. I think &lt;a href="https://www.python.org/dev/peps/pep-0020/"&gt;explicit is better than implicit&lt;/a&gt; and I want this to serve as a way to hold myself accountable as well as to clearly articulate my expectations for my team.&lt;/p&gt;
&lt;h2&gt;My Role&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;I strive to be a &lt;a href="https://en.wikipedia.org/wiki/Servant_leadership"&gt;servant leader&lt;/a&gt;: I believe managers work &lt;strong&gt;for&lt;/strong&gt; their teams, not the other way around&lt;/li&gt;
&lt;li&gt;I am an advocate for you and the team with the rest of the organization&lt;/li&gt;
&lt;li&gt;I will set the context for your work, not tell you how to do it&lt;/li&gt;
&lt;li&gt;I want to support your growth and provide you with opportunities to learn and apply your skills&lt;/li&gt;
&lt;li&gt;I am also an individual contributor on this team and hold myself accountable to the same expectations I set for the team&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;My Availability&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;While I usually have a lot on my plate, very little is more important to me than talking to you if you need to talk.&lt;/strong&gt; If you want to talk, let's talk.&lt;/li&gt;
&lt;li&gt;If you have questions, have a roadblock in your work, or just need a thought partner I'd love to hear about it as soon as possible. You don't have to wait until our scheduled one-on-one meetings. Come by my desk, stop me in the hall, catch me on slack, call me, or just put some time on my calendar anywhere that's open.&lt;/li&gt;
&lt;li&gt;If my schedule is blocked when you need me, let me know so I can make sure we find time to connect&lt;/li&gt;
&lt;li&gt;My commute is hell. I tend to work from home frequently and work non-standard hours. My regular schedule is M-W-F in office from 9:30/10-6ish and T-TH at home 8ish-5ish. If you need to schedule something in person, early morning, let me know and I will take extras steps to be there on time.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;My Assumptions About You&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;You are agile and adaptable.&lt;/strong&gt; We wear many hats and our roles and work evolve as the organization's needs change. I will expect you to change gears as needed and work on things you may have no prior experience in. Innovation means trying new things and not always knowing how to do it right away.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;You are a &lt;a href="https://medium.com/@mmamet/directly-responsible-individuals-f5009f465da4"&gt;directly responsible individual&lt;/a&gt;.&lt;/strong&gt; I expect you to take ownership for your work and your mistakes. I will create a safe space for productive failure as well as give you credit for your successes.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;You are good at your job.&lt;/strong&gt; I wouldn't have hired you if I thought otherwise. If it feels like I'm questioning you it's because I am trying to gather context or trying to be a sounding board and rubber duck for your ideas. However, you know best how to do your work. I'll ask questions and vet your ideas, but won't override your decisions. I will expect you to own those decisions though.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;You feel safe debating with me.&lt;/strong&gt; I believe in productive disagreement. I find that ideas improve by being examined from all angles. If it sounds like I'm disagreeing I'm most likely just playing devil's advocate and want you to articulate and refine your position. This does rely on us being able to have a safe debate. Sometimes the right answer is one neither of us started with.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Values&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;I value your transparency.&lt;/strong&gt; I want you to keep me in the loop and let me know about issues as they arise. Be transparent with me. I will do the same for you.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;I value your learning.&lt;/strong&gt; I know that it takes time to learn new things and that novel projects will require additional time to experiment and iterate. &lt;/li&gt;
&lt;li&gt;&lt;strong&gt;I value your time.&lt;/strong&gt; I don't want you to waste your time on busy work. I want you to provide value and feel valued. I want you to have pride in your work and feel inspired and purposeful in the work you do here. That doesn't mean we won't ever have a slog or work we have to power through. However, if you feel like you are wasting your time on menial work, let's find a way to automate it!&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;I value your input.&lt;/strong&gt; I put processes in place to make us more effective. I don't believe in just going through the motions or process for the sake of process. If you think something is getting in the way of your work, let me know. I want to improve our processes so they work effectively for all of us.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Focus&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;The quality of our development work increases with the amount of concentration we give it. &lt;/li&gt;
&lt;li&gt;Attention is a valuable resource. Be prepared to defend it. &lt;a href="http://calnewport.com/books/deep-work/"&gt;Deep work&lt;/a&gt; is vital to quality.&lt;/li&gt;
&lt;li&gt;We work in an open space. Feel free to use headphones or move to a quiet space if you need to concentrate. I find I do some of my best coding when I'm not at the office.&lt;/li&gt;
&lt;li&gt;You are not paid to maintain your inbox or attend meetings. Block off time on your calendar if you need to. It's okay to say no to an immediate request for your attention or to ask to circle back later. &lt;/li&gt;
&lt;li&gt;Troubleshooting a problem with a teammate, though, is a valuable exercise. There are always things to learn from unplanned collaboration. Be open to help others when they need it and they will return the favor. Just be judicious with how much of your time you dole out for interruptions. &lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Feedback&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://www.radicalcandor.com/the-book/"&gt;Radical Candor&lt;/a&gt; makes a lot of sense to me. I want to give you feedback because I care about you and want to help you grow. &lt;/li&gt;
&lt;li&gt;I prefer to offer and receive direct feedback in a timely manner. The tighter the feedback loop, the better. &lt;/li&gt;
&lt;li&gt;I expect people to call BS when they see it and not be afraid to speak up.&lt;/li&gt;
&lt;li&gt;Feedback is best when it is actionable and explicit about what improvement looks like.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Work/Life Balance&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;I want you to work smarter, not harder. Don't burn yourself out. There is always more work to do. You don't have to solve everything today.&lt;/li&gt;
&lt;li&gt;I believe in working to live, not living to work. We are mission driven and everyone wants to give 110%, but we have to be mindful of the stress this imbalance can cause.&lt;/li&gt;
&lt;li&gt;Unless there's an emergency, I don't expect to communicate with you outside of business hours. If you get an email from me late at night or first thing in the morning, I don't expect you to respond immediately. That's me working when I need to. Pick it up when you get a chance during your preferred schedule. If I call your cell or text you directly, it's likely urgent. Please respond accordingly. &lt;/li&gt;
&lt;li&gt;Most people work somewhere between 7am (earliest) to 7pm (latest). Figure out what works for you and let me know. I'm flexible about your schedule and know that things come up that may require coming in late or leaving early.&lt;/li&gt;
&lt;li&gt;I support working from home. It's good for mental health, supports deep work and productivity, and is definitely a quality of life issue for me. I also recognize the value of in person meetings, face-to-face collaboration, and informal discussion. We are not full-time remote. &lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;One on Ones&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;I think 1:1s are important and want us to check in regularly. I will strive to prioritize our 1:1s ahead of other commitments and be there on-time and committed to listening. I will give you my full attention.&lt;/li&gt;
&lt;li&gt;These meetings are for you and I expect you to set the agenda. It's not just a time for status updates (although I am happy to chat about your project status). If I have things I want to ask you, I will, but this is your time.&lt;/li&gt;
&lt;li&gt;I think hard discussions are frequently facilitated by taking a walk. That doesn't mean if I ask you to go for a walk that something is wrong though. I like stretching my legs and walking meetings can get the mind moving in different directions. I am also open to taking a meeting over the ping-pong table or grabbing some coffee.&lt;/li&gt;
&lt;li&gt;For remote 1:1s, I have a difficult time focusing and connecting unless I can see your face over video. If you're doing the whole work in your pajamas thing, fine by me. You don't have to dress up.&lt;/li&gt;
&lt;li&gt;I expect to check in at least once per sprint, usually at the mid way point. But the length, frequency, and medium are up to you. I will carve out at least 60 minutes for these but if you need less time or want to run over, let me know. &lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Relationships&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;I think strong teams come from great working relationships. I encourage you to connect with your peers as well as other teammates across Aspire. &lt;/li&gt;
&lt;li&gt;A former Aspire teammate once coined the term &lt;em&gt;frolleague&lt;/em&gt;(friend-colleague) and I find it very fitting. I consider a lot of current and former teammates to be friends. I hang out with folks at Aspire on my personal time and am usually up for happy hour. There is no expectation that anyone here is your new best friend, but I do think that the presence of someone you work with you consider a friend to be a strong indicator of healthy working relationships. &lt;/li&gt;
&lt;li&gt;I'm happy to make introductions for you or provide networking suggestions to help you do that.&lt;/li&gt;
&lt;li&gt;I think it is important to get out to school sites and see the work of the organization in action. I will make efforts to provide you opportunities to do so as soon as possible. &lt;/li&gt;
&lt;/ul&gt;</content><category term="Blog"></category></entry><entry><title>Automating Developer Environment Setup</title><link href="http://dchess.github.io/automating-developer-environment-setup.html" rel="alternate"></link><published>2018-02-18T13:30:00-08:00</published><updated>2018-02-18T13:30:00-08:00</updated><author><name>dc.hess@gmail.com</name></author><id>tag:dchess.github.io,2018-02-18:/automating-developer-environment-setup.html</id><summary type="html">&lt;p&gt;Scripting my setup for development has made my life easier&lt;/p&gt;</summary><content type="html">&lt;p&gt;I develop on Linux. Ubuntu to be specific. Most of the web apps I build I end
up deploying to Heroku. Since their stack is based on Ubuntu and Postgres, I 
try to make my local environment as close to production as possible. &lt;/p&gt;
&lt;p&gt;That means I don't use simpler development databases like SQLite in my local
setup and I don't build on Windows or Mac and then hope my code will deploy
properly in production. I don't want any suprises!&lt;/p&gt;
&lt;p&gt;To that effect, I try to automate my setup as much as possible. &lt;/p&gt;
&lt;p&gt;For work, I develop within a Linux virtual machine (using Virtualbox). At home, 
I'm already using linux as my main os. But I want my setup, tools, and 
configurations to be identical no matter where I am working. I also want to be
able to spin up a new VM at a moment's notice and be ready to go in no time.&lt;/p&gt;
&lt;p&gt;To help facilitate that need, I have a &lt;a href="https://github.com/dchess/dev-env-setup"&gt;github repo&lt;/a&gt;
where I store my dotfiles and a few shell scripts to easily setup my
development environment. &lt;/p&gt;
&lt;p&gt;I prefer to work in the terminal as much as possible and so I use Vim as my
text editor with a few custom configurations to emulate some IDE like features.&lt;/p&gt;
&lt;p&gt;I also prefer to handle version control with git in the terminal and have a few
custom aliases I like to make sure are available wherever I'm working.&lt;/p&gt;
&lt;p&gt;But the most valuable script I have is my database setup script. Installing
Postgres can be daunting, particularly at the start of a new project. I don't
want that to be a hindrance for myself or other developers on my team. While I
have a generic postgres setup script, I also have a more custom one for use in
Django web apps that I store in the source code of each app I deploy. That can
be a huge help when handing off to another developer on the team, so they have
exactly the same database configuration as every other developer working on the
project, with single button deployment.&lt;/p&gt;
&lt;h1&gt;VIM Config&lt;/h1&gt;
&lt;p&gt;My Vim config is pretty simple compared to many I've seen, but there are a few
things I can't live without. I was big on Sublime before I moved to Vim and so
I really appreciate having a fuzzy finder and file tree available. So I use
NERDTree and CtrlP for that. I also like being able to easily comment blocks of
code and use NERDCommenter for that. &lt;/p&gt;
&lt;p&gt;As I've shifted to using Python more, I found &lt;a href="https://realpython.com/blog/python/vim-and-python-a-match-made-in-heaven/"&gt;this tutorial from Real Python&lt;/a&gt;
really helpful for thinking about how I wanted Vim configured to better support
Python specifically. The main call outs are white space config (both indents and
trailing whitespace), code-completion, and PEP8 compliance. Using static 
analysis tools like Flake8 has greatly cut down on the need for those arguments
during code review.&lt;/p&gt;
&lt;p&gt;Beyond those Vundle plugins, I keep a copy of my current .vimrc file in my repo
for easy syncing. If I make a change locally, I push it to the repo so I can
pull it down in any other environment I'm working in. I also like a certain
color scheme and run a support script during setup to ensure both my terminal
and Vim use the same colors. It cuts down on context switching when I have to 
hop in and out of my editor to run commands.&lt;/p&gt;
&lt;h1&gt;Git Config&lt;/h1&gt;
&lt;p&gt;My git settings mostly consist of setting up my editor to be Vim by default and
a series of helpful aliases. I drew a lot of inspiration from
&lt;a href="https://haacked.com/archive/2014/07/28/github-flow-aliases/"&gt;this article from You've Been Haacked&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I use the quick commit and pretty formatted git log constantly. Likewise the
grep functionality for the commit history is incredibly useful.&lt;/p&gt;
&lt;h1&gt;Bash Config&lt;/h1&gt;
&lt;p&gt;My .bashrc is pretty standard, with one key exception. I really like being
able to see the git branch name in my prompt. I incorporated
&lt;a href="https://coderwall.com/p/fasnya/add-git-branch-name-to-bash-prompt"&gt;this tip from Coderwall&lt;/a&gt;,
which couldn't be any easier. Other than that I mostly have aliases to quickly
jump to current project directories I'm working on. Although lately, I've been
experimenting with some aliases for Django. Typing out &lt;code&gt;python manage.py runserver&lt;/code&gt;
or even &lt;code&gt;./manage.py makemigrations&lt;/code&gt; all the time can be a little tedious. I
know I could use &lt;a href="https://github.com/jgorset/django-shortcuts"&gt;django-shortcuts&lt;/a&gt;
but it really seems like a bash function ought to be able to handle my needs. &lt;/p&gt;
&lt;h1&gt;Postgres Installation&lt;/h1&gt;
&lt;p&gt;When I first was working in Rails and trying to set up PostgreSQL, I had a lot
of hiccups initially. I'd install with the wrong account permissions, or I was
missing some dependency. I'd get it configured, then port to a new system and 
have to spend time trying to get it all back to working order. It was a serious
headache.&lt;/p&gt;
&lt;p&gt;Then, I found this great resource for installing Ruby on Rails on Ubuntu from 
&lt;a href="https://gorails.com/setup/ubuntu/16.04"&gt;Go Rails&lt;/a&gt; which had a small aside
about Postgres. I was inspired by the simplicity of their directions and
&lt;a href="https://github.com/dchess/dev-env-setup/blob/master/rails.sh"&gt;translated it into a shell script&lt;/a&gt;
to automate it. &lt;/p&gt;
&lt;p&gt;While I have since largely put Rails behind me (I still have a few legacy apps
that I maintain), I am absolutely indebted to the advice about databse setup.&lt;/p&gt;
&lt;p&gt;Just to show how simple this is, here is my postgre setup script. It's 7 lines.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/bin/bash&lt;/span&gt;

&lt;span class="nv"&gt;user&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;whoami&lt;span class="k"&gt;)&lt;/span&gt;

sudo&lt;span class="w"&gt; &lt;/span&gt;sh&lt;span class="w"&gt; &lt;/span&gt;-c&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;echo &amp;#39;deb http://apt.postgresql.org/pub/repos/apt/ xenial-pgdg main&amp;#39; &amp;gt; /etc/apt/sources.list.d/pgdg.list&amp;quot;&lt;/span&gt;
wget&lt;span class="w"&gt; &lt;/span&gt;--quiet&lt;span class="w"&gt; &lt;/span&gt;-O&lt;span class="w"&gt; &lt;/span&gt;-&lt;span class="w"&gt; &lt;/span&gt;http://apt.postgresql.org/pub/repos/apt/ACCC4CF8.asc&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;sudo&lt;span class="w"&gt; &lt;/span&gt;apt-key&lt;span class="w"&gt; &lt;/span&gt;add&lt;span class="w"&gt; &lt;/span&gt;-
sudo&lt;span class="w"&gt; &lt;/span&gt;apt-get&lt;span class="w"&gt; &lt;/span&gt;update
sudo&lt;span class="w"&gt; &lt;/span&gt;apt-get&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;-y&lt;span class="w"&gt; &lt;/span&gt;postgresql-common
sudo&lt;span class="w"&gt; &lt;/span&gt;apt-get&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;-y&lt;span class="w"&gt; &lt;/span&gt;postgresql&lt;span class="w"&gt; &lt;/span&gt;libpq-dev

sudo&lt;span class="w"&gt; &lt;/span&gt;-u&lt;span class="w"&gt; &lt;/span&gt;postgres&lt;span class="w"&gt; &lt;/span&gt;createuser&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$user&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-s
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;It does all the heavy lifting. Figures out what account I am installing with,
gets the necessary repository info, installs postgres, and even sets up a user
based on my account to access it with. &lt;/p&gt;
&lt;p&gt;I've taken this idea a little further for Django and now run something a
little more complicated. &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/bin/bash&lt;/span&gt;

&lt;span class="c1"&gt;# Exit if command fails&lt;/span&gt;
&lt;span class="nb"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-e
&lt;span class="c1"&gt;# Treat unset variables as errors&lt;/span&gt;
&lt;span class="nb"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-u

&lt;span class="c1"&gt;# Set user as current account&lt;/span&gt;
&lt;span class="nv"&gt;user&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;whoami&lt;span class="k"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# Install Postgres 10&lt;/span&gt;
sudo&lt;span class="w"&gt; &lt;/span&gt;sh&lt;span class="w"&gt; &lt;/span&gt;-c&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;echo &amp;#39;deb http://apt.postgresql.org/pub/repos/apt/ xenial-pgdg main&amp;#39; &amp;gt;&amp;gt; /etc/apt/sources.list.d/pgdg.list&amp;quot;&lt;/span&gt;
wget&lt;span class="w"&gt; &lt;/span&gt;--quiet&lt;span class="w"&gt; &lt;/span&gt;-O&lt;span class="w"&gt; &lt;/span&gt;-&lt;span class="w"&gt; &lt;/span&gt;https://www.postgresql.org/media/keys/ACCC4CF8.asc&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;sudo&lt;span class="w"&gt; &lt;/span&gt;apt-key&lt;span class="w"&gt; &lt;/span&gt;add&lt;span class="w"&gt; &lt;/span&gt;-
sudo&lt;span class="w"&gt; &lt;/span&gt;apt-get&lt;span class="w"&gt; &lt;/span&gt;update
sudo&lt;span class="w"&gt; &lt;/span&gt;apt-get&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;-y&lt;span class="w"&gt; &lt;/span&gt;postgresql-common
sudo&lt;span class="w"&gt; &lt;/span&gt;apt-get&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;-y&lt;span class="w"&gt; &lt;/span&gt;postgresql-10&lt;span class="w"&gt; &lt;/span&gt;postgresql-contrib&lt;span class="w"&gt; &lt;/span&gt;libpq-dev

&lt;span class="c1"&gt;# Create superuser account as self for local management&lt;/span&gt;
sudo&lt;span class="w"&gt; &lt;/span&gt;-u&lt;span class="w"&gt; &lt;/span&gt;postgres&lt;span class="w"&gt; &lt;/span&gt;createuser&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$user&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-s

&lt;span class="c1"&gt;# Set env vars for colors&lt;/span&gt;
&lt;span class="nv"&gt;YELLOW&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;\033[1;33m&amp;#39;&lt;/span&gt;
&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;\033[0m&amp;#39;&lt;/span&gt;

&lt;span class="c1"&gt;# Collect arguments from user&lt;/span&gt;
&lt;span class="c1"&gt;# Project specific values&lt;/span&gt;
&lt;span class="nb"&gt;printf&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;YELLOW&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;Database name:\n&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;span class="nb"&gt;read&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;database
&lt;span class="nb"&gt;printf&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;YELLOW&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;Username:\n&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;span class="nb"&gt;read&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;username
&lt;span class="nb"&gt;printf&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;YELLOW&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;Password:\n&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;span class="nb"&gt;read&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;password

&lt;span class="c1"&gt;# Create database and user&lt;/span&gt;
&lt;span class="nv"&gt;RUN_ON_PSQL&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;psql -X -U &lt;/span&gt;&lt;span class="nv"&gt;$user&lt;/span&gt;&lt;span class="s2"&gt; --set ON_ERROR_STOP=on --set AUTOCOMMIT=off postgres&amp;quot;&lt;/span&gt;
&lt;span class="nv"&gt;$RUN_ON_PSQL&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;lt;&amp;lt;SQL&lt;/span&gt;
&lt;span class="s"&gt;CREATE DATABASE $database;&lt;/span&gt;
&lt;span class="s"&gt;CREATE USER $username WITH PASSWORD &amp;#39;$password&amp;#39;;&lt;/span&gt;
&lt;span class="s"&gt;ALTER ROLE $username SET client_encoding TO &amp;#39;utf8&amp;#39;;&lt;/span&gt;
&lt;span class="s"&gt;ALTER ROLE $username SET default_transaction_isolation TO &amp;#39;read committed&amp;#39;;&lt;/span&gt;
&lt;span class="s"&gt;ALTER ROLE $username SET timezone TO &amp;#39;UTC&amp;#39;;&lt;/span&gt;
&lt;span class="s"&gt;GRANT ALL PRIVILEGES ON DATABASE $database TO $username; &lt;/span&gt;
&lt;span class="s"&gt;ALTER USER $username CREATEDB;&lt;/span&gt;
&lt;span class="s"&gt;commit;&lt;/span&gt;
&lt;span class="s"&gt;SQL&lt;/span&gt;

&lt;span class="nb"&gt;exit&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Now my team can clone my repo, run this app and be good to go in seconds. It
could not be any easier to hand off my code!&lt;/p&gt;
&lt;h1&gt;Conclusion&lt;/h1&gt;
&lt;p&gt;There are always ways to automate your workflow. I am constantly on the look
out for ways I can take the guess work out of my development configuration.&lt;/p&gt;
&lt;p&gt;There are other things I rely on that I haven't mentioned here in detail (but 
you can find them in my &lt;a href="https://github.com/dchess/dev-env-setup"&gt;repo&lt;/a&gt;) like
installing &lt;a href="https://devcenter.heroku.com/articles/heroku-cli"&gt;Heroku CLI&lt;/a&gt; or 
&lt;a href="https://ngrok.com/"&gt;ngrok&lt;/a&gt;. &lt;/p&gt;
&lt;p&gt;I keep adding more automation to my setup as I go. In fact, I'm pretty sure 
that's my most active public repo!&lt;/p&gt;</content><category term="Blog"></category></entry><entry><title>Resolutions for the New Year</title><link href="http://dchess.github.io/resolutions-for-the-new-year.html" rel="alternate"></link><published>2018-01-21T15:00:00-08:00</published><updated>2018-01-21T15:00:00-08:00</updated><author><name>dc.hess@gmail.com</name></author><id>tag:dchess.github.io,2018-01-21:/resolutions-for-the-new-year.html</id><summary type="html">&lt;p&gt;New year, new blog&lt;/p&gt;</summary><content type="html">&lt;p&gt;Well, it's 2018 and it's been two years since I last made an update to my blog.
I originally published it to test out &lt;a href="https://jekyllrb.com/"&gt;Jekyll&lt;/a&gt; and to put
something basic on my personal domain. I was working with Ruby on Rails at the time
and Jekyll seemed the natural choice. &lt;/p&gt;
&lt;p&gt;In the intervening time, my work has shifted and we are more and more aligning on
standardizing our entire stack to be Python based (the advantages of which, I will
expound upon in another post). With that has come a desire to teach more of my
colleagues (particularly those not directly involved in programming) to take
advantage of Python in their work. Data analysts can leverage it for data science
and predictive analytics work and back-office folks like our accountants and financial
analysts can leverage it for task automation. &lt;/p&gt;
&lt;p&gt;I've also been getting requests from some friends and family to teach them a bit of
programming and Python seems like a natural choice for beginners. With that in mind,
I've made it my New Year's resolution to teach as many people as possible this year 
to program.&lt;/p&gt;
&lt;p&gt;I'm rebooting my blog to post helpful resources and connect with folks interested in 
learning and that means giving my site a much needed boost of new energy. I've rebuilt
it from the ground up in &lt;a href="http://docs.getpelican.com/en/stable/"&gt;Pelican&lt;/a&gt; so that it'll
be in Python as well.&lt;/p&gt;
&lt;p&gt;Here's to 2018, the year of Python!&lt;/p&gt;</content><category term="Blog"></category></entry><entry><title>How Memes Inform My Work</title><link href="http://dchess.github.io/how-memes-inform-my-work.html" rel="alternate"></link><published>2018-01-21T14:11:00-08:00</published><updated>2018-01-21T14:11:00-08:00</updated><author><name>dc.hess@gmail.com</name></author><id>tag:dchess.github.io,2018-01-21:/how-memes-inform-my-work.html</id><summary type="html">&lt;p&gt;Certain memes stick with us and can even affect our philosophies about work&lt;/p&gt;</summary><content type="html">&lt;p&gt;I remember fondly how excited I was the first time I understood an obscure coding joke
on &lt;a href="https://www.reddit.com/r/ProgrammerHumor/"&gt;r/programmerhumor&lt;/a&gt;. It felt like finally
being in "the club" and not feeling like such an outsider. &lt;/p&gt;
&lt;p&gt;While I've been programming in some capacity or another for over 20 years, I didn't get
here through the regular channels. I didn't get a degree in Computer Science. I've never
worked at a startup or one of the Big 4 (or is it &lt;a href="https://www.nytimes.com/2016/01/21/technology/techs-frightful-5-will-dominate-digital-life-for-foreseeable-future.html"&gt;Frightful 5&lt;/a&gt; now?). And as a result, I (like
many programmers) often succumb to bouts of &lt;a href="https://en.wikipedia.org/wiki/Impostor_syndrome"&gt;Imposter Syndrome&lt;/a&gt;. 
So finally feeling like I was part of the in-crowd was a victory in and of itself back then.&lt;/p&gt;
&lt;p&gt;Part of that victory is not only understanding those in-jokes and memes, but also
internalizing many of the lessons they have to teach. I've definitely purloined many a
meme, joke, or comic along the way and made it my own. &lt;/p&gt;
&lt;p&gt;&lt;img alt="I made this meme" src="http://i2.kym-cdn.com/photos/images/newsfeed/001/079/173/ed2.png"&gt;&lt;/p&gt;
&lt;p&gt;Ok. Not like that. I don't mean, I've claimed ownership in the conventional sense, 
but I mean I have taken quite a few to heart in ways that make them a part of who 
I am professionally and philosophically.&lt;/p&gt;
&lt;p&gt;What follows is my attempt to call out some of those that have impacted me the most, 
as well as explain why so many of these are pinned to the walls of my cubicle. &lt;/p&gt;
&lt;h1&gt;Pick Two&lt;/h1&gt;
&lt;p&gt;&lt;img alt="Pick Two Triangle" src="https://livehumancam.files.wordpress.com/2015/05/original.png"&gt;&lt;/p&gt;
&lt;p&gt;This is probably one of the first memes I actually felt spoke to me and my frustrations
with the limitations of project work in the software world. I remember just going, "Yeah. That."
And then feeling a deep need to print it out, stick it to the wall of my cubicle for reference
the next time somebody asked for the impossible. Also known as all three.&lt;/p&gt;
&lt;p&gt;All too often, we as developers, are asked to build quality products while still meeting deadlines
and budgets with limited resources. Because so much of what we do is invisible to stakeholders
and end-users, it is often hand-waved away as "magic" while somehow also simultaneously being 
dismissed as the type of work you can just hand off to the interchangable cogs. And if they can't
meet the feature requests then it's likely just their competency that's at issue.&lt;/p&gt;
&lt;p&gt;We've all been spoiled by the free high-tech apps we consume on a daily basis and assume similar
quality can be built by tiny teams. I am often comforted in those moments by the fundamental
laws of production this meme espouses.&lt;/p&gt;
&lt;h1&gt;The Two States of Every Programmer&lt;/h1&gt;
&lt;p&gt;&lt;img alt="The Two States of Every Programmer" src="https://pbs.twimg.com/media/BzmDP_yCEAAvXdx.png"&gt;&lt;/p&gt;
&lt;p&gt;While we're on the topic of imposter syndrome and our own limitations, this meme is one
I identify with all the time. It doesn't matter how good you get at programming. The field
of what we know and what is possible is constantly shifting and growing. And there isn't a 
day that goes by while debugging something or trying to get a new feature implemented that
I don't find myself osciallating between these states.&lt;/p&gt;
&lt;p&gt;It's important to remember we all feel this way and to remind ourselves of the opposite state
when we're stuck in the other. &lt;/p&gt;
&lt;p&gt;I think what truly separates those that drown in the imposter syndrome river and those that
keep paddling on is a healthy level of the &lt;a href="https://www.mindsetworks.com/science/"&gt;growth mindset&lt;/a&gt;.
I'm not afraid of failure and feeling like that confused dog, if every now and then I crack some 
puzzling code and feel lke a damn genius. That dopamine rush, however temporary or illusory, 
is a bit of an addiction. One I am more than happy to indulge at the cost of a little 
ego-death now and then.&lt;/p&gt;
&lt;h1&gt;Is it Worth the Time?&lt;/h1&gt;
&lt;p&gt;&lt;img alt="XKCD &amp;quot;Is it Worth the Time?&amp;quot;" src="https://imgs.xkcd.com/comics/is_it_worth_the_time.png"&gt;&lt;/p&gt;
&lt;p&gt;There are plenty of XKCD comics with jokes and references that fly right over my head,
but this one not only speaks to me, it is damn well a guidepost in my work. This one
is likewise hanging above my desk as a constant reminder and reference.&lt;/p&gt;
&lt;p&gt;I spend a lot of time automating tasks. My own, my teams, and more often than not, those
of other departments in the org. The automation of boring stuff is one of the most
powerful impacts of code and one that I think gets at the heart of why we do what we do.&lt;/p&gt;
&lt;p&gt;That being said, it's incredibly easy to fall down your own rabbit hole trying to build
the perfect solution in search of time savings. At the start of every new project request,
I consult this chart and think deeply about the time being invested in the solution versus
the time it's actually saving. Return on investment is an important concept to grasp early
on as a developer, because we're inquisitive types who are more than willing to live in 
that damn rabbit hole if it means catching a white rabbit. Even if he is just a figment of
our imagination.&lt;/p&gt;
&lt;h1&gt;You Don't Have to Solve Everything Today&lt;/h1&gt;
&lt;p&gt;&lt;img alt="You don't have to solve everything today" src="https://i.imgur.com/jbcq2d8.png"&gt;&lt;/p&gt;
&lt;p&gt;I'm pretty sure this meme's original context was in regards to depression, but one that
nonetheless serves as a daily reminder to walk away sometimes. It's easy to get so wrapped
up in a problem to completely lose track of time. I can be hacking away while the office 
slowly clears out. It's easy to think "I'll go home once I solve this problem, or make 
this commit" but that can spiral out of control fast. &lt;/p&gt;
&lt;p&gt;The older I get and the more my priorities focus on family and sustaining a healthy work/life
balance, the more I look to this meme as a reminder that it really can "wait until tomorrow".&lt;/p&gt;
&lt;p&gt;Remember, burn out is real and no one says on their death bed that they wish they had worked
more. In the work/life balance equation, you've got to work to live not live to work. i&lt;/p&gt;
&lt;p&gt;It's corny. I know. But that doesn't make it any less true.&lt;/p&gt;
&lt;h1&gt;Exploits of a Mom (AKA Little Bobby Tables)&lt;/h1&gt;
&lt;p&gt;&lt;img alt="XKCD &amp;quot;Exploits of a Mom&amp;quot;" src="https://imgs.xkcd.com/comics/exploits_of_a_mom.png"&gt;&lt;/p&gt;
&lt;p&gt;I started my professional career as a programmer largely working with SQL. And it's still a
daily part of my workload. Security has been everyone's minds in the last few years with all
the data breaches and hacks. Education is not immune either, and this comic about 
&lt;a href="https://en.wikipedia.org/wiki/SQL_injection"&gt;SQL injection&lt;/a&gt; is a good reminder that it's 
important to tighten up those holes in your apps lest someone exploit them for fun or profit!&lt;/p&gt;
&lt;p&gt;Even in 2017, SQL injection was still the number one risk in the &lt;a href="https://www.owasp.org/images/7/72/OWASP_Top_10-2017_%28en%29.pdf.pdf"&gt;OWASP Top Ten Most Critical Web
Application Security Risks&lt;/a&gt;. &lt;/p&gt;
&lt;h1&gt;Office Space Lumberg&lt;/h1&gt;
&lt;p&gt;&lt;img alt="Lumberg That Would be Great" src="http://s2.quickmeme.com/img/67/67851be4d08f9a4ffb3f0a48ef6e136eacae8e0fc0d0f7dfb9a53c36f388b097.jpg"&gt;&lt;/p&gt;
&lt;p&gt;I don't think I truly appreciated the brilliance of Mike Judge's &lt;em&gt;Office Space&lt;/em&gt; until I started to
work in an office job. Although, even as a teacher I identified with beating the crap out of a 
copier/fax machine. I laughed at all the jokes and obvious exaggerations, but now I find myself
trying to figure out which of the characters I am and which ones I never want to be.&lt;/p&gt;
&lt;p&gt;This is particularly true now that I've moved into a role as a manager. Lumberg is the quintessential
terrible boss and every time I find myself leaning on one of my teammate's cubicles with coffee cup in
hand, I can't help feeling like I might accidentally utter, "Yeah if you could just... that'd be great."&lt;/p&gt;
&lt;p&gt;Don't be that guy. Don't be that guy. Don't be that guy.&lt;/p&gt;
&lt;p&gt;I joke about it practically every time, but I really have internalized the idea that being someone's boss
isn't about assigning them work and cracking the whip. That never helped me as an employee and I would
never want to be that to someone else. &lt;/p&gt;
&lt;p&gt;I'm still trying to find my way as I transition into this role, but so far, I'm finding that leading
from the front is much more effective than shouting orders from the back. "Come with me" is so much more
potent than "Go that way".&lt;/p&gt;
&lt;p&gt;What memes have you taken to heart in your work or personal life? Which comics or jokes
do you comfort yourself with in your moments of desparation or exhilaration?&lt;/p&gt;</content><category term="Blog"></category></entry><entry><title>Student Email Sync</title><link href="http://dchess.github.io/student-email-sync.html" rel="alternate"></link><published>2016-05-31T17:17:00-07:00</published><updated>2016-05-31T17:17:00-07:00</updated><author><name>dc.hess@gmail.com</name></author><id>tag:dchess.github.io,2016-05-31:/student-email-sync.html</id><summary type="html">&lt;p&gt;Ruby script to sync student emails between data warehouse and Powerschool nightly.&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;img alt="PowerSchool" src="/images/powerschool.png"&gt;&lt;/p&gt;
&lt;h2&gt;Project Summary:&lt;/h2&gt;
&lt;h3&gt;Business Objective:&lt;/h3&gt;
&lt;p&gt;To pull automatically generated student email addresses from our MS SQL data warehouse and push into production PowerSchool instances in multiple states.&lt;/p&gt;
&lt;h3&gt;What I Built:&lt;/h3&gt;
&lt;p&gt;A ruby script that connects to our data warehouse using an ActiveRecord adapter for SQL server, dynamically queries student records, and converts them into the expected format with a custom JSON serializer. Then it uses Faraday HTTP client to make a  call to the PowerSchool API (one per instance in CA and TN) to request a token for authentication. Once authenticated, it sends the JSON request body to the API and returns a response set of success/error messages which are logged locally. The program is integrated into our SSIS integration job server using a nice little PowerShell script to dynamically call the ruby script for each state's data.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;TL;DR:&lt;/strong&gt; Wrote a ruby script that syncs 15,000+ student emails between a data warehouse and production PowerSchool servers in mutliple states on a daily basis. &lt;/p&gt;
&lt;h3&gt;Made With:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Ruby&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/lostisland/faraday"&gt;Faraday&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/rails-sqlserver/activerecord-sqlserver-adapter"&gt;Rails-sqlserver adapter&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://ruby-doc.org/stdlib-2.3.0/libdoc/logger/rdoc/Logger.html"&gt;Logger&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://powersource.pearsonschoolsystems.com/developer/"&gt;PowerSchool API&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;MS SQL&lt;ul&gt;
&lt;li&gt;Stored procedure&lt;/li&gt;
&lt;li&gt;Custom views&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;PowerShell&lt;/li&gt;
&lt;li&gt;SSIS&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Code Samples:&lt;/h3&gt;
&lt;p&gt;Select methods from the API class demonstrating how the program connects to the PowerSchool
API and updates student emails.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# @oauth is a class variable that stores the configuration file secrets&lt;/span&gt;
&lt;span class="c1"&gt;# not exposed here for obvious reasons&lt;/span&gt;

&lt;span class="kp"&gt;private&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;connect&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;# open HTTP connection&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="no"&gt;Faraday&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ss"&gt;:url&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="vi"&gt;@oauth&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;url&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="ss"&gt;:ssl&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="ss"&gt;:verify&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kp"&gt;false&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;do&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;faraday&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;faraday&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="ss"&gt;:url_encoded&lt;/span&gt;&lt;span class="w"&gt;               &lt;/span&gt;&lt;span class="c1"&gt;# form-encode POST params&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;faraday&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;adapter&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="no"&gt;Faraday&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;default_adapter&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;# make requests with Net::HTTP&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;

&lt;span class="kp"&gt;private&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;access_token&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;post&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;do&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/oauth/access_token&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;client_id&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="vi"&gt;@oauth&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;client_secret&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="vi"&gt;@oauth&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;secret&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;grant_type&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;client_credentials&amp;#39;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;# return token from JSON result&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="no"&gt;JSON&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;parse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;access_token&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;

&lt;span class="kp"&gt;public&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;update_student_emails&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# takes JSON as the body param&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;# POST request body of student emails to PowerSchool API&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;post&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;do&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/ws/v1/student&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;options&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;timeout&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3000&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# open/read timeout in seconds&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;options&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open_timeout&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# connection open timeout in seconds&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Accept&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;application/json&amp;#39;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Content-Type&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;application/json&amp;#39;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Authorization&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Bearer &lt;/span&gt;&lt;span class="si"&gt;#{&lt;/span&gt;&lt;span class="n"&gt;access_token&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;body&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;# Return human readable JSON result&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;parsed&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;JSON&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;parse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;pretty&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;JSON&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pretty_generate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;parsed&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Ruby method for seralizing student emails from SQL to JSON. 
The PowerSchool Student API expects JSON in a non standard JSON format. That is why custom serialization is needed.&lt;/p&gt;
&lt;p&gt;See &lt;a href="https://support.powerschool.com/developer/#/page/student-resources"&gt;PowerSchool API Documentation&lt;/a&gt; under "Update Students &amp;gt; Request Body Example"&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;def&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nc"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="nf"&gt;serialize_student_emails&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;state&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="c1"&gt;# client_uid is the PowerSchool ID and id is the DCID&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;studentArray&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;production&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;query&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sanitize_sql_array&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;SELECT * FROM dbo.StudentEmails WHERE State = ?&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;state&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;connection&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;select_all&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;query&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;each&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;do&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;record&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;studentArray&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;client_uid&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;record&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;client_uid&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;action&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;UPDATE&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;record&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;contact_info&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;email&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;record&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;email&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;

&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;studentHash&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;students&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;student&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;studentArray&lt;/span&gt;&lt;span class="p"&gt;}}&lt;/span&gt;

&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="c1"&gt;# return as JSON body&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;studentHash&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_json&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;PowerShell script: &lt;code&gt;ssms_job.ps1&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c"&gt;# This is run from an SSMS job task step&lt;/span&gt;
&lt;span class="nv"&gt;$erroractionpreference&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Stop&amp;quot;&lt;/span&gt;

&lt;span class="k"&gt;try&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="nb"&gt;Set-Location&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;C:\powerSchoolApi\app&amp;#39;&lt;/span&gt;

  &lt;span class="c"&gt;# Ruby executable location called from Rails Installer&lt;/span&gt;
  &lt;span class="nv"&gt;$RUBY&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;C:\RailsInstaller\Ruby2.2.0\bin\ruby.exe&amp;#39;&lt;/span&gt;
  &lt;span class="p"&gt;&amp;amp;&lt;/span&gt; &lt;span class="nv"&gt;$RUBY&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;application.rb&amp;#39;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="k"&gt;catch&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="k"&gt;throw&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;The application encountered an error. See logs for further explanation.&amp;#39;&lt;/span&gt;
  &lt;span class="n"&gt;exit&lt;/span&gt; &lt;span class="n"&gt;1&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="Projects"></category></entry></feed>